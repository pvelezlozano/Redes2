<!DOCTYPE html>
<html class='v2 list-page' dir='ltr' itemscope='' itemtype='http://schema.org/Blog' lang='en' xmlns='http://www.w3.org/1999/xhtml' xmlns:b='http://www.google.com/2005/gml/b' xmlns:data='http://www.google.com/2005/gml/data' xmlns:expr='http://www.google.com/2005/gml/expr'>
<head>
<link href='https://www.blogger.com/static/v1/widgets/115981500-css_bundle_v2.css' rel='stylesheet' type='text/css'/>
<title>
Google Online Security Blog
</title>
<meta content='JPvErrROkJmNEh4Lr_QT6CD77GdfQr6cLFw6gIXg6kc' name='google-site-verification'/>
<meta content='width=device-width, height=device-height, minimum-scale=1.0, initial-scale=1.0, user-scalable=0' name='viewport'/>
<meta content='IE=Edge' http-equiv='X-UA-Compatible'/>
<meta content='Google Online Security Blog' property='og:title'/>
<meta content='en_US' property='og:locale'/>
<meta content='https://security.googleblog.com/' property='og:url'/>
<meta content='Google Online Security Blog' property='og:site_name'/>
<!-- Twitter Card properties -->
<meta content='Google Online Security Blog' property='og:title'/>
<meta content='summary' name='twitter:card'/>
<meta content='@google' name='twitter:creator'/>
<link href='https://fonts.googleapis.com/css?family=Roboto:400italic,400,500,500italic,700,700italic' rel='stylesheet' type='text/css'/>
<link href='https://fonts.googleapis.com/icon?family=Material+Icons' rel='stylesheet'/>
<script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js' type='text/javascript'></script>
<!-- End -->
<style id='page-skin-1' type='text/css'><!--
/*
<Group description="Header Color" selector="header">
<Variable name="header.background.color" description="Header Background"
type="color" default="#ffffff"/>
</Group>
*/
.header-outer {
border-bottom: 1px solid #e0e0e0;
background: #ffffff;
}
html, .Label h2, #sidebar .rss a, .BlogArchive h2, .FollowByEmail h2.title, .widget .post h2 {
font-family: Roboto, sans-serif;
}
.plusfollowers h2.title, .post h2.title, .widget h2.title {
font-family: Roboto, sans-serif;
}
.widget-item-control {
height: 100%;
}
.widget.Header, #header {
position: relative;
height: 100%;
width: 100%;
}
}
.widget.Header .header-logo1 {
float: left;
margin-right: 15px;
padding-right: 15px;
border-right: 1px solid #ddd;
}
.header-title h2 {
color: rgba(0,0,0,.54);
display: inline-block;
font-size: 40px;
font-family: Roboto, sans-serif;
font-weight: normal;
line-height: 52px;
vertical-align: top;
}
.header-inner {
background-repeat: no-repeat;
background-position: right 0px;
}
.post-author,
.byline-author {
font-size: 14px;
font-weight: normal;
color: #757575;
color: rgba(0,0,0,.54);
}
.post-content .img-border {
border: 1px solid rgb(235, 235, 235);
padding: 4px;
}
.header-title a {
text-decoration: none !important;
}
pre {
border: 1px solid #bbbbbb;
margin-top: 1em 0 0 0;
padding: 0.99em;
overflow-x: auto;
overflow-y: auto;
}
pre, code {
font-size: 9pt;
background-color: #fafafa;
line-height: 125%;
font-family: monospace;
}
pre, code {
color: #060;
font: 13px/1.54 "courier new",courier,monospace;
}
.header-left .header-logo1 {
width: 128px !important;
}
.header-desc {
line-height: 20px;
margin-top: 8px;
}
.fb-custom img, .twitter-custom img, .gplus-share img {
cursor: pointer;
opacity: 0.54;
}
.fb-custom img:hover, .twitter-custom img:hover, .gplus-share img:hover {
opacity: 0.87;
}
.fb-like {
width: 80px;
}
.post .share {
float: right;
}
#twitter-share{
border: #CCC solid 1px;
border-radius: 3px;
background-image: -webkit-linear-gradient(top,#ffffff,#dedede);
}
.twitter-follow {
background: url(//3.bp.blogspot.com/-M7uPAxKEeh4/WKrvV1ujKCI/AAAAAAAATZE/cdHhTldtvk4q4ad1Me1XDIgQD9Aul09CACK4B/s1600/twitter-bird.png) no-repeat left center;
padding-left: 18px;
font: normal normal normal 11px/18px 'Helvetica Neue',Arial,sans-serif;
font-weight: bold;
text-shadow: 0 1px 0 rgba(255,255,255,.5);
cursor: pointer;
margin-bottom: 10px;
}
.twitter-fb {
padding-top: 2px;
}
.fb-follow-button  {
background: -webkit-linear-gradient(#4c69ba, #3b55a0);
background: -moz-linear-gradient(#4c69ba, #3b55a0);
background: linear-gradient(#4c69ba, #3b55a0);
border-radius: 2px;
height: 18px;
padding: 4px 0 0 3px;
width: 57px;
border: #4c69ba solid 1px;
}
.fb-follow-button a {
text-decoration: none !important;
text-shadow: 0 -1px 0 #354c8c;
text-align: center;
white-space: nowrap;
font-size: 11px;
color: white;
vertical-align: top;
}
.fb-follow-button a:visited {
color: white;
}
.fb-follow {
padding: 0px 5px 3px 0px;
width: 14px;
vertical-align: bottom;
}
.gplus-wrapper {
margin-top: 3px;
display: inline-block;
vertical-align: top;
}
.twitter-custom, .gplus-share {
margin-right: 12px;
}
.fb-follow-button{
margin: 10px auto;
}
/** CUSTOM CODE **/

--></style>
<style id='template-skin-1' type='text/css'><!--
.header-outer {
clear: both;
}
.header-inner {
margin: auto;
padding: 0px;
}
.footer-outer {
background: #f5f5f5;
clear: both;
margin: 0;
}
.footer-inner {
margin: auto;
padding: 0px;
}
.footer-inner-2 {
/* Account for right hand column elasticity. */
max-width: calc(100% - 248px);
}
.google-footer-outer {
clear: both;
}
.cols-wrapper, .google-footer-outer, .footer-inner, .header-inner {
max-width: 978px;
margin-left: auto;
margin-right: auto;
}
.cols-wrapper {
margin: auto;
clear: both;
margin-top: 60px;
margin-bottom: 60px;
overflow: hidden;
}
.col-main-wrapper {
float: left;
width: 100%;
}
.col-main {
margin-right: 278px;
max-width: 660px;
}
.col-right {
float: right;
width: 248px;
margin-left: -278px;
}
/* Tweaks for layout mode. */
body#layout .google-footer-outer {
display: none;
}
body#layout .header-outer, body#layout .footer-outer {
background: none;
}
body#layout .header-inner {
height: initial;
}
body#layout .cols-wrapper {
margin-top: initial;
margin-bottom: initial;
}
--></style>
<!-- start all head -->
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'/>
<meta content='blogger' name='generator'/>
<link href='https://security.googleblog.com/favicon.ico' rel='icon' type='image/x-icon'/>
<link href='https://security.googleblog.com/' rel='canonical'/>
<link rel="alternate" type="application/atom+xml" title="Google Online Security Blog - Atom" href="https://security.googleblog.com/feeds/posts/default" />
<link rel="alternate" type="application/rss+xml" title="Google Online Security Blog - RSS" href="https://security.googleblog.com/feeds/posts/default?alt=rss" />
<link rel="service.post" type="application/atom+xml" title="Google Online Security Blog - Atom" href="https://www.blogger.com/feeds/1176949257541686127/posts/default" />
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/3775400722-ieretrofit.js"></script>
<![endif]-->
<meta content='https://security.googleblog.com/' property='og:url'/>
<meta content='Google Online Security Blog' property='og:title'/>
<meta content='The latest news and insights from Google on security and safety on the Internet' property='og:description'/>
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<!-- end all head -->
<base target='_self'/>
<style>
      html {
        font-family: Roboto, sans-serif;
        -moz-osx-font-smoothing: grayscale;
        -webkit-font-smoothing: antialiased;
      }
      body {
        padding: 0;
        /* This ensures that the scroll bar is always present, which is needed */
        /* because content render happens after page load; otherwise the header */
        /* would "bounce" in-between states. */
        min-height: 150%;
      }
      h2 {
        font-size: 16px;
      }
      h1, h2, h3, h4, h5 {
        line-height: 2em;
      }
      html, h4, h5, h6 {
        font-size: 14px;
      }
      a, a:visited {
        color: #4184F3;
        text-decoration: none;
      }
      a:focus, a:hover, a:active {
        text-decoration: none;
      }
      .Header {
        margin-top: 15px;
      }
      .Header h1 {
        font-size: 32px;
        font-weight: 300;
        line-height: 32px;
        height: 42px;
      }
      .header-inner .Header .titlewrapper {
        padding: 0;
        margin-top: 30px;
      }
      .header-inner .Header .descriptionwrapper {
        padding: 0;
        margin: 0;
      }
      .cols-wrapper {
        margin-top: 56px;
      }
      .header-outer, .cols-wrapper, .footer-outer, .google-footer-outer {
        padding: 0 60px;
      }
      .header-inner {
        height: 256px;
        position: relative;
      }
      html, .header-inner a {
        color: #212121;
        color: rgba(0,0,0,.87);
      }
      .header-inner .google-logo {
        display: inline-block;
        background-size: contain;
        z-index: 1;
        height: 46px;
        overflow: hidden;
        margin-top: 4px;
        margin-right: 8px;
      }
      .header-left {
        position: absolute;
        top: 50%;
        -webkit-transform: translateY(-50%);
        transform: translateY(-50%);
        margin-top: 12px;
        width: 100%;
      }
      .google-logo {
        margin-left: -4px;
      }
      #google-footer {
        position: relative;
        font-size: 13px;
        list-style: none;
        text-align: right;
      }
      #google-footer a {
        color: #444;
      }
      #google-footer ul {
        margin: 0;
        padding: 0;
        height: 144px;
        line-height: 144px;
      }
      #google-footer ul li {
        display: inline;
      }
      #google-footer ul li:before {
        color: #999;
        content: "\00b7";
        font-weight: bold;
        margin: 5px;
      }
      #google-footer ul li:first-child:before {
        content: '';
      }
      #google-footer .google-logo-dark {
        left: 0;
        margin-top: -16px;
        position: absolute;
        top: 50%;
      }
      /** Sitemap links. **/
      .footer-inner-2 {
        font-size: 14px;
        padding-top: 42px;
        padding-bottom: 74px;
      }
      .footer-inner-2 .HTML h2 {
        color: #212121;
        color: rgba(0,0,0,.87);
        font-size: 14px;
        font-weight: 500;
        padding-left: 0;
        margin: 10px 0;
      }
      .footer-inner-2 .HTML ul {
        font-weight: normal;
        list-style: none;
        padding-left: 0;
      }
      .footer-inner-2 .HTML li {
        line-height: 24px;
        padding: 0;
      }
      .footer-inner-2 li a {
        color: rgba(65,132,243,.87);
      }
      /** Archive widget. **/
      .BlogArchive {
        font-size: 13px;
        font-weight: normal;
      }
      .BlogArchive .widget-content {
        display: none;
      }
      .BlogArchive h2, .Label h2 {
        color: #4184F3;
        text-decoration: none;
      }
      .BlogArchive .hierarchy li {
        display: inline-block;
      }
      /* Specificity needed here to override widget CSS defaults. */
      .BlogArchive #ArchiveList ul li, .BlogArchive #ArchiveList ul ul li {
        margin: 0;
        padding-left: 0;
        text-indent: 0;
      }
      .BlogArchive .intervalToggle {
        cursor: pointer;
      }
      .BlogArchive .expanded .intervalToggle .new-toggle {
        -ms-transform: rotate(180deg);
        transform: rotate(180deg);
      }
      .BlogArchive .new-toggle {
        float: right;
        padding-top: 3px;
        opacity: 0.87;
      }
      #ArchiveList {
        text-transform: uppercase;
      }
      #ArchiveList .expanded > ul:last-child {
        margin-bottom: 16px;
      }
      #ArchiveList .archivedate {
        width: 100%;
      }
      /* Months */
      .BlogArchive .items {
        max-width: 150px;
        margin-left: -4px;
      }
      .BlogArchive .expanded .items {
        margin-bottom: 10px;
        overflow: hidden;
      }
      .BlogArchive .items > ul {
        float: left;
        height: 32px;
      }
      .BlogArchive .items a {
        padding: 0 4px;
      }
      .Label {
        font-size: 13px;
        font-weight: normal;
      }
      .sidebar-icon {
        display: inline-block;
        width: 24px;
        height: 24px;
        vertical-align: middle;
        margin-right: 12px;
        margin-top: -1px
      }
      .Label a {
        margin-right: 4px;
      }
      .Label .widget-content {
        display: none;
      }
      .FollowByEmail {
        font-size: 13px;
        font-weight: normal;
      }
      .FollowByEmail h2 {
        background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAALCAYAAACZIGYHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAUBJREFUeNrMkSGLAlEUhb+ZB4JFi8mx2cz+ApvhRUGTcUCrNqNJDYIi+DO0GUwmQXDK2DSIoGgZcSaIjDrzwrK4ssvChj1w0733O+fdp+m6PozH4yQSCfb7Pa7r8pOi0SjJZBLP8zgej4gAIMvlMuPxmADIYrHger1+C6lUKmo+NJ/NZojb7SZDWiwWo1qtks1msW2bw+HwZdkwDHq9HvV6nel0SqvVYrvdIh6Ph3Qch+VyqRYLhQJSSjRNw7IsfN9XgGKxSLfbJZfL0e/3aTabrFYr7vc7IujLcOh8PqunrNdr0uk0pVKJVCpFJBJRgEajweVyod1uMxgM2O12BAGUgRbU8DV2JpOhVquRz+cRQii3+XxOp9NRN3jVR5LPOp1OjEYjlSL8hclkgmmabDabt4d+m+S30vkD/R/IU4ABAPTZgnZdmG/PAAAAAElFTkSuQmCC");
        background-repeat: no-repeat;
        background-position: 0 50%;
        text-indent: 30px;
      }
      .FollowByEmail .widget-content {
        display: none;
      }
      .searchBox input {
        border: 1px solid #eee;
        color: #212121;
        color: rgba(0,0,0,.87);
        font-size: 14px;
        padding: 8px 8px 8px 40px;
        width: 164px;
        font-family: Roboto, sans-serif;
        background: url("https://www.gstatic.com/images/icons/material/system/1x/search_grey600_24dp.png") 8px center no-repeat;
      }
      .searchBox ::-webkit-input-placeholder { /* WebKit, Blink, Edge */
        color:    rgba(0,0,0,.54);
      }
      .searchBox :-moz-placeholder { /* Mozilla Firefox 4 to 18 */
        color:    #000;
        opacity:  0.54;
      }
      .searchBox ::-moz-placeholder { /* Mozilla Firefox 19+ */
        color:    #000;
        opacity:  0.54;
      }
      .searchBox :-ms-input-placeholder { /* Internet Explorer 10-11 */
        color:    #757575;
      }
      .widget-item-control {
        margin-top: 0px;
      }
      .section {
        margin: 0;
        padding: 0;
      }
      #sidebar-top {
        border: 1px solid #eee;
      }
      #sidebar-top > div {
        margin: 16px 0;
      }
      .widget ul {
        line-height: 1.6;
      }
      /*main post*/
      .post {
        margin-bottom:30px;
      }
      #main .post .title {
        margin: 0;
      }
      #main .post .title a {
        color: #212121;
        color: rgba(0,0,0,.87);
        font-weight: normal;
        font-size: 24px;
      }
      #main .post .title a:hover {
        text-decoration:none;
        color:#4184F3;
      }
      .message,  #main .post .post-header {
        margin: 0;
        padding: 0;
      }
      #main .post .post-header .caption, #main .post .post-header .labels-caption,  #main .post .post-footer .caption, #main .post .post-footer .labels-caption {
        color: #444;
        font-weight: 500;
      }
      #main .tr-caption-container td {
        text-align: left;
      }
      #main .post .tr-caption {
        color: #757575;
        color: rgba(0,0,0,.54);
        display: block;
        max-width: 560px;
        padding-bottom: 20px;
      }
      #main .post .tr-caption-container {
        line-height: 24px;
        margin: -1px 0 0 0 !important;
        padding: 4px 0;
        text-align: left;
      }
      #main .post .post-header .published{
        font-size:11px;
        font-weight:bold;
      }
      .post-header .publishdate {
        font-size: 17px;
        font-weight:normal;
        color: #757575;
        color: rgba(0,0,0,.54);
      }
      #main .post .post-footer{
        font-size:12px;
        padding-bottom: 21px;
      }
      .label-footer {
        margin-bottom: 12px;
        margin-top: 12px;
      }
      .comment-img {
        margin-right: 16px;
        opacity: 0.54;
        vertical-align: middle;
      }
      #main .post .post-header .published {
        margin-bottom: 40px;
        margin-top: -2px;
      }
      .post .post-content {
        color: #212121;
        color: rgba(0,0,0,.87);
        font-size: 17px;
        margin: 25px 0 36px 0;
        line-height: 32px;
      }
      .post-body .post-content ul, .post-body .post-content ol {
        margin: 16px 0;
        padding: 0 48px;
      }
      .post-summary {
        display: none;
      }
      /* Another old-style caption. */
      .post-content div i, .post-content div + i {
        font-size: 14px;
        font-style: normal;
        color: #757575;
        color: rgba(0,0,0,.54);
        display: block;
        line-height: 24px;
        margin-bottom: 16px;
        text-align: left;
      }
      /* Another old-style caption (with link) */
      .post-content a > i {
        color: #4184F3 !important;
      }
      /* Old-style captions for images. */
      .post-content .separator + div:not(.separator) {
        margin-top: -16px;
      }
      /* Capture section headers. */
      .post-content br + br + b, .post-content .space + .space + b, .post-content .separator + b {
        display: inline-block;
        margin-bottom: 8px;
        margin-top: 24px;
      }
      .post-content li {
        line-height: 32px;
      }
      /* Override all post images/videos to left align. */
      .post-content .separator > a, .post-content .separator > span {
        margin-left: 0 !important;
      }
      .post-content img {
        max-width: 100%;
        height: auto;
        width: auto;
      }
      .post-content .tr-caption-container img {
        margin-bottom: 12px;
      }
      .post-content iframe, .post-content embed {
        max-width: 100%;
      }
      .post-content .carousel-container {
        margin-bottom: 48px;
      }
      #main .post-content b {
        font-weight: 500;
      }
      /* These are the main paragraph spacing tweaks. */
      #main .post-content br {
        content: ' ';
        display: block;
        padding: 4px;
      }
      .post-content .space {
        display: block;
        height: 8px;
      }
      .post-content iframe + .space, .post-content iframe + br {
        padding: 0 !important;
      }
      #main .post .jump-link {
        margin-bottom:10px;
      }
      .post-content img, .post-content iframe {
        margin: 30px 0 20px 0;
      }
      .post-content > img:first-child, .post-content > iframe:first-child {
        margin-top: 0;
      }
      .col-right .section {
        padding: 0 16px;
      }
      #aside {
        background:#fff;
        border:1px solid #eee;
        border-top: 0;
      }
      #aside .widget {
        margin:0;
      }
      #aside .widget h2, #ArchiveList .toggle + a.post-count-link {
        color: #212121;
        color: rgba(0,0,0,.87);
        font-weight: 400 !important;
        margin: 0;
      }
      #ArchiveList .toggle {
        float: right;
      }
      #ArchiveList .toggle .material-icons {
        padding-top: 4px;
      }
      #sidebar .tab {
        cursor: pointer;
      }
      #sidebar .tab .arrow {
        display: inline-block;
        float: right;
      }
      #sidebar .tab .icon {
        display: inline-block;
        vertical-align: top;
        height: 24px;
        width: 24px;
        margin-right: 13px;
        margin-left: -1px;
        margin-top: 1px;
        color: #757575;
        color: rgba(0,0,0,.54);
      }
      #sidebar .widget-content > :first-child {
        padding-top: 8px;
      }
      #sidebar .active .tab .arrow {
        -ms-transform: rotate(180deg);
        transform: rotate(180deg);
      }
      #sidebar .arrow {
        color: #757575;
        color: rgba(0,0,0,.54);
      }
      #sidebar .widget h2 {
        font-size: 14px;
        line-height: 24px;
        display: inline-block;
      }
      #sidebar .widget .BlogArchive {
        padding-bottom: 8px;
      }
      #sidebar .widget {
        border-bottom: 1px solid #eee;
        box-shadow: 0px 1px 0 white;
        margin-bottom: 0;
        padding: 14px 0;
        min-height: 20px;
      }
      #sidebar .widget:last-child {
        border-bottom: none;
        box-shadow: none;
        margin-bottom: 0;
      }
      #sidebar ul {
        margin: 0;
        padding: 0;
      }
      #sidebar ul li {
        list-style:none;
        padding:0;
      }
      #sidebar ul li a {
        line-height: 32px;
      }
      #sidebar .archive {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAYCAYAAADzoH0MAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAE1JREFUeNpiNDY23s9AAWBioBCwYBM8c+YMVsUmJibEGYBNMS5DaeMFfDYSZQA2v9I3FrB5AZeriI4FmnrBccCT8mhmGs1MwyAzAQQYAKEWG9zm9QFEAAAAAElFTkSuQmCC");
        height: 24px;
        line-height: 24px;
        padding-left: 30px;
      }
      #sidebar .labels {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAARCAYAAAA7bUf6AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAUxJREFUeNpiNDY23s9AAMycOfM7UF05kHkZmzwTMkdSUhKrIcXFxZy3bt3qBjIN8RrS09PDsHnzZjCNDr58+cKQlpbGDjSoHcg1w2oIyAUODg5gARCNzUVIBrUCuVYYhjx//pzhwIEDYAEQDeJjA1CDWIAGNQK59jBxRuSABbkAlwHIgIeHh2HWrFn/1NTU2oDcvSgBS4wBSC5iArqoCsj1YGIgEyAZVMoEchqlBjEB/cZAiUHg2AEGznpKDAImxOeM////B4VLKtBvEUCngZ1ILKivr3/u6+ubBzJAGZQ9gC5aQoqLgAY8BhkAZL4BuQQkxgXE34A4BuiiZEIuAhrwEGhAEZD5DpzYoIaA2UAM4kQADUrHZRDUgAIg8wO2XAwzbQXQa5OweQ1owB10AyA6gS7BgX1u3ry5397eHow3bdo0EyjGi00tQIABANPgyAH1q1eaAAAAAElFTkSuQmCC");
        height: 20px;
        line-height: 20px;
        padding-left: 30px;
      }
      #sidebar .rss a {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAX5JREFUeNqsVDGSgkAQHL2rIiIikohIc/EBRkbwAIwuwgfwAXiAD9AHSI7kEkECRCb6AIyINDLx7K0aa6kT7uq0q7YYtnZ7umdnt7darXbr9Zpegeu61DNNc0dvwCcH4/GYJpMJnc9nOhwOVJbl/4hAAokMECZJQtvt9k+kH7qufyEYDAakqqqYxFdRFBqNRmTbNg2HQ0rTlK7XayvR0xqBdDqdkuM4dE/0ULhYLOh4PHYrknG5XGi/31MYhuL/nkwonM1mlGUZ1XXdrsiyLGEDhY7juJEZ1u5tIixDGdYhmYw+B7CAzPP5nDabjdgIAgCksMX1832/3drtdqPT6SQWapomiGEFNkDEdpDMMAzK81ys/7XYy+XyoQgq2WoURSIJ2iIIgp/WZCCTvFm2wgeAU31aI3Q2GhIDMeB53qPYPIcm5VrxXIOIOxsDMStjVawAc1VViRgN22lNBiuQN3GR+SY07hpOoStmFQAKXRRFY93bnpG+fONfedi+BRgAbkS8Fxp7QQIAAAAASUVORK5CYII=");
      }
      #sidebar .subscription a {
        background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAALCAYAAACZIGYHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAUBJREFUeNrMkSGLAlEUhb+ZB4JFi8mx2cz+ApvhRUGTcUCrNqNJDYIi+DO0GUwmQXDK2DSIoGgZcSaIjDrzwrK4ssvChj1w0733O+fdp+m6PozH4yQSCfb7Pa7r8pOi0SjJZBLP8zgej4gAIMvlMuPxmADIYrHger1+C6lUKmo+NJ/NZojb7SZDWiwWo1qtks1msW2bw+HwZdkwDHq9HvV6nel0SqvVYrvdIh6Ph3Qch+VyqRYLhQJSSjRNw7IsfN9XgGKxSLfbJZfL0e/3aTabrFYr7vc7IujLcOh8PqunrNdr0uk0pVKJVCpFJBJRgEajweVyod1uMxgM2O12BAGUgRbU8DV2JpOhVquRz+cRQii3+XxOp9NRN3jVR5LPOp1OjEYjlSL8hclkgmmabDabt4d+m+S30vkD/R/IU4ABAPTZgnZdmG/PAAAAAElFTkSuQmCC");
      }
      #sidebar-bottom {
        background: #f5f5f5;
        border-top:1px solid #eee;
      }
      #sidebar-bottom .widget {
        border-bottom: 1px solid #e0e0e0;
        padding: 15px 0;
        text-align: center;
      }
      #sidebar-bottom > div:last-child {
        border-bottom: 0;
      }
      #sidebar-bottom .text {
        line-height: 20px;
      }
      /* Home, forward, and backward pagination. */
      .blog-pager {
        border-top : 1px #e0e0e0 solid;
        padding-top: 10px;
        margin-top: 15px;
        text-align: right !important;
      }
      #blog-pager {
        margin-botom: 0;
        margin-top: -14px;
        padding: 16px 0 0 0;
      }
      #blog-pager a {
        display: inline-block;
      }
      .blog-pager i.disabled {
        opacity: 0.2 !important;
      }
      .blog-pager i {
        color: black;
        margin-left: 16px;
        opacity: 0.54;
      }
      .blog-pager i:hover, .blog-pager i:active {
        opacity: 0.87;
      }
      #blog-pager-older-link, #blog-pager-newer-link {
        float: none;
      }
      .gplus-profile {
        background-color: #fafafa;
        border: 1px solid #eee;
        overflow: hidden;
        width: 212px;
      }
      .gplus-profile-inner {
        margin-left: -1px;
        margin-top: -1px;
      }
      /* Sidebar follow buttons. */
      .followgooglewrapper {
        padding: 12px 0 0 0;
      }
      .loading {
        visibility: hidden;
      }
      .detail-page .post-footer .cmt_iframe_holder {
        padding-top: 40px !important;
      }
      /** Desktop **/
      @media (max-width: 900px) {
        .col-right {
          display: none;
        }
        .col-main {
          margin-right: 0;
          min-width: initial;
        }
        .footer-outer {
          display: none;
        }
        .cols-wrapper {
          min-width: initial;
        }
        .google-footer-outer {
          background-color: #f5f5f5;
        }
      }
      /** Tablet **/
      @media (max-width: 712px) {
        .header-outer, .cols-wrapper, .footer-outer, .google-footer-outer {
          padding: 0 40px;
        }
      }
      /* An extra breakpoint accommodating for long blog titles. */
      @media (max-width: 600px) {
        .header-left {
          height: 100%;
          top: inherit;
          margin-top: 0;
          -webkit-transform: initial;
          transform: initial;
        }
        .header-title {
          margin-top: 18px;
        }
        .header-inner .google-logo {
          height: 40px;
          margin-top: 3px;
        }
        .header-inner .google-logo img {
          height: 42px;
        }
        .header-title h2 {
          font-size: 32px;
          line-height: 40px;
        }
        .header-desc {
          bottom: 24px;
          position: absolute;
        }
      }
      /** Mobile/small desktop window; also landscape. **/
      @media (max-width: 480px), (max-height: 480px) {
        .header-outer, .cols-wrapper, .footer-outer, .google-footer-outer {
          padding: 0 16px;
        }
        .cols-wrapper {
          margin-top: 0;
        }
        .post-header .publishdate, .post .post-content {
          font-size: 16px;
        }
        .post .post-content {
          line-height: 28px;
          margin-bottom: 30px;
        }
        .post {
          margin-top: 30px;
        }
        .byline-author {
          display: block;
          font-size: 12px;
          line-height: 24px;
          margin-top: 6px;
        }
        #main .post .title a {
          font-weight: 500;
          color: #4c4c4c;
          color: rgba(0,0,0,.70);
        }
        #main .post .post-header {
          padding-bottom: 12px;
        }
        #main .post .post-header .published {
          margin-bottom: -8px;
          margin-top: 3px;
        }
        .post .read-more {
          display: block;
          margin-top: 14px;
        }
        .post .tr-caption {
          font-size: 12px;
        }
        #main .post .title a {
          font-size: 20px;
          line-height: 30px;
        }
        .post-content iframe {
          /* iframe won't keep aspect ratio when scaled down. */
          max-height: 240px;
        }
        .post-content .separator img, .post-content .tr-caption-container img, .post-content iframe {
          margin-left: -16px;
          max-width: inherit;
          width: calc(100% + 32px);
        }
        .post-content table, .post-content td {
          width: 100%;
        }
        #blog-pager {
          margin: 0;
          padding: 16px 0;
        }
        /** List page tweaks. **/
        .list-page .post-original {
          display: none;
        }
        .list-page .post-summary {
          display: block;
        }
        .list-page .comment-container {
          display: none;
        } 
        .list-page #blog-pager {
          padding-top: 0;
          border: 0;
          margin-top: -8px;
        }
        .list-page .label-footer {
          display: none;
        }
        .list-page #main .post .post-footer {
          border-bottom: 1px solid #eee;
          margin: -16px 0 0 0;
          padding: 0 0 20px 0;
        }
        .list-page .post .share {
          display: none;
        }
        /** Detail page tweaks. **/
        .detail-page .post-footer .cmt_iframe_holder {
          padding-top: 32px !important;
        }
        .detail-page .label-footer {
          margin-bottom: 0;
        }
        .detail-page #main .post .post-footer {
          padding-bottom: 0;
        }
        .detail-page #comments {
          display: none;
        }
      }
      [data-about-pullquote], [data-is-preview], [data-about-syndication] {
        display: none;
      }
    </style>
<noscript>
<style>
        .loading { visibility: visible }</style>
</noscript>
<script type='text/javascript'>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-961555-22', 'auto', 'blogger');
        ga('blogger.send', 'pageview');
      </script>
<link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1176949257541686127&amp;zx=82d66ccf-3f73-48ad-bb3f-7eadc8a5b7f5' media='none' onload='if(media!=&#39;all&#39;)media=&#39;all&#39;' rel='stylesheet'/><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=1176949257541686127&amp;zx=82d66ccf-3f73-48ad-bb3f-7eadc8a5b7f5' rel='stylesheet'/></noscript>

</head>
<body>
<script type='text/javascript'>
      //<![CDATA[
      var axel = Math.random() + "";
      var a = axel * 10000000000000;
      document.write('<iframe src="https://2542116.fls.doubleclick.net/activityi;src=2542116;type=gblog;cat=googl0;ord=ord=' + a + '?" width="1" height="1" frameborder="0" style="display:none"></iframe>');
      //]]>
    </script>
<noscript>
<img alt='' height='1' src='https://ad.doubleclick.net/ddm/activity/src=2542116;type=gblog;cat=googl0;ord=1?' width='1'/>
</noscript>
<!-- Header -->
<div class='header-outer'>
<div class='header-inner'>
<div class='section' id='header'><div class='widget Header' data-version='1' id='Header1'>
<div class='header-left'>
<div class='header-title'>
<a class='google-logo' href='https://security.googleblog.com/'>
<img height='50' src='https://www.gstatic.com/images/branding/googlelogo/2x/googlelogo_color_150x54dp.png'/>
</a>
<a href='/.'>
<h2>
            Security Blog
          </h2>
</a>
</div>
<div class='header-desc'>
The latest news and insights from Google on security and safety on the Internet
</div>
</div>
</div></div>
</div>
</div>
<!-- all content wrapper start -->
<div class='cols-wrapper loading'>
<div class='col-main-wrapper'>
<div class='col-main'>
<div class='section' id='main'><div class='widget Blog' data-version='1' id='Blog1'>
<div class='post' data-id='1507951520742800008' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/06/announcing-new-abuse-research-grants.html' itemprop='url' title='Announcing New Abuse Research Grants Program '>
Announcing New Abuse Research Grants Program 
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
June 4, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Anna Hupa,&nbsp; Marc Henson, and Martin Straka, Google VRP Team&nbsp;<br /></span><div><span class="byline-author"><br /></span></div>Our Abuse Bug Bounty program has proved tremendously successful in the past three years since its introduction &#8211; thanks to our incredibly engaged community of researchers. Their contributions resulted in +1,000 valid bugs, helping us raise the bar in combating <a href="http://goo.gle/abuse-risk">product abuse</a>.<br /><br />As a result of this continued success, today we are announcing a new experimental Abuse Research Grants Program in addition to the already existing <a href="https://www.blogger.com/#">Vulnerability Research Grants</a>. Similar to other Research Grant Programs, these grants are up-front awards that our top researchers will receive before they ever submit a bug.<br /><br />Last year, we <a href="https://security.googleblog.com/2020/09/announcing-new-reward-amounts-for-abuse.html">increased our rewards</a> to recognize the important work of our community. The growth of this program would not have been possible without partners like David (<a href="https://twitter.com/xdavidhu">@xdavidhu</a>), Zohar (<a href="https://www.ehpus.com/">ehpus.com</a>), and Ademar (<a href="https://twitter.com/nowaskyjr">@nowaskyjr</a>) who, on top of becoming our top research experts in <a href="http://goo.gle/abuse-risk">Product Abuse</a>, regularly contribute to transparency by sharing their work, further inspiring and influencing our community of researchers.<br /><br />Despite the growth and success of this program, there remains more work to be done.<br /><br />With our new Abuse Research Grants Program, we hope to bring even more awareness to product abuse by connecting more closely with our experienced researchers &#8211; so we can all work together to overcome these challenges, prevent product abuse and keep our users safe. Here&#8217;s how the program works:<ul style="text-align: left;"><li>We invite our top abuse researchers to the program.</li><li>We award grants immediately before research begins, no strings attached.</li><li>Bug Hunters apply for the targets we share with them and start their research.</li><li>On top of the grant, researchers are eligible for regular rewards for the bugs they discover in scope of <a href="http://goo.gle/vrp">our Bug Bounty program</a>.</li></ul><div>To learn more about this and other grant programs, visit <a href="http://goo.gle/grantz">our rules page</a>.</div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Anna Hupa,&nbsp; Marc Henson, and Martin Straka, Google VRP Team&nbsp;<br /></span><div><span class="byline-author"><br /></span></div>Our Abuse Bug Bounty program has proved tremendously successful in the past three years since its introduction &#8211; thanks to our incredibly engaged community of researchers. Their contributions resulted in +1,000 valid bugs, helping us raise the bar in combating <a href="http://goo.gle/abuse-risk">product abuse</a>.<br /><br />As a result of this continued success, today we are announcing a new experimental Abuse Research Grants Program in addition to the already existing <a href="https://www.blogger.com/#">Vulnerability Research Grants</a>. Similar to other Research Grant Programs, these grants are up-front awards that our top researchers will receive before they ever submit a bug.<br /><br />Last year, we <a href="https://security.googleblog.com/2020/09/announcing-new-reward-amounts-for-abuse.html">increased our rewards</a> to recognize the important work of our community. The growth of this program would not have been possible without partners like David (<a href="https://twitter.com/xdavidhu">@xdavidhu</a>), Zohar (<a href="https://www.ehpus.com/">ehpus.com</a>), and Ademar (<a href="https://twitter.com/nowaskyjr">@nowaskyjr</a>) who, on top of becoming our top research experts in <a href="http://goo.gle/abuse-risk">Product Abuse</a>, regularly contribute to transparency by sharing their work, further inspiring and influencing our community of researchers.<br /><br />Despite the growth and success of this program, there remains more work to be done.<br /><br />With our new Abuse Research Grants Program, we hope to bring even more awareness to product abuse by connecting more closely with our experienced researchers &#8211; so we can all work together to overcome these challenges, prevent product abuse and keep our users safe. Here&#8217;s how the program works:<ul style="text-align: left;"><li>We invite our top abuse researchers to the program.</li><li>We award grants immediately before research begins, no strings attached.</li><li>Bug Hunters apply for the targets we share with them and start their research.</li><li>On top of the grant, researchers are eligible for regular rewards for the bugs they discover in scope of <a href="http://goo.gle/vrp">our Bug Bounty program</a>.</li></ul><div>To learn more about this and other grant programs, visit <a href="http://goo.gle/grantz">our rules page</a>.</div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:Announcing New Abuse Research Grants Program &url=https://security.googleblog.com/2021/06/announcing-new-abuse-research-grants.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/06/announcing-new-abuse-research-grants.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/06/announcing-new-abuse-research-grants.html' data-url='https://security.googleblog.com/2021/06/announcing-new-abuse-research-grants.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/06/announcing-new-abuse-research-grants.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
</div>
</div>
</div>
<div class='post' data-id='5770695344026067086' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/06/new-protections-for-enhanced-safe.html' itemprop='url' title='New protections for Enhanced Safe Browsing users in Chrome'>
New protections for Enhanced Safe Browsing users in Chrome
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
June 3, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Badr Salmi, Google Safe Browsing &amp; Varun Khaneja, Chrome Security</span>

<p>
In 2020 we <a href="https://security.googleblog.com/2020/05/enhanced-safe-browsing-protection-now.html">launched Enhanced Safe Browsing</a>, which you can turn on in your Chrome security <a href="https://support.google.com/chrome/answer/9890866">settings</a>, with the goal of substantially increasing safety on the web. These improvements are being built on top of existing security mechanisms that already protect billions of devices. Since the initial launch, we have continuously worked behind the scenes to improve our real-time URL checks and apply machine learning models to warn on previously-unknown attacks. As a result, Enhanced Safe Browsing users are successfully phished 35% less than other users.  Starting with Chrome 91, we will roll out new features to help Enhanced Safe Browsing users better choose their extensions, as well as offer additional protections against downloading malicious files on the web. 
</p>
<p>
<strong>Chrome extensions - Better protection before installation</strong>
</p>
<p>
Every day millions of people rely on Chrome extensions to help them be more productive, save money, shop or simply improve their browser experience. This is why it is important for us to continuously improve the safety of extensions published in the Chrome Web Store. For instance, through our integration with Google Safe Browsing in 2020, the number of malicious extensions that Chrome disabled to protect users grew by 81%. This comes on top of a <a href="https://blog.google/products/chrome/making-chrome-extensions-more-private-and-secure/">number of improvements</a> for more peace of mind when it comes to privacy and security.</p><p style="text-align: center;"><img src="https://lh5.googleusercontent.com/FqawlhuvGmAGlXuwqbze6zCQfmvQokXq6sc6kjc1L_YKHm4O7tH15IrysoZqRFTCzU65X3q7erilc3ua655d710koPtqFNalpaAAoirBbpKpFDvybqTwPYAGluQRjUU4eIL5KmKfjA=s16000" style="font-family: &quot;Google Sans Text&quot;, sans-serif; font-size: 11pt; font-weight: 700; margin-left: 0px; margin-top: 0px; white-space: pre-wrap;" /></p><p style="text-align: center;"><span id="docs-internal-guid-7fee1126-7fff-2526-625c-b3d6c96cc41b"><span style="font-family: &quot;Google Sans Text&quot;, sans-serif; font-size: 11pt; font-variant-east-asian: normal; font-variant-numeric: normal; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;"><span style="border: none; display: inline-block; height: 143px; overflow: hidden; width: 624px;"><img src="https://lh6.googleusercontent.com/yEWl-GP5OArPhD_L36_SesT79XCkBgARTiadvfQ-F6MQiX4DZk90XXZLRifs8ce8TEg4XzDyGGxExWtd9hOQ7TPUIbIn2kgzxJF3_sve6bdScD27chdCj3JDTu5fv5I9FMcIkOTJHw=s16000" style="margin-left: 0px; margin-top: 0px;" /></span></span></span></p><p>Enhanced Safe Browsing will now offer additional protection when you install a new extension from the Chrome Web Store. A dialog will inform you if an extension you&#8217;re about to install is not a part of the list of extensions trusted by Enhanced Safe Browsing.</p>
<p>
Any extensions built by a developer who follows the <a href="https://developer.chrome.com/docs/webstore/program_policies/">Chrome Web Store Developer Program Policies</a>, will be considered trusted by Enhanced Safe Browsing.  For new developers, it will take at least a few months of respecting these conditions to become trusted. Eventually, we strive for all developers with compliant extensions to reach this status upon meeting these criteria. Today, this represents nearly 75% of all extensions in the Chrome Web Store and we expect this number to keep growing as new developers become trusted.
</p>
<p>
<strong>Improved download protection</strong>
</p>
<p>
Enhanced Safe Browsing will now offer you even better protection against risky files.
</p>
<p><img alt="bad_file.exe may be dangerous. Send to Google for scanning?" src="https://lh5.googleusercontent.com/5TV-ovK2oV1Ii7_bU0OiCIYsmaEugtJaj4P2Bdk7vaiiU6C4_KDcdpUBVGzsSamt6EmU_oQXpSG9GHYwaxmdlKz6y-tDFhh7Vjs_g90eoYdWnwb-U9d8RMzpDvwFyKbP-Man3ug5Xb9opmMxuM-aO7rd4MOA7nJGtDgWLYHjGXnMMCBm=s16000" style="font-family: &quot;Google Sans Text&quot;, sans-serif; font-size: 11pt; margin-left: 0px; margin-top: 0px; white-space: pre-wrap;" />When you download a file, Chrome performs a first level check with Google Safe Browsing using metadata about the downloaded file, such as the digest of the contents and the source of the file, to determine whether it&#8217;s potentially suspicious. For any downloads that Safe Browsing deems risky, but not clearly unsafe, Enhanced Safe Browsing users will be presented with a warning and the ability to send the file to be scanned for a more in depth analysis (pictured above).</p>
<p>
If you choose to send the file, Chrome will upload it to Google Safe Browsing, which will scan it using its static and dynamic analysis classifiers in real time. After a short wait, if Safe Browsing determines the file is unsafe, Chrome will display a warning. As always, you can bypass the warning and open the file without scanning. Uploaded files are deleted from Safe Browsing a short time after scanning.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Badr Salmi, Google Safe Browsing &amp; Varun Khaneja, Chrome Security</span>

<p>
In 2020 we <a href="https://security.googleblog.com/2020/05/enhanced-safe-browsing-protection-now.html">launched Enhanced Safe Browsing</a>, which you can turn on in your Chrome security <a href="https://support.google.com/chrome/answer/9890866">settings</a>, with the goal of substantially increasing safety on the web. These improvements are being built on top of existing security mechanisms that already protect billions of devices. Since the initial launch, we have continuously worked behind the scenes to improve our real-time URL checks and apply machine learning models to warn on previously-unknown attacks. As a result, Enhanced Safe Browsing users are successfully phished 35% less than other users.  Starting with Chrome 91, we will roll out new features to help Enhanced Safe Browsing users better choose their extensions, as well as offer additional protections against downloading malicious files on the web. 
</p>
<p>
<strong>Chrome extensions - Better protection before installation</strong>
</p>
<p>
Every day millions of people rely on Chrome extensions to help them be more productive, save money, shop or simply improve their browser experience. This is why it is important for us to continuously improve the safety of extensions published in the Chrome Web Store. For instance, through our integration with Google Safe Browsing in 2020, the number of malicious extensions that Chrome disabled to protect users grew by 81%. This comes on top of a <a href="https://blog.google/products/chrome/making-chrome-extensions-more-private-and-secure/">number of improvements</a> for more peace of mind when it comes to privacy and security.</p><p style="text-align: center;"><img src="https://lh5.googleusercontent.com/FqawlhuvGmAGlXuwqbze6zCQfmvQokXq6sc6kjc1L_YKHm4O7tH15IrysoZqRFTCzU65X3q7erilc3ua655d710koPtqFNalpaAAoirBbpKpFDvybqTwPYAGluQRjUU4eIL5KmKfjA=s16000" style="font-family: &quot;Google Sans Text&quot;, sans-serif; font-size: 11pt; font-weight: 700; margin-left: 0px; margin-top: 0px; white-space: pre-wrap;" /></p><p style="text-align: center;"><span id="docs-internal-guid-7fee1126-7fff-2526-625c-b3d6c96cc41b"><span style="font-family: &quot;Google Sans Text&quot;, sans-serif; font-size: 11pt; font-variant-east-asian: normal; font-variant-numeric: normal; font-weight: 700; vertical-align: baseline; white-space: pre-wrap;"><span style="border: none; display: inline-block; height: 143px; overflow: hidden; width: 624px;"><img src="https://lh6.googleusercontent.com/yEWl-GP5OArPhD_L36_SesT79XCkBgARTiadvfQ-F6MQiX4DZk90XXZLRifs8ce8TEg4XzDyGGxExWtd9hOQ7TPUIbIn2kgzxJF3_sve6bdScD27chdCj3JDTu5fv5I9FMcIkOTJHw=s16000" style="margin-left: 0px; margin-top: 0px;" /></span></span></span></p><p>Enhanced Safe Browsing will now offer additional protection when you install a new extension from the Chrome Web Store. A dialog will inform you if an extension you&#8217;re about to install is not a part of the list of extensions trusted by Enhanced Safe Browsing.</p>
<p>
Any extensions built by a developer who follows the <a href="https://developer.chrome.com/docs/webstore/program_policies/">Chrome Web Store Developer Program Policies</a>, will be considered trusted by Enhanced Safe Browsing.  For new developers, it will take at least a few months of respecting these conditions to become trusted. Eventually, we strive for all developers with compliant extensions to reach this status upon meeting these criteria. Today, this represents nearly 75% of all extensions in the Chrome Web Store and we expect this number to keep growing as new developers become trusted.
</p>
<p>
<strong>Improved download protection</strong>
</p>
<p>
Enhanced Safe Browsing will now offer you even better protection against risky files.
</p>
<p><img alt="bad_file.exe may be dangerous. Send to Google for scanning?" src="https://lh5.googleusercontent.com/5TV-ovK2oV1Ii7_bU0OiCIYsmaEugtJaj4P2Bdk7vaiiU6C4_KDcdpUBVGzsSamt6EmU_oQXpSG9GHYwaxmdlKz6y-tDFhh7Vjs_g90eoYdWnwb-U9d8RMzpDvwFyKbP-Man3ug5Xb9opmMxuM-aO7rd4MOA7nJGtDgWLYHjGXnMMCBm=s16000" style="font-family: &quot;Google Sans Text&quot;, sans-serif; font-size: 11pt; margin-left: 0px; margin-top: 0px; white-space: pre-wrap;" />When you download a file, Chrome performs a first level check with Google Safe Browsing using metadata about the downloaded file, such as the digest of the contents and the source of the file, to determine whether it&#8217;s potentially suspicious. For any downloads that Safe Browsing deems risky, but not clearly unsafe, Enhanced Safe Browsing users will be presented with a warning and the ability to send the file to be scanned for a more in depth analysis (pictured above).</p>
<p>
If you choose to send the file, Chrome will upload it to Google Safe Browsing, which will scan it using its static and dynamic analysis classifiers in real time. After a short wait, if Safe Browsing determines the file is unsafe, Chrome will display a warning. As always, you can bypass the warning and open the file without scanning. Uploaded files are deleted from Safe Browsing a short time after scanning.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:New protections for Enhanced Safe Browsing users in Chrome&url=https://security.googleblog.com/2021/06/new-protections-for-enhanced-safe.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/06/new-protections-for-enhanced-safe.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/06/new-protections-for-enhanced-safe.html' data-url='https://security.googleblog.com/2021/06/new-protections-for-enhanced-safe.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/06/new-protections-for-enhanced-safe.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
</div>
</div>
</div>
<div class='post' data-id='2776636299632173107' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/05/introducing-security-by-design.html' itemprop='url' title='Introducing Security By Design'>
Introducing Security By Design
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
May 26, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Jon Markoff and Sean Smith, Android Security and Privacy Team</span><div class="separator" style="clear: both; text-align: center;"><span style="border: none; display: inline-block; height: 200px; margin-left: 1em; margin-right: 1em; overflow: hidden; width: 624px;"><img height="200" src="https://lh4.googleusercontent.com/u5UyBgVZhxVh4a-d1qtzZCnXSX5YZ0sFuco0AP4mY7vKzRIpD2hPcPA_eUkXp5uiqe_CFFoogD4ReAgbkGqykXFH0rTd30t9r4_gspBACFb4rm-KaWvfZ5b_Dqy5SmyKSjQzEjA4KGMuNQN4mqqJ_gWYzs0evNzU66B8msaUktLNz3q0" style="margin-left: 0px; margin-top: 0px;" width="624" /></span></div><div>

<p>
Integrating security into your app development lifecycle can save a lot of time, money, and risk. That&#8217;s why we&#8217;ve launched <a href="https://playacademy.exceedlms.com/student/path/63550-security-by-design">Security by Design</a> on <a href="https://playacademy.exceedlms.com/student/catalog">Google Play Academy</a> to help developers identify, mitigate, and proactively protect against security threats.
</p>
<p>
The Android ecosystem, including Google Play, has many built-in security features that help protect developers and users. The course <em><a href="https://g.co/playacademy/security?utm_source=google&amp;utm_medium=blog&amp;utm_campaign=Security&amp;utm_content=androidblog">Introduction to app security best practices</a></em> takes these protections one step further by helping you take advantage of additional security features to build into your app. For example, <a href="https://developer.android.com/topic/security/data">Jetpack Security</a> helps developers properly encrypt their data at rest and provides only safe and well known algorithms for encrypting Files and SharedPreferences. The <a href="https://developer.android.com/training/safetynet/attestation">SafetyNet Attestation API</a> is a solution to help identify potentially dangerous patterns in usage. There are several common design vulnerabilities that are important to look out for, including using shared or improper file storage, using insecure protocols, unprotected components such as Activities, and more. The course also provides methods to test your app in order to help you keep it safe after launch. Finally, you can set up a <a href="https://developers.google.com/android/play-protect/starting-a-vdp">Vulnerability Disclosure Program</a> (VDP) to engage security researchers to help. 
</p>
<p>
In the next course, you can learn how to integrate security at every stage of the development process by adopting the <a href="https://playacademy.exceedlms.com/student/activity/69287-introduction-to-the-security-development-lifecycle">Security Development Lifecycle</a> (SDL). The SDL is an industry standard process and in this course you&#8217;ll learn the fundamentals of setting up a program, getting executive sponsorship and integration into your development lifecycle.
</p>
<p>
Threat modeling is part of the Security Development Lifecycle, and in this course you will learn to think like an attacker to identify, categorize, and address threats. By doing so early in the design phase of development, you can identify potential threats and start planning for how to mitigate them at a much lower cost and create a more secure product for your users.
</p>
<p>
Improving your app&#8217;s security is a never ending process. Sign up for the Security by Design <a href="https://playacademy.exceedlms.com/student/path/63550-security-by-design">module</a> where in a few short courses, you will learn how to integrate security into your app development lifecycle, model potential threats, and app security best practices into your app, as well as avoid potential design pitfalls.
</p></div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Jon Markoff and Sean Smith, Android Security and Privacy Team</span><div class="separator" style="clear: both; text-align: center;"><span style="border: none; display: inline-block; height: 200px; margin-left: 1em; margin-right: 1em; overflow: hidden; width: 624px;"><img height="200" src="https://lh4.googleusercontent.com/u5UyBgVZhxVh4a-d1qtzZCnXSX5YZ0sFuco0AP4mY7vKzRIpD2hPcPA_eUkXp5uiqe_CFFoogD4ReAgbkGqykXFH0rTd30t9r4_gspBACFb4rm-KaWvfZ5b_Dqy5SmyKSjQzEjA4KGMuNQN4mqqJ_gWYzs0evNzU66B8msaUktLNz3q0" style="margin-left: 0px; margin-top: 0px;" width="624" /></span></div><div>

<p>
Integrating security into your app development lifecycle can save a lot of time, money, and risk. That&#8217;s why we&#8217;ve launched <a href="https://playacademy.exceedlms.com/student/path/63550-security-by-design">Security by Design</a> on <a href="https://playacademy.exceedlms.com/student/catalog">Google Play Academy</a> to help developers identify, mitigate, and proactively protect against security threats.
</p>
<p>
The Android ecosystem, including Google Play, has many built-in security features that help protect developers and users. The course <em><a href="https://g.co/playacademy/security?utm_source=google&amp;utm_medium=blog&amp;utm_campaign=Security&amp;utm_content=androidblog">Introduction to app security best practices</a></em> takes these protections one step further by helping you take advantage of additional security features to build into your app. For example, <a href="https://developer.android.com/topic/security/data">Jetpack Security</a> helps developers properly encrypt their data at rest and provides only safe and well known algorithms for encrypting Files and SharedPreferences. The <a href="https://developer.android.com/training/safetynet/attestation">SafetyNet Attestation API</a> is a solution to help identify potentially dangerous patterns in usage. There are several common design vulnerabilities that are important to look out for, including using shared or improper file storage, using insecure protocols, unprotected components such as Activities, and more. The course also provides methods to test your app in order to help you keep it safe after launch. Finally, you can set up a <a href="https://developers.google.com/android/play-protect/starting-a-vdp">Vulnerability Disclosure Program</a> (VDP) to engage security researchers to help. 
</p>
<p>
In the next course, you can learn how to integrate security at every stage of the development process by adopting the <a href="https://playacademy.exceedlms.com/student/activity/69287-introduction-to-the-security-development-lifecycle">Security Development Lifecycle</a> (SDL). The SDL is an industry standard process and in this course you&#8217;ll learn the fundamentals of setting up a program, getting executive sponsorship and integration into your development lifecycle.
</p>
<p>
Threat modeling is part of the Security Development Lifecycle, and in this course you will learn to think like an attacker to identify, categorize, and address threats. By doing so early in the design phase of development, you can identify potential threats and start planning for how to mitigate them at a much lower cost and create a more secure product for your users.
</p>
<p>
Improving your app&#8217;s security is a never ending process. Sign up for the Security by Design <a href="https://playacademy.exceedlms.com/student/path/63550-security-by-design">module</a> where in a few short courses, you will learn how to integrate security into your app development lifecycle, model potential threats, and app security best practices into your app, as well as avoid potential design pitfalls.
</p></div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:Introducing Security By Design&url=https://security.googleblog.com/2021/05/introducing-security-by-design.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/05/introducing-security-by-design.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/05/introducing-security-by-design.html' data-url='https://security.googleblog.com/2021/05/introducing-security-by-design.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/05/introducing-security-by-design.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
<span class='labels-caption'>
Labels:
</span>
<span class='labels'>
<a class='label' href='https://security.googleblog.com/search/label/android' rel='tag'>
android
</a>

                                ,
                              
<a class='label' href='https://security.googleblog.com/search/label/android%20security' rel='tag'>
android security
</a>

                                ,
                              
<a class='label' href='https://security.googleblog.com/search/label/app%20security' rel='tag'>
app security
</a>

                                ,
                              
<a class='label' href='https://security.googleblog.com/search/label/encryption' rel='tag'>
encryption
</a>
</span>
</div>
</div>
</div>
<div class='post' data-id='9190897915831707442' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/05/introducing-half-double-new-hammering.html' itemprop='url' title='Introducing Half-Double: New hammering technique for DRAM Rowhammer bug '>
Introducing Half-Double: New hammering technique for DRAM Rowhammer bug 
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
May 25, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Research Team: Salman Qazi, Yoongu Kim, Nicolas Boichat, Eric Shiu &amp; Mattias Nissler&nbsp;<br /></span><br />Today, we are sharing details around our discovery of <a href="https://github.com/google/hammer-kit/blob/main/20210525_half_double.pdf">Half-Double</a>, a new Rowhammer technique that capitalizes on the worsening physics of some of the newer DRAM chips to alter the contents of memory.<br /><br />Rowhammer is a DRAM vulnerability whereby repeated accesses to one address can tamper with the data stored at other addresses. Much like speculative execution vulnerabilities in CPUs, Rowhammer is a breach of the security guarantees made by the underlying hardware. As an electrical coupling phenomenon within the silicon itself, Rowhammer allows the potential bypass of hardware and software memory protection policies. This can allow untrusted code to break out of its sandbox and take full control of the system.<br /><br />Rowhammer was first discussed in a <a href="https://users.ece.cmu.edu/~yoonguk/papers/kim-isca14.pdf">paper</a> in 2014 for what was then the mainstream generation of DRAM: DDR3. The following year, Google&#8217;s Project Zero released a working privilege-escalation <a href="https://googleprojectzero.blogspot.com/2015/03/exploiting-dram-rowhammer-bug-to-gain.html">exploit</a>. In response, DRAM manufacturers implemented proprietary logic inside their chips that attempted to track frequently accessed addresses and reactively mitigate when necessary.<br /><br />As DDR4 became widely adopted, it appeared as though Rowhammer had faded away thanks in part to these built-in defense mechanisms. However, in 2020, the <a href="https://www.vusec.net/projects/trrespass/">TRRespass</a> paper showed how to reverse-engineer and neutralize the defense by distributing accesses, demonstrating that Rowhammer techniques are still viable. Earlier this year, the <a href="https://www.vusec.net/projects/smash/">SMASH</a> research went one step further and demonstrated exploitation from JavaScript, without invoking cache-management primitives or system calls.<br /><br />Traditionally, Rowhammer was understood to operate at a distance of one row: when a DRAM row is accessed repeatedly (the &#8220;aggressor&#8221;), bit flips were found only in the two adjacent rows (the &#8220;victims&#8221;). However, with Half-Double, we have observed Rowhammer effects propagating to rows beyond adjacent neighbors, albeit at a reduced strength. Given three consecutive rows A, B, and C, we were able to attack C by directing a very large number of accesses to A, along with just a handful (~dozens) to B. Based on our experiments, accesses to B have a non-linear gating effect, in which they appear to &#8220;transport&#8221; the Rowhammer effect of A onto C. Unlike TRRespass, which exploits the blind spots of manufacturer-dependent defenses, Half-Double is an intrinsic property of the underlying silicon substrate. This is likely an indication that the electrical coupling responsible for Rowhammer is a property of distance, effectively becoming stronger and longer-ranged as cell geometries shrink down. Distances greater than two are conceivable.<div><br /><img src="https://lh3.googleusercontent.com/tGDqIvEueBY6NLESevtjLzZdUMkkCJbuhfEc0zTVHFriANpGG0zzdXwooPRwjqrwvuB9x-MpcsunqbIo1E1BXBaQwiLY5c1L2ueBP3jpMm8djj00U8d2q3MzdiSDEWzK7Ryrjhz2kQ" /><br /><br /><br /></div><div>Google has been working with <a href="https://www.jedec.org/">JEDEC</a>, an independent semiconductor engineering trade organization, along with other industry partners, in search of possible solutions for the Rowhammer phenomenon. JEDEC has published two documents about DRAM and system-level mitigation techniques (JEP <a href="https://www.jedec.org/standards-documents/docs/jep300-1">300-1</a> and JEP<a href="https://www.jedec.org/standards-documents/docs/jep301-1">301-1</a>).<br /><br />We are disclosing this work because we believe that it significantly advances the understanding of the Rowhammer phenomenon, and that it will help both researchers and industry partners to work together, to develop lasting solutions. The challenge is substantial and the ramifications are industry-wide. We encourage all stakeholders (server, client, mobile, automotive, IoT) to join the effort to develop a practical and effective solution that benefits all of our users.</div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Research Team: Salman Qazi, Yoongu Kim, Nicolas Boichat, Eric Shiu &amp; Mattias Nissler&nbsp;<br /></span><br />Today, we are sharing details around our discovery of <a href="https://github.com/google/hammer-kit/blob/main/20210525_half_double.pdf">Half-Double</a>, a new Rowhammer technique that capitalizes on the worsening physics of some of the newer DRAM chips to alter the contents of memory.<br /><br />Rowhammer is a DRAM vulnerability whereby repeated accesses to one address can tamper with the data stored at other addresses. Much like speculative execution vulnerabilities in CPUs, Rowhammer is a breach of the security guarantees made by the underlying hardware. As an electrical coupling phenomenon within the silicon itself, Rowhammer allows the potential bypass of hardware and software memory protection policies. This can allow untrusted code to break out of its sandbox and take full control of the system.<br /><br />Rowhammer was first discussed in a <a href="https://users.ece.cmu.edu/~yoonguk/papers/kim-isca14.pdf">paper</a> in 2014 for what was then the mainstream generation of DRAM: DDR3. The following year, Google&#8217;s Project Zero released a working privilege-escalation <a href="https://googleprojectzero.blogspot.com/2015/03/exploiting-dram-rowhammer-bug-to-gain.html">exploit</a>. In response, DRAM manufacturers implemented proprietary logic inside their chips that attempted to track frequently accessed addresses and reactively mitigate when necessary.<br /><br />As DDR4 became widely adopted, it appeared as though Rowhammer had faded away thanks in part to these built-in defense mechanisms. However, in 2020, the <a href="https://www.vusec.net/projects/trrespass/">TRRespass</a> paper showed how to reverse-engineer and neutralize the defense by distributing accesses, demonstrating that Rowhammer techniques are still viable. Earlier this year, the <a href="https://www.vusec.net/projects/smash/">SMASH</a> research went one step further and demonstrated exploitation from JavaScript, without invoking cache-management primitives or system calls.<br /><br />Traditionally, Rowhammer was understood to operate at a distance of one row: when a DRAM row is accessed repeatedly (the &#8220;aggressor&#8221;), bit flips were found only in the two adjacent rows (the &#8220;victims&#8221;). However, with Half-Double, we have observed Rowhammer effects propagating to rows beyond adjacent neighbors, albeit at a reduced strength. Given three consecutive rows A, B, and C, we were able to attack C by directing a very large number of accesses to A, along with just a handful (~dozens) to B. Based on our experiments, accesses to B have a non-linear gating effect, in which they appear to &#8220;transport&#8221; the Rowhammer effect of A onto C. Unlike TRRespass, which exploits the blind spots of manufacturer-dependent defenses, Half-Double is an intrinsic property of the underlying silicon substrate. This is likely an indication that the electrical coupling responsible for Rowhammer is a property of distance, effectively becoming stronger and longer-ranged as cell geometries shrink down. Distances greater than two are conceivable.<div><br /><img src="https://lh3.googleusercontent.com/tGDqIvEueBY6NLESevtjLzZdUMkkCJbuhfEc0zTVHFriANpGG0zzdXwooPRwjqrwvuB9x-MpcsunqbIo1E1BXBaQwiLY5c1L2ueBP3jpMm8djj00U8d2q3MzdiSDEWzK7Ryrjhz2kQ" /><br /><br /><br /></div><div>Google has been working with <a href="https://www.jedec.org/">JEDEC</a>, an independent semiconductor engineering trade organization, along with other industry partners, in search of possible solutions for the Rowhammer phenomenon. JEDEC has published two documents about DRAM and system-level mitigation techniques (JEP <a href="https://www.jedec.org/standards-documents/docs/jep300-1">300-1</a> and JEP<a href="https://www.jedec.org/standards-documents/docs/jep301-1">301-1</a>).<br /><br />We are disclosing this work because we believe that it significantly advances the understanding of the Rowhammer phenomenon, and that it will help both researchers and industry partners to work together, to develop lasting solutions. The challenge is substantial and the ramifications are industry-wide. We encourage all stakeholders (server, client, mobile, automotive, IoT) to join the effort to develop a practical and effective solution that benefits all of our users.</div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:Introducing Half-Double: New hammering technique for DRAM Rowhammer bug &url=https://security.googleblog.com/2021/05/introducing-half-double-new-hammering.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/05/introducing-half-double-new-hammering.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/05/introducing-half-double-new-hammering.html' data-url='https://security.googleblog.com/2021/05/introducing-half-double-new-hammering.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/05/introducing-half-double-new-hammering.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
<span class='labels-caption'>
Labels:
</span>
<span class='labels'>
<a class='label' href='https://security.googleblog.com/search/label/Rowhammer' rel='tag'>
Rowhammer
</a>

                                ,
                              
<a class='label' href='https://security.googleblog.com/search/label/Security' rel='tag'>
Security
</a>
</span>
</div>
</div>
</div>
<div class='post' data-id='8924626663007564435' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/05/integrating-rust-into-android-open.html' itemprop='url' title='Integrating Rust Into the Android Open Source Project'>
Integrating Rust Into the Android Open Source Project
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
May 11, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Ivan Lozano, Android Team</span>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-uJBb_SOirIg/YJq9BWzQxOI/AAAAAAAADy8/QXv_oGYYR08oGIB-GAh95bWjg691PfimgCNcBGAsYHQ/s0/EC924D33-F820-433D-968E-C4234D0CE4AE_4_5005_c.jpeg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="313" data-original-width="552" src="https://1.bp.blogspot.com/-uJBb_SOirIg/YJq9BWzQxOI/AAAAAAAADy8/QXv_oGYYR08oGIB-GAh95bWjg691PfimgCNcBGAsYHQ/s0/EC924D33-F820-433D-968E-C4234D0CE4AE_4_5005_c.jpeg"/></a></div>
<p>
The Android team has been working on introducing the Rust programming language into the Android Open Source Project (AOSP) since 2019 as a memory-safe alternative for platform native code development. As with any large project, introducing a new language requires careful consideration. For Android, one important area was assessing how to best fit Rust into Android&#8217;s build system. Currently this means the <a href="https://source.android.com/setup/build">Soong</a> build system (where the Rust support resides), but these design decisions and considerations are equally applicable for <a href="https://blog.bazel.build/2020/11/12/aosp_migrating_to_bazel.html">Bazel</a> when AOSP migrates to that build system. This post discusses some of the key design considerations and resulting decisions we made in integrating Rust support into Android&#8217;s build system.
</p>
<h2>Rust integration into large projects</h2>


<p>
A RustConf 2019 meeting on <a href="https://users.rust-lang.org/t/rust-in-large-organizations-meeting/32059">Rust usage within large organizations</a> highlighted several challenges, such as the risk that eschewing Cargo in favor of using the Rust Compiler, <code>rustc, </code> directly (see next section) may remove organizations from the wider Rust community. We share this same concern. When changes to imported third-party crates might be beneficial to the wider community, our goal is to upstream those changes. Likewise when crates developed for Android could benefit the wider Rust community, we hope to release them as independent crates. We believe that the success of Rust within Android is dependent on minimizing any divergence between Android and the Rust community at large, and hope that the Rust community will benefit from Android&#8217;s involvement.
</p>
<h2>No nested build systems</h2>


<p>
Rust provides Cargo as the default <a href="https://doc.rust-lang.org/book/ch01-03-hello-cargo.html">build system and package manager</a>, collecting dependencies and invoking <code>rustc</code> (the Rust compiler) to build the target crate (Rust package). <a href="https://android.googlesource.com/platform/build/soong/+/refs/heads/master/README.md">Soong</a> takes this role instead in Android and calls <code>rustc</code> directly for several reasons:
</p>
<ul>

<li>In Cargo, C dependencies are handled independently in an ad-hoc manner via build.rs scripts. Soong already provides a mechanism for building C libraries and defining them as dependencies, and Android carefully controls the compiler version and global compilation flags to ensure libraries are built a particular way. Relying on Cargo would introduce a second non-Soong mechanism for defining/building C libraries that would not be constrained by the carefully selected compilation controls implemented in Soong. This could also lead to multiple different versions of the same library, negatively impacting memory/disk usage. 

<li>Calling compilers directly through Soong provides the stability and control Android requires for the variety of build configurations it supports (for example, specifying where target-specific dependencies are and which compilation flags to use). While it would technically be possible to achieve the necessary level of control over <code>rustc</code> indirectly through Cargo, Soong would have no understanding of how the <code>Cargo.toml</code> (the Cargo build file) would influence the commands Cargo emits to <code>rustc</code>. Paired with the fact that Cargo evolves independently, this would severely restrict Soong&#8217;s ability to precisely control how build artifacts are created. 

<li>Builds which are self-contained and insensitive to the host configuration, known as <strong>hermetic builds</strong>, are necessary for Android to produce reproducible builds. Cargo, which relies on <strong><code>build.rs</code></strong> scripts, doesn&#8217;t yet provide hermeticity guarantees.

<li>Incremental builds are important to maintain engineering productivity; building Android takes a considerable amount of resources. Cargo was not designed for integration into existing build systems and does not expose its compilation units. Each Cargo invocation builds <a href="https://github.com/rust-lang/rust-roadmap-2017/issues/12#issuecomment-278118819">the entire crate dependency graph</a> for a given <code>Cargo.toml</code>, rebuilding crates multiple times across projects<sup id="fnref1"><a href="#fn1" rel="footnote">1</a></sup>. This is too coarse for integration into Soong&#8217;s incremental build support, which expects smaller compilation units. This support is necessary to scale up Rust usage within Android.
<p>
Using the Rust compiler directly allows us to avoid these issues and is consistent with how we compile all other code in AOSP. It provides the most control over the build process and eases integration into Android&#8217;s existing build system. Unfortunately, avoiding it introduces several challenges and influences many other build system decisions because Cargo usage is so deeply ingrained in the Rust crate ecosystem. 
</p>
<h2>No build.rs scripts</h2>


<p>
A<code> build.rs </code>script compiles to a Rust binary which Cargo builds and executes during a build to handle pre-build tasks, commonly setting up the build environment, or building libraries in other languages (for example C/C++). This is analogous to configure scripts used for other languages. 
</p>
<p>
Avoiding <code>build.rs</code> scripts somewhat flows naturally from not relying on Cargo since supporting these would require replicating Cargo behavior and assumptions. Beyond this however, there are good reasons for AOSP to avoid build scripts as well:
</p>
<ul>

<li><code>build.rs</code> scripts can execute arbitrary code on the build host. From a security perspective, this introduces an additional burden when adding or updating third-party code as the <code>build.rs</code> script needs careful scrutiny.

<li>Third-party <code>build.rs</code> scripts may not be hermetic or reproducible in <a href="https://github.com/rust-lang/cargo/issues/9273#issuecomment-800765010">potentially subtle ways</a>. It is also common for <code>build.rs</code> files to access files outside the build directory (such as <code>/usr/lib</code>). When they are not hermetic, we would need to either carry a local patch or work with upstream to resolve the issue.

<li>The most common task for <code>build.rs</code> is to build C libraries which Rust code depends on. We already support this through Soong.

<li>Android likewise avoids running build scripts while building for other languages, instead, simply using them to inform the structure of the <code>Android.bp</code> file.
</li>
</ul>
</li>
</ul>
<p>
For instances in third-party code where a build script is used only to compile C dependencies, we either use existing <code>cc_library</code> Soong definitions (such as <a href="https://cs.android.com/android/platform/superproject/+/master:external/boringssl/Android.bp;drc=859a48db620ed6a63b786182d1bb55f04d1f124c;l=312">boringssl</a> for <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/quiche/Android.bp;drc=1b19aa5ba6b71372df6ec176d15993631552c2eb;l=65">quiche</a>) or <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/grpcio-sys/Android.bp;drc=bb4f797895a614ac15d1ea90a62660900a6a6b30;l=68">create new definitions</a> for crate-specific code. 
</p>
<p>
When the <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/build.rs;l=379;drc=cc6e6357c57e09c4078b3c54cac455111dd3e221">build.rs is used to generate source</a>, we try to replicate <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/android/build.rs;drc=ae93c4c77b203617f6fdf5e5e6a0e1fee02caa91">the core functionality</a> in a Soong <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/android/Android.bp;drc=0f6dcf73b798c60a4ff204cc4b1a98572fec3393">rust_binary</a> module for use as a <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/Android.bp;drc=0f6dcf73b798c60a4ff204cc4b1a98572fec3393;l=132">custom source generator</a>. In other cases where Soong can provide the information without source generation, we may carry a <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/rustversion/patches/version.diff;drc=d550abe65fea6425374f69306f0a4e74585b238c">small patch</a> that leverages this information.
</p>
<h3>Why proc_macro but not build.rs?</h3>


<p>
Why do we support <code>proc_macros</code>, which are compiler plug-ins that execute code on the host within the compiler context, but not <code>build.rs</code> scripts?
</p>
<p>
While <code>build.rs</code> code is written as one-off code to handle building a single crate, <code>proc_macros </code>define reusable functionality within the compiler which can become widely relied upon across the Rust community. As a result popular <code>proc_macros</code> are generally better maintained and more scrutinized upstream, which makes the code review process more manageable. They are also more readily sandboxed as part of the build process since they are less likely to have dependencies external to the compiler.
</p>
<p>
<code>proc_macros</code> are also a language feature rather than a method for building code. These are relied upon by source code, are unavoidable for third-party dependencies, and are useful enough to define and use within our platform code. While we can avoid build.rs by leveraging our build system, the same can&#8217;t be said of proc_macros.
</p>
<p>
There is also precedence for compiler plugin support within the Android build system. For example see Soong&#8217;s <a href="https://ci.android.com/builds/submitted/7271141/linux/latest/raw/java.html#java_plugin">java_plugin</a> modules.
</p>
<h2>Generated source as crates</h2>


<p>
Unlike C/C++ compilers, <code>rustc</code> only accepts a single source file representing an entry point to a binary or library. It expects that the source tree is structured such that all required source files can be automatically discovered. This means that generated source either needs to be placed in the source tree or provided through an include directive in source:
</p>



<pre class="prettyprint">include!("/path/to/hello.rs");</pre>


<p>
The Rust community depends on <code>build.rs</code> scripts alongside assumptions about the Cargo build environment to <a href="https://doc.rust-lang.org/cargo/reference/build-script-examples.html#code-generation">get around this limitation</a>. When building, the <code>cargo</code> command sets an <a href="https://doc.rust-lang.org/cargo/reference/environment-variables.html#environment-variables-cargo-sets-for-crates">OUT_DIR environment variable</a> which build.rs scripts are expected to place generated source code in. This source can then be included via:
</p>



<pre class="prettyprint">include!(concat!(env!("OUT_DIR"), "/hello.rs"));</pre>


<p>
This presents a challenge for Soong as outputs for each module are placed in their own <code>out/</code> directory<sup id="fnref2"><a href="#fn2" rel="footnote">2</a></sup>; there is no single <code>OUT_DIR</code> where dependencies output their generated source.
</p>
<p>
For platform code, we prefer to package generated source into a crate that can be imported. There are a few reasons to favor this approach:
</p>
<ul>

<li>Prevent generated source file names from colliding.

<li>Reduce <a href="https://github.com/rust-lang/rust-bindgen/blob/master/book/src/tutorial-4.md">boilerplate code</a> checked-in throughout the tree and which needs to be maintained. Any boilerplate necessary to make the <a href="https://cs.android.com/android/platform/superproject/+/master:build/soong/rust/protobuf.go;drc=6eff900b67a0ed7e639ae304b1d453b620e9b79d;l=174">generated source compile</a> into a crate can be centrally maintained.

<li>Avoid implicit<sup id="fnref3"><a href="#fn3" rel="footnote">3</a></sup> interactions between generated code and the surrounding crate.  

<li>Reduce pressure on memory and disk by dynamically liking commonly used generated sources.
<p>
As a result, all of Android&#8217;s Rust source generation module types produce code that can be compiled and used <a href="https://cs.android.com/android/platform/superproject/+/master:system/bt/gd/rust/facade/Android.bp;drc=92fa0f9ac23d547cfa62ddbf9e92e7755e1b1df6;l=19">as a crate</a>.
</p>
<p>
We still support third-party crates without modification by copying all the generated source dependencies for a module into a single per-module directory similar to Cargo. Soong then sets the <code>OUT_DIR</code> environment variable to that directory when compiling the module so the generated source can be found. However we discourage use of this mechanism in platform code unless absolutely necessary for the reasons described above.
</p>
<h2>Dynamic linkage by default</h2>


<p>
By default, the Rust ecosystem assumes that crates will be <a href="https://github.com/rust-lang/rust/issues/10209">statically linked into binaries</a>. The usual benefits of dynamic libraries are upgrades (whether for security or functionality) and decreased memory usage. Rust&#8217;s lack of a stable binary interface and usage of cross-crate information flow prevents upgrading libraries without upgrading all dependent code. Even when the same crate is used by two different programs on the system, it is unlikely to be provided by the same shared object<sup id="fnref4"><a href="#fn4" rel="footnote">4</a></sup> due to the precision with which Rust identifies its crates. This makes Rust binaries more portable but also results in larger disk and memory footprints.
</p>
<p>
This is problematic for Android devices where resources like memory and disk usage must be carefully managed because statically linking all crates into Rust binaries would result in excessive code duplication (especially in the standard library). However, our situation is also different from the standard host environment: we build Android using global decisions about dependencies. This means that nearly every crate is shareable between all users of that crate. Thus, we opt to link crates dynamically by default for device targets. This reduces the overall memory footprint of Rust in Android by allowing crates to be reused across multiple binaries which depend on them.
</p>
<p>
Since this is unusual in the Rust community, not all third-party crates support dynamic compilation. Sometimes we must carry <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/untrusted/patches/std.diff;drc=e595b63c7542df5941c7701feaf9b1e82919e80e">small patches</a> while we <a href="https://github.com/rust-lang/rust/pull/81469">work with</a> <a href="https://github.com/dtolnay/cxx/pulls?q=is%3Apr+author%3Ajgalenson">upstream maintainers</a> to add support.
</p>
<h2>Current Status of Build Support</h2>


<p>
We support building all output types supported by <code>rustc</code> (<code>rlib</code>s, <code>dylib</code>s, <code>proc_macro</code>s, <code>cdylib</code>s, <code>staticlib</code>s, and executables). Rust modules can automatically request the appropriate crate linkage for a given dependency (<code>rlib</code> vs <code>dylib</code>). C and C++ modules can depend on Rust <code>cdylib</code> or <code>staticlib</code> producing modules the same way as they would for a C or C++ library.
</p>
<p>
In addition to being able to build Rust code, Android&#8217;s build system also provides support for <a href="https://ci.android.com/builds/submitted/7279978/linux/latest/raw/rust.html#rust_protobuf">protobuf and gRPC</a> and <a href="https://ci.android.com/builds/submitted/7279978/linux/latest/raw/aidl.html#aidl_interface">AIDL</a> generated crates. First-class <a href="https://ci.android.com/builds/submitted/7279978/linux/latest/raw/rust.html#rust_bindgen">bindgen</a> support makes interfacing with existing C code simple and we have support <a href="https://cs.android.com/android/platform/superproject/+/master:system/bt/gd/rust/shim/Android.bp;l=120">modules</a> using <a href="https://github.com/dtolnay/cxx">cxx</a> for tighter integration with C++ code.
</p>
<p>
The Rust community produces great tooling for developers, such as the <a href="https://microsoft.github.io/language-server-protocol/">language server</a> <a href="https://rust-analyzer.github.io/">rust-analyzer</a>. We have <a href="https://cs.android.com/android/platform/superproject/+/master:build/soong/rust/project_json.go;drc=e8b0ee73f4c2545aa0597a270cf6c56fdb60b1ab">integrated support</a> for rust-analyzer into the build system so that any IDE which supports it can provide code completion and goto definitions for Android modules.
</p>
<p>
<a href="https://blog.rust-lang.org/inside-rust/2020/11/12/source-based-code-coverage.html">Source-based code coverage</a> builds are supported to provide platform developers high level signals on how well their code is covered by tests. Benchmarks are supported as their own module type, leveraging the <a href="https://docs.rs/criterion/0.3.4/criterion/">criterion crate</a> to provide performance metrics. In order to maintain a consistent style and level of code quality, a default set of <code>clippy</code> lints and <code>rustc</code> lints are <a href="https://cs.android.com/android/platform/superproject/+/master:build/soong/rust/config/lints.go;drc=b6d0d9cec4f477b3280378929a0e58bad97648c8">enabled by default</a>. Additionally, HWASAN/ASAN fuzzers are <a href="https://cs.android.com/android/platform/superproject/+/master:tools/security/fuzzing/example_rust_fuzzer/fuzzer.rs;drc=9ff8023a095897862c99496e9bb30c32f1a58b42;l=1">supported</a>, with the HWASAN <code>rustc</code> support <a href="https://android-review.googlesource.com/c/toolchain/android_rust/+/1403627">added to upstream</a>. 
</p>
<p>
In the near future, we plan to add documentation to <a href="https://source.android.com/">source.android.com</a> on how to define and use Rust modules in Soong. We expect Android&#8217;s support for Rust to continue evolving alongside the Rust ecosystem and hope to continue to participate in discussions around how Rust can be integrated into existing build systems.<br>
</p>
<p>
<em>Thank you to Matthew Maurer, Jeff Vander Stoep, Joel Galenson, Manish Goregaokar, and Tyler Mandry for their contributions to this post.</em>
</p>

<!-- Footnotes themselves at the bottom. -->

<h2>Notes</h2>
<div class="footnotes">
<hr>
<ol><li id="fn1">

<p>
    This can be mitigated to some extent with workspaces, but requires a very specific directory arrangement that AOSP does not conform to.&nbsp;<a href="#fnref1" rev="footnote">&#8617;</a><li id="fn2">
<p>
     This presents no problem for C/C++ and similar languages as the path to the generated source is provided directly to the compiler.&nbsp;<a href="#fnref2" rev="footnote">&#8617;</a><li id="fn3">

<p>
     Since include! works by textual inclusion, it may reference values from the enclosing namespace, modify the namespace, or use constructs like #![foo]. These implicit interactions can be difficult to maintain. Macros should be preferred if interaction with the rest of the crate is truly required. &nbsp;<a href="#fnref3" rev="footnote">&#8617;</a><li id="fn4">
<p>
     While libstd would usually be shareable for the same compiler revision, most other libraries would end up with several copies for Cargo-built Rust binaries, since each build would attempt to use a minimum feature set and may select different dependency versions for the library in question. Since information propagates across crate boundaries, you cannot simply produce a &#8220;most general&#8221; instance of that library.&nbsp;<a href="#fnref4" rev="footnote">&#8617;</a>

</ol></div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Ivan Lozano, Android Team</span>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-uJBb_SOirIg/YJq9BWzQxOI/AAAAAAAADy8/QXv_oGYYR08oGIB-GAh95bWjg691PfimgCNcBGAsYHQ/s0/EC924D33-F820-433D-968E-C4234D0CE4AE_4_5005_c.jpeg" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="313" data-original-width="552" src="https://1.bp.blogspot.com/-uJBb_SOirIg/YJq9BWzQxOI/AAAAAAAADy8/QXv_oGYYR08oGIB-GAh95bWjg691PfimgCNcBGAsYHQ/s0/EC924D33-F820-433D-968E-C4234D0CE4AE_4_5005_c.jpeg"/></a></div>
<p>
The Android team has been working on introducing the Rust programming language into the Android Open Source Project (AOSP) since 2019 as a memory-safe alternative for platform native code development. As with any large project, introducing a new language requires careful consideration. For Android, one important area was assessing how to best fit Rust into Android&#8217;s build system. Currently this means the <a href="https://source.android.com/setup/build">Soong</a> build system (where the Rust support resides), but these design decisions and considerations are equally applicable for <a href="https://blog.bazel.build/2020/11/12/aosp_migrating_to_bazel.html">Bazel</a> when AOSP migrates to that build system. This post discusses some of the key design considerations and resulting decisions we made in integrating Rust support into Android&#8217;s build system.
</p>
<h2>Rust integration into large projects</h2>


<p>
A RustConf 2019 meeting on <a href="https://users.rust-lang.org/t/rust-in-large-organizations-meeting/32059">Rust usage within large organizations</a> highlighted several challenges, such as the risk that eschewing Cargo in favor of using the Rust Compiler, <code>rustc, </code> directly (see next section) may remove organizations from the wider Rust community. We share this same concern. When changes to imported third-party crates might be beneficial to the wider community, our goal is to upstream those changes. Likewise when crates developed for Android could benefit the wider Rust community, we hope to release them as independent crates. We believe that the success of Rust within Android is dependent on minimizing any divergence between Android and the Rust community at large, and hope that the Rust community will benefit from Android&#8217;s involvement.
</p>
<h2>No nested build systems</h2>


<p>
Rust provides Cargo as the default <a href="https://doc.rust-lang.org/book/ch01-03-hello-cargo.html">build system and package manager</a>, collecting dependencies and invoking <code>rustc</code> (the Rust compiler) to build the target crate (Rust package). <a href="https://android.googlesource.com/platform/build/soong/+/refs/heads/master/README.md">Soong</a> takes this role instead in Android and calls <code>rustc</code> directly for several reasons:
</p>
<ul>

<li>In Cargo, C dependencies are handled independently in an ad-hoc manner via build.rs scripts. Soong already provides a mechanism for building C libraries and defining them as dependencies, and Android carefully controls the compiler version and global compilation flags to ensure libraries are built a particular way. Relying on Cargo would introduce a second non-Soong mechanism for defining/building C libraries that would not be constrained by the carefully selected compilation controls implemented in Soong. This could also lead to multiple different versions of the same library, negatively impacting memory/disk usage. 

<li>Calling compilers directly through Soong provides the stability and control Android requires for the variety of build configurations it supports (for example, specifying where target-specific dependencies are and which compilation flags to use). While it would technically be possible to achieve the necessary level of control over <code>rustc</code> indirectly through Cargo, Soong would have no understanding of how the <code>Cargo.toml</code> (the Cargo build file) would influence the commands Cargo emits to <code>rustc</code>. Paired with the fact that Cargo evolves independently, this would severely restrict Soong&#8217;s ability to precisely control how build artifacts are created. 

<li>Builds which are self-contained and insensitive to the host configuration, known as <strong>hermetic builds</strong>, are necessary for Android to produce reproducible builds. Cargo, which relies on <strong><code>build.rs</code></strong> scripts, doesn&#8217;t yet provide hermeticity guarantees.

<li>Incremental builds are important to maintain engineering productivity; building Android takes a considerable amount of resources. Cargo was not designed for integration into existing build systems and does not expose its compilation units. Each Cargo invocation builds <a href="https://github.com/rust-lang/rust-roadmap-2017/issues/12#issuecomment-278118819">the entire crate dependency graph</a> for a given <code>Cargo.toml</code>, rebuilding crates multiple times across projects<sup id="fnref1"><a href="#fn1" rel="footnote">1</a></sup>. This is too coarse for integration into Soong&#8217;s incremental build support, which expects smaller compilation units. This support is necessary to scale up Rust usage within Android.
<p>
Using the Rust compiler directly allows us to avoid these issues and is consistent with how we compile all other code in AOSP. It provides the most control over the build process and eases integration into Android&#8217;s existing build system. Unfortunately, avoiding it introduces several challenges and influences many other build system decisions because Cargo usage is so deeply ingrained in the Rust crate ecosystem. 
</p>
<h2>No build.rs scripts</h2>


<p>
A<code> build.rs </code>script compiles to a Rust binary which Cargo builds and executes during a build to handle pre-build tasks, commonly setting up the build environment, or building libraries in other languages (for example C/C++). This is analogous to configure scripts used for other languages. 
</p>
<p>
Avoiding <code>build.rs</code> scripts somewhat flows naturally from not relying on Cargo since supporting these would require replicating Cargo behavior and assumptions. Beyond this however, there are good reasons for AOSP to avoid build scripts as well:
</p>
<ul>

<li><code>build.rs</code> scripts can execute arbitrary code on the build host. From a security perspective, this introduces an additional burden when adding or updating third-party code as the <code>build.rs</code> script needs careful scrutiny.

<li>Third-party <code>build.rs</code> scripts may not be hermetic or reproducible in <a href="https://github.com/rust-lang/cargo/issues/9273#issuecomment-800765010">potentially subtle ways</a>. It is also common for <code>build.rs</code> files to access files outside the build directory (such as <code>/usr/lib</code>). When they are not hermetic, we would need to either carry a local patch or work with upstream to resolve the issue.

<li>The most common task for <code>build.rs</code> is to build C libraries which Rust code depends on. We already support this through Soong.

<li>Android likewise avoids running build scripts while building for other languages, instead, simply using them to inform the structure of the <code>Android.bp</code> file.
</li>
</ul>
</li>
</ul>
<p>
For instances in third-party code where a build script is used only to compile C dependencies, we either use existing <code>cc_library</code> Soong definitions (such as <a href="https://cs.android.com/android/platform/superproject/+/master:external/boringssl/Android.bp;drc=859a48db620ed6a63b786182d1bb55f04d1f124c;l=312">boringssl</a> for <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/quiche/Android.bp;drc=1b19aa5ba6b71372df6ec176d15993631552c2eb;l=65">quiche</a>) or <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/grpcio-sys/Android.bp;drc=bb4f797895a614ac15d1ea90a62660900a6a6b30;l=68">create new definitions</a> for crate-specific code. 
</p>
<p>
When the <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/build.rs;l=379;drc=cc6e6357c57e09c4078b3c54cac455111dd3e221">build.rs is used to generate source</a>, we try to replicate <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/android/build.rs;drc=ae93c4c77b203617f6fdf5e5e6a0e1fee02caa91">the core functionality</a> in a Soong <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/android/Android.bp;drc=0f6dcf73b798c60a4ff204cc4b1a98572fec3393">rust_binary</a> module for use as a <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/libsqlite3-sys/Android.bp;drc=0f6dcf73b798c60a4ff204cc4b1a98572fec3393;l=132">custom source generator</a>. In other cases where Soong can provide the information without source generation, we may carry a <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/rustversion/patches/version.diff;drc=d550abe65fea6425374f69306f0a4e74585b238c">small patch</a> that leverages this information.
</p>
<h3>Why proc_macro but not build.rs?</h3>


<p>
Why do we support <code>proc_macros</code>, which are compiler plug-ins that execute code on the host within the compiler context, but not <code>build.rs</code> scripts?
</p>
<p>
While <code>build.rs</code> code is written as one-off code to handle building a single crate, <code>proc_macros </code>define reusable functionality within the compiler which can become widely relied upon across the Rust community. As a result popular <code>proc_macros</code> are generally better maintained and more scrutinized upstream, which makes the code review process more manageable. They are also more readily sandboxed as part of the build process since they are less likely to have dependencies external to the compiler.
</p>
<p>
<code>proc_macros</code> are also a language feature rather than a method for building code. These are relied upon by source code, are unavoidable for third-party dependencies, and are useful enough to define and use within our platform code. While we can avoid build.rs by leveraging our build system, the same can&#8217;t be said of proc_macros.
</p>
<p>
There is also precedence for compiler plugin support within the Android build system. For example see Soong&#8217;s <a href="https://ci.android.com/builds/submitted/7271141/linux/latest/raw/java.html#java_plugin">java_plugin</a> modules.
</p>
<h2>Generated source as crates</h2>


<p>
Unlike C/C++ compilers, <code>rustc</code> only accepts a single source file representing an entry point to a binary or library. It expects that the source tree is structured such that all required source files can be automatically discovered. This means that generated source either needs to be placed in the source tree or provided through an include directive in source:
</p>



<pre class="prettyprint">include!("/path/to/hello.rs");</pre>


<p>
The Rust community depends on <code>build.rs</code> scripts alongside assumptions about the Cargo build environment to <a href="https://doc.rust-lang.org/cargo/reference/build-script-examples.html#code-generation">get around this limitation</a>. When building, the <code>cargo</code> command sets an <a href="https://doc.rust-lang.org/cargo/reference/environment-variables.html#environment-variables-cargo-sets-for-crates">OUT_DIR environment variable</a> which build.rs scripts are expected to place generated source code in. This source can then be included via:
</p>



<pre class="prettyprint">include!(concat!(env!("OUT_DIR"), "/hello.rs"));</pre>


<p>
This presents a challenge for Soong as outputs for each module are placed in their own <code>out/</code> directory<sup id="fnref2"><a href="#fn2" rel="footnote">2</a></sup>; there is no single <code>OUT_DIR</code> where dependencies output their generated source.
</p>
<p>
For platform code, we prefer to package generated source into a crate that can be imported. There are a few reasons to favor this approach:
</p>
<ul>

<li>Prevent generated source file names from colliding.

<li>Reduce <a href="https://github.com/rust-lang/rust-bindgen/blob/master/book/src/tutorial-4.md">boilerplate code</a> checked-in throughout the tree and which needs to be maintained. Any boilerplate necessary to make the <a href="https://cs.android.com/android/platform/superproject/+/master:build/soong/rust/protobuf.go;drc=6eff900b67a0ed7e639ae304b1d453b620e9b79d;l=174">generated source compile</a> into a crate can be centrally maintained.

<li>Avoid implicit<sup id="fnref3"><a href="#fn3" rel="footnote">3</a></sup> interactions between generated code and the surrounding crate.  

<li>Reduce pressure on memory and disk by dynamically liking commonly used generated sources.
<p>
As a result, all of Android&#8217;s Rust source generation module types produce code that can be compiled and used <a href="https://cs.android.com/android/platform/superproject/+/master:system/bt/gd/rust/facade/Android.bp;drc=92fa0f9ac23d547cfa62ddbf9e92e7755e1b1df6;l=19">as a crate</a>.
</p>
<p>
We still support third-party crates without modification by copying all the generated source dependencies for a module into a single per-module directory similar to Cargo. Soong then sets the <code>OUT_DIR</code> environment variable to that directory when compiling the module so the generated source can be found. However we discourage use of this mechanism in platform code unless absolutely necessary for the reasons described above.
</p>
<h2>Dynamic linkage by default</h2>


<p>
By default, the Rust ecosystem assumes that crates will be <a href="https://github.com/rust-lang/rust/issues/10209">statically linked into binaries</a>. The usual benefits of dynamic libraries are upgrades (whether for security or functionality) and decreased memory usage. Rust&#8217;s lack of a stable binary interface and usage of cross-crate information flow prevents upgrading libraries without upgrading all dependent code. Even when the same crate is used by two different programs on the system, it is unlikely to be provided by the same shared object<sup id="fnref4"><a href="#fn4" rel="footnote">4</a></sup> due to the precision with which Rust identifies its crates. This makes Rust binaries more portable but also results in larger disk and memory footprints.
</p>
<p>
This is problematic for Android devices where resources like memory and disk usage must be carefully managed because statically linking all crates into Rust binaries would result in excessive code duplication (especially in the standard library). However, our situation is also different from the standard host environment: we build Android using global decisions about dependencies. This means that nearly every crate is shareable between all users of that crate. Thus, we opt to link crates dynamically by default for device targets. This reduces the overall memory footprint of Rust in Android by allowing crates to be reused across multiple binaries which depend on them.
</p>
<p>
Since this is unusual in the Rust community, not all third-party crates support dynamic compilation. Sometimes we must carry <a href="https://cs.android.com/android/platform/superproject/+/master:external/rust/crates/untrusted/patches/std.diff;drc=e595b63c7542df5941c7701feaf9b1e82919e80e">small patches</a> while we <a href="https://github.com/rust-lang/rust/pull/81469">work with</a> <a href="https://github.com/dtolnay/cxx/pulls?q=is%3Apr+author%3Ajgalenson">upstream maintainers</a> to add support.
</p>
<h2>Current Status of Build Support</h2>


<p>
We support building all output types supported by <code>rustc</code> (<code>rlib</code>s, <code>dylib</code>s, <code>proc_macro</code>s, <code>cdylib</code>s, <code>staticlib</code>s, and executables). Rust modules can automatically request the appropriate crate linkage for a given dependency (<code>rlib</code> vs <code>dylib</code>). C and C++ modules can depend on Rust <code>cdylib</code> or <code>staticlib</code> producing modules the same way as they would for a C or C++ library.
</p>
<p>
In addition to being able to build Rust code, Android&#8217;s build system also provides support for <a href="https://ci.android.com/builds/submitted/7279978/linux/latest/raw/rust.html#rust_protobuf">protobuf and gRPC</a> and <a href="https://ci.android.com/builds/submitted/7279978/linux/latest/raw/aidl.html#aidl_interface">AIDL</a> generated crates. First-class <a href="https://ci.android.com/builds/submitted/7279978/linux/latest/raw/rust.html#rust_bindgen">bindgen</a> support makes interfacing with existing C code simple and we have support <a href="https://cs.android.com/android/platform/superproject/+/master:system/bt/gd/rust/shim/Android.bp;l=120">modules</a> using <a href="https://github.com/dtolnay/cxx">cxx</a> for tighter integration with C++ code.
</p>
<p>
The Rust community produces great tooling for developers, such as the <a href="https://microsoft.github.io/language-server-protocol/">language server</a> <a href="https://rust-analyzer.github.io/">rust-analyzer</a>. We have <a href="https://cs.android.com/android/platform/superproject/+/master:build/soong/rust/project_json.go;drc=e8b0ee73f4c2545aa0597a270cf6c56fdb60b1ab">integrated support</a> for rust-analyzer into the build system so that any IDE which supports it can provide code completion and goto definitions for Android modules.
</p>
<p>
<a href="https://blog.rust-lang.org/inside-rust/2020/11/12/source-based-code-coverage.html">Source-based code coverage</a> builds are supported to provide platform developers high level signals on how well their code is covered by tests. Benchmarks are supported as their own module type, leveraging the <a href="https://docs.rs/criterion/0.3.4/criterion/">criterion crate</a> to provide performance metrics. In order to maintain a consistent style and level of code quality, a default set of <code>clippy</code> lints and <code>rustc</code> lints are <a href="https://cs.android.com/android/platform/superproject/+/master:build/soong/rust/config/lints.go;drc=b6d0d9cec4f477b3280378929a0e58bad97648c8">enabled by default</a>. Additionally, HWASAN/ASAN fuzzers are <a href="https://cs.android.com/android/platform/superproject/+/master:tools/security/fuzzing/example_rust_fuzzer/fuzzer.rs;drc=9ff8023a095897862c99496e9bb30c32f1a58b42;l=1">supported</a>, with the HWASAN <code>rustc</code> support <a href="https://android-review.googlesource.com/c/toolchain/android_rust/+/1403627">added to upstream</a>. 
</p>
<p>
In the near future, we plan to add documentation to <a href="https://source.android.com/">source.android.com</a> on how to define and use Rust modules in Soong. We expect Android&#8217;s support for Rust to continue evolving alongside the Rust ecosystem and hope to continue to participate in discussions around how Rust can be integrated into existing build systems.<br>
</p>
<p>
<em>Thank you to Matthew Maurer, Jeff Vander Stoep, Joel Galenson, Manish Goregaokar, and Tyler Mandry for their contributions to this post.</em>
</p>

<!-- Footnotes themselves at the bottom. -->

<h2>Notes</h2>
<div class="footnotes">
<hr>
<ol><li id="fn1">

<p>
    This can be mitigated to some extent with workspaces, but requires a very specific directory arrangement that AOSP does not conform to.&nbsp;<a href="#fnref1" rev="footnote">&#8617;</a><li id="fn2">
<p>
     This presents no problem for C/C++ and similar languages as the path to the generated source is provided directly to the compiler.&nbsp;<a href="#fnref2" rev="footnote">&#8617;</a><li id="fn3">

<p>
     Since include! works by textual inclusion, it may reference values from the enclosing namespace, modify the namespace, or use constructs like #![foo]. These implicit interactions can be difficult to maintain. Macros should be preferred if interaction with the rest of the crate is truly required. &nbsp;<a href="#fnref3" rev="footnote">&#8617;</a><li id="fn4">
<p>
     While libstd would usually be shareable for the same compiler revision, most other libraries would end up with several copies for Cargo-built Rust binaries, since each build would attempt to use a minimum feature set and may select different dependency versions for the library in question. Since information propagates across crate boundaries, you cannot simply produce a &#8220;most general&#8221; instance of that library.&nbsp;<a href="#fnref4" rev="footnote">&#8617;</a>

</ol></div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:Integrating Rust Into the Android Open Source Project&url=https://security.googleblog.com/2021/05/integrating-rust-into-android-open.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/05/integrating-rust-into-android-open.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/05/integrating-rust-into-android-open.html' data-url='https://security.googleblog.com/2021/05/integrating-rust-into-android-open.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/05/integrating-rust-into-android-open.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
<span class='labels-caption'>
Labels:
</span>
<span class='labels'>
<a class='label' href='https://security.googleblog.com/search/label/android' rel='tag'>
android
</a>

                                ,
                              
<a class='label' href='https://security.googleblog.com/search/label/android%20security' rel='tag'>
android security
</a>

                                ,
                              
<a class='label' href='https://security.googleblog.com/search/label/rust' rel='tag'>
rust
</a>
</span>
</div>
</div>
</div>
<div class='post' data-id='6616534866482045755' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/05/making-internet-more-secure-one-signed.html' itemprop='url' title='Making the Internet more secure one signed container at a time'>
Making the Internet more secure one signed container at a time
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
May 6, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Priya Wadhwa, Jake Sanders, Google Open Source Security Team</span><div><br /></div>With over 16 million pulls per month, Google&#8217;s <a href="https://github.com/GoogleContainerTools/distroless">`distroless` base images</a> are widely used and depended on by large projects like Kubernetes and Istio. These minimal images don&#8217;t include common tools like shells or package managers, making their attack surface (and download size!) smaller than traditional base images such as `ubuntu` or `alpine`. Even with this additional protection, users could still fall prey to typosquatting attacks, or receive a malicious image if the distroless build process was compromised &#8211; making users vulnerable to accidentally using a malicious image instead of the actual distroless image. This problem isn&#8217;t unique to distroless images &#8211; until now,  there just hasn&#8217;t been an easy way to verify that images are what they claim to be. <br /><br /><b>Introducing Cosign </b><br /><br /><a href="https://github.com/sigstore/cosign">Cosign</a> simplifies signing and verifying container images, aiming to make signatures invisible infrastructure &#8211; basically, it takes over the hard part of signing and verifying software for you.<br /><br />We developed cosign in collaboration with the <a href="http://sigstore.dev/">sigstore project</a>, a Linux Foundation project and a non-profit service that seeks to improve the open source software supply chain by easing the adoption of cryptographic software signing, backed by transparency log technologies.<br /><br />We&#8217;re excited to announce that all of our distroless images are now signed by cosign! This means that all users of distroless can verify that they are indeed using the base image they intended to before kicking off image builds, making distroless images even more trustworthy. In fact, Kubernetes has already begun <a href="https://github.com/kubernetes/release/pull/2016">performing this check</a> in their builds.<br /><br />As we look to the future, Kubernetes SIG Release's vision is to establish a consumable, introspectable, and secure supply chain for the project. By collaborating with the sigstore maintainers (who are fellow Kubernetes contributors) to integrate signing and transparency into our supply chain, we hope to be an exemplar for standards in the cloud native (and wider) tech industry, said Stephen Augustus, co-chair for Kubernetes SIG Release.<br /><br /><b>How it works</b><div><b><br /></b>To start signing distroless we integrated cosign into the distroless CI system, which builds and pushes images via Cloud Build. Signing every distroless image was as easy as adding an additional <a href="https://github.com/GoogleContainerTools/distroless/blob/master/cloudbuild.yaml#L37">Cloud Build step</a> to the Cloud Build job responsible for building and pushing the images. This additional step uses the cosign container image and a key pair stored in <a href="https://cloud.google.com/security-key-management">GCP KMS</a> to sign every distroless image. With this additional signing step, users can now verify that the distroless image they&#8217;re running was built in the correct CI environment.<br /><a href="https://lh3.googleusercontent.com/-9qsHRmCNRlE/YJMKfY1GYoI/AAAAAAAAAM0/eTd1NpkgRRsXFQJPBqey54rZ7ysZgb65ACNcBGAsYHQ/image.png"><img height="480" src="https://lh3.googleusercontent.com/-9qsHRmCNRlE/YJMKfY1GYoI/AAAAAAAAAM0/eTd1NpkgRRsXFQJPBqey54rZ7ysZgb65ACNcBGAsYHQ/w640-h480/image.png" width="640" /></a><br /><br />Right now, cosign can be run as an image or as a CLI tool. It supports:<br /><br /><ul style="text-align: left;"><li>Hardware and KMS signing</li><li>Bring-your-own PKI</li><li>Our free OIDC PKI (Fulcio)</li><li>Built-in binary transparency and timestamping service (Rekor)</li></ul><br />Signing distroless with cosign is just the beginning, and we plan to incorporate other sigstore technologies into distroless to continue to improve it over the next few months. We also can&#8217;t wait to integrate sigstore with other critical projects. Stay tuned here for updates! To get started verifying your own distrolesss images, check out the distroless <a href="https://github.com/GoogleContainerTools/distroless#how-do-i-verify-distroless-images">README</a> and to learn more about sigstore, check out <a href="https://sigstore.dev/">sigstore.dev</a>. <br /></div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Priya Wadhwa, Jake Sanders, Google Open Source Security Team</span><div><br /></div>With over 16 million pulls per month, Google&#8217;s <a href="https://github.com/GoogleContainerTools/distroless">`distroless` base images</a> are widely used and depended on by large projects like Kubernetes and Istio. These minimal images don&#8217;t include common tools like shells or package managers, making their attack surface (and download size!) smaller than traditional base images such as `ubuntu` or `alpine`. Even with this additional protection, users could still fall prey to typosquatting attacks, or receive a malicious image if the distroless build process was compromised &#8211; making users vulnerable to accidentally using a malicious image instead of the actual distroless image. This problem isn&#8217;t unique to distroless images &#8211; until now,  there just hasn&#8217;t been an easy way to verify that images are what they claim to be. <br /><br /><b>Introducing Cosign </b><br /><br /><a href="https://github.com/sigstore/cosign">Cosign</a> simplifies signing and verifying container images, aiming to make signatures invisible infrastructure &#8211; basically, it takes over the hard part of signing and verifying software for you.<br /><br />We developed cosign in collaboration with the <a href="http://sigstore.dev/">sigstore project</a>, a Linux Foundation project and a non-profit service that seeks to improve the open source software supply chain by easing the adoption of cryptographic software signing, backed by transparency log technologies.<br /><br />We&#8217;re excited to announce that all of our distroless images are now signed by cosign! This means that all users of distroless can verify that they are indeed using the base image they intended to before kicking off image builds, making distroless images even more trustworthy. In fact, Kubernetes has already begun <a href="https://github.com/kubernetes/release/pull/2016">performing this check</a> in their builds.<br /><br />As we look to the future, Kubernetes SIG Release's vision is to establish a consumable, introspectable, and secure supply chain for the project. By collaborating with the sigstore maintainers (who are fellow Kubernetes contributors) to integrate signing and transparency into our supply chain, we hope to be an exemplar for standards in the cloud native (and wider) tech industry, said Stephen Augustus, co-chair for Kubernetes SIG Release.<br /><br /><b>How it works</b><div><b><br /></b>To start signing distroless we integrated cosign into the distroless CI system, which builds and pushes images via Cloud Build. Signing every distroless image was as easy as adding an additional <a href="https://github.com/GoogleContainerTools/distroless/blob/master/cloudbuild.yaml#L37">Cloud Build step</a> to the Cloud Build job responsible for building and pushing the images. This additional step uses the cosign container image and a key pair stored in <a href="https://cloud.google.com/security-key-management">GCP KMS</a> to sign every distroless image. With this additional signing step, users can now verify that the distroless image they&#8217;re running was built in the correct CI environment.<br /><a href="https://lh3.googleusercontent.com/-9qsHRmCNRlE/YJMKfY1GYoI/AAAAAAAAAM0/eTd1NpkgRRsXFQJPBqey54rZ7ysZgb65ACNcBGAsYHQ/image.png"><img height="480" src="https://lh3.googleusercontent.com/-9qsHRmCNRlE/YJMKfY1GYoI/AAAAAAAAAM0/eTd1NpkgRRsXFQJPBqey54rZ7ysZgb65ACNcBGAsYHQ/w640-h480/image.png" width="640" /></a><br /><br />Right now, cosign can be run as an image or as a CLI tool. It supports:<br /><br /><ul style="text-align: left;"><li>Hardware and KMS signing</li><li>Bring-your-own PKI</li><li>Our free OIDC PKI (Fulcio)</li><li>Built-in binary transparency and timestamping service (Rekor)</li></ul><br />Signing distroless with cosign is just the beginning, and we plan to incorporate other sigstore technologies into distroless to continue to improve it over the next few months. We also can&#8217;t wait to integrate sigstore with other critical projects. Stay tuned here for updates! To get started verifying your own distrolesss images, check out the distroless <a href="https://github.com/GoogleContainerTools/distroless#how-do-i-verify-distroless-images">README</a> and to learn more about sigstore, check out <a href="https://sigstore.dev/">sigstore.dev</a>. <br /></div>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:Making the Internet more secure one signed container at a time&url=https://security.googleblog.com/2021/05/making-internet-more-secure-one-signed.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/05/making-internet-more-secure-one-signed.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/05/making-internet-more-secure-one-signed.html' data-url='https://security.googleblog.com/2021/05/making-internet-more-secure-one-signed.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/05/making-internet-more-secure-one-signed.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
</div>
</div>
</div>
<div class='post' data-id='5557552525132230519' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/05/enabling-hardware-enforced-stack.html' itemprop='url' title='Enabling Hardware-enforced Stack Protection (cetcompat) in Chrome'>
Enabling Hardware-enforced Stack Protection (cetcompat) in Chrome
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
May 4, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Alex Gough, Engineer, Chrome Platform Security Team</span>
<p>
Chrome 90 for Windows adopts Hardware-enforced Stack Protection, a mitigation technology to make the exploitation of security bugs more difficult for attackers. This is supported by Windows 20H1 (December Update) or later, running on processors with Control-flow Enforcement Technology (CET) such as Intel 11th Gen or AMD Zen 3 CPUs. With this mitigation the processor maintains a new, protected, stack of valid return addresses (a shadow stack). This improves security by making exploits more difficult to write. However, it may affect stability if software that loads itself into Chrome is not compatible with the mitigation. Below we describe some exploitation techniques that are mitigated by stack protection, discuss its limitations and what we will do next to approach them. Finally, we provide some quick tips for other software authors as they enable /cetcompat for their Windows applications.
</p>
<div style="text-align: left;"><b>Stack Protection</b></div>


<p>
Imagine a simple use-after-free (UAF) bug where an attacker can induce a program to call a pointer of their choosing. Here the attacker controls an object which occupies space formerly used by another object, which the program erroneously continues to use. The attacker sets a field in this region that is used as a function call to the address of code the attacker would like to execute. Years ago an attacker could simply write their shellcode to a known location, then, in their overwrite, set the instruction pointer to this shellcode. In time, Data Execution Prevention was added to prevent stacks or heaps from being executable.
</p>
<p>
In response, attackers invented Return Oriented Programming (ROP). Here, attackers take advantage of the process&#8217;s own code, as that must be executable. With control of the stack (either to write values there, or by changing the stack pointer) and control of the instruction pointer, an attacker can use the `ret` instruction to jump to a different, useful, piece of code.
</p><div class="separator" style="clear: both; text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-e5wJwrbaRxA/YJB5OPO8DZI/AAAAAAAADv8/1dn4WDMchucpjdXmzYOK8t5zT_AVOIrfwCNcBGAsYHQ/s1010/rop.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="464" data-original-width="1010" src="https://1.bp.blogspot.com/-e5wJwrbaRxA/YJB5OPO8DZI/AAAAAAAADv8/1dn4WDMchucpjdXmzYOK8t5zT_AVOIrfwCNcBGAsYHQ/s16000/rop.gif" /></a></div></div><p><span id="docs-internal-guid-305e2786-7fff-3ca1-89b3-6685107e2bd1"><span style="font-family: Arial; font-size: 11pt; font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;"></span></span></p><p>During an exploit attempt, the instruction pointer is changed so that instead of its normal destination, a small fragment of code, called an ROP gadget, is invoked instead. These gadgets are selected so that they do something useful (such as prepare a register for a function call) then call return.
</p>
<p>
These tiny fragments need not be a complete function in the normal program, and could even be found part-way through a legitimate instruction. By lining up the right set of &#8220;return&#8221; addresses, a chain of these gadgets can be called, with each gadget&#8217;s `ret` switching to the next gadget. With some patience, or the right tooling, an attacker can piece together the arguments to a function call, then really call the function.
</p>
<p>
Chrome has a <a href="https://www.google.com/googlebooks/chrome/small_04.html">multi-process architecture</a> -- a main browser process acts as the logged-in user, and spawns restricted renderer and utility processes to host website code. This isolation reduces the severity of a bug in a renderer as its process cannot do much by itself. Attackers will then attempt to use another sandbox escape bug to run code in the browser, which lets them act as the logged-in user. As libraries are mapped at the same address in different processes by Windows, any bug that allows an attacker to read memory is enough for them to examine Chrome&#8217;s binary and any loaded libraries for ROP gadgets. This makes preventing ROP chains in the browser process especially useful as a mitigation.
</p>
<p>
Enter stack-protection. Along with the existing stack, the cpu maintains a shadow stack. This stack cannot be directly manipulated by normal program code and only stores return addresses. The CALL instruction is modified to push a return address (the instruction after the CALL) to both the normal stack, and the shadow stack. The RET (return) instruction still takes its return address from the normal stack, but now verifies that it is the same as the one stored in the shadow stack region. If it is, then the program is left alone and it continues to work as it always did. If the addresses do not match then an exception is raised which is intercepted by the operating system (not by Chrome). The operating system has an opportunity to modify  the shadow region and allow the program to continue, but in most cases an address mismatch is the result of a program error so the program is immediately terminated.</p><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-7l5W81xp6OE/YJB5ZrmIdxI/AAAAAAAADwA/L8U5ED5VwBQT10p0ipxJhZ7IQx_h9ptyACNcBGAsYHQ/s1010/cet.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="594" data-original-width="1010" src="https://1.bp.blogspot.com/-7l5W81xp6OE/YJB5ZrmIdxI/AAAAAAAADwA/L8U5ED5VwBQT10p0ipxJhZ7IQx_h9ptyACNcBGAsYHQ/s16000/cet.gif" /></a></div><p></p><p><span id="docs-internal-guid-3e3d108d-7fff-216f-b344-d24f6b3f395d"><span style="font-family: Arial; font-size: 11pt; font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;"></span></span></p><p>In our example above, the attacker will be able to make their initial jump into a ROP gadget, but on trying to return to their next gadget they will be stopped.
</p>
<p>
Some software may be incompatible with this mechanism, especially some older security software that injects into a process and hooks operating system functions by overwriting the prelude with `rax = &amp;hook; push rax; ret`.
</p>
<div style="text-align: left;"><b>Limitations</b></div>


<p>
Chrome does not yet support every direction of control flow enforcement. Stack protection enforces the reverse-edge of the call graph but does not constrain the forward-edge. It will still be possible to make indirect jumps around existing code as stack protection is only validated when a return instruction is encountered, and call targets are not validated. On Windows a technology called Control Flow Guard (CFG) can be used to verify the target of an indirect function call before it is attempted. This prevents calling into the middle of a function, significantly reducing the scope of useful instructions for attackers to use. Another approach is provided by Intel&#8217;s CET which includes an ENDBRANCH instruction to prevent jumps into arbitrary code locations. Memory tagging tools such as MTE can be used to make it more difficult to modify pointers to valid code sequences (and makes UAFs more difficult in general). We are <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=584575">working to introduce CFG</a> to Chrome for Windows, and will add other techniques over time.
</p>
<p>
By itself, stack protection can be bypassed in some contexts. For instance, stack protection does not prevent an attacker tricking a program into calling an existing function by entirely replacing an object containing a function pointer. This approach does not involve ROP as the function call happens instead of the expected call, and returns to the address it was originally called from, so must be allowed. However, the called function must be useful to an attacker, and most functions will not be. An example of an attack using this method is to craft a call to add the `--no-sandbox` argument to Chrome&#8217;s command line. This results in future renderers being launched without normal protections. Over time we will identify and <a href="https://crbug.com/1195976">remove</a> such useful tools.
</p>
<p>
In the renderer, for performance reasons, our javascript and wasm engines may use memory that is both writable and executable at the same time. This allows an attacker to modify code that v8 is already going to execute, saving them the trouble of constructing a ROP chain. This explains why it was not our first priority to make v8 CET compatible, and why stack-protection is not yet enabled in the renderer.
</p>
<p>
Finally, stack protection doesn&#8217;t stop the bugs in the first place. Everything we have discussed above is a mitigation that makes it more difficult to execute arbitrary code. If a programming error allows arbitrary writes then it is very unlikely that we can prevent this being used to run arbitrary code. Attackers will adapt and find new ways to turn memory safety errors into code execution.
</p>
<div style="text-align: left;"><b>Debugging Tips</b></div>


<p>
You can see if Hardware-enforced Stack Protection is enabled for a process using the Windows Task Manager. Open task manager, open the Details Tab, Right Click on a heading, Select Columns &amp; Check the Hardware-enforced Stack Protection box. The process display will then indicate if a process is opted-in to this mitigation. &#8216;Compatible Modules Only&#8217; indicates that any dll marked as /cetcompat at build time will raise an exception if a return address is invalid.
</p>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-kPmdB5C0LIQ/YJGBezJVzyI/AAAAAAAADyI/S1HwPdpFDks3WnC5YtSQq3FuI-M6ybk2wCNcBGAsYHQ/s0/download.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="900" data-original-width="1600" src="https://1.bp.blogspot.com/-kPmdB5C0LIQ/YJGBezJVzyI/AAAAAAAADyI/S1HwPdpFDks3WnC5YtSQq3FuI-M6ybk2wCNcBGAsYHQ/s0/download.png"/></a></div>
<p>
You can see which Chrome processes are opted-out of CET by consulting the Mitigations field of chrome://sandbox and clicking &#8216;+&#8217;. All processes are included unless the mitigation CET_USER_SHADOW_STACKS_ALWAYS_OFF is present in the expanded details view.
</p>
<p>
If you are developing software, or debugging a problem in Chrome the shadow stack can be helpful as it includes only return addresses, and these cannot be corrupted by rogue writes elsewhere in the process. To see these registers use the `r` command in windbg with the mask option:
</p>
<p>
0:159> rM 8002
</p>
<p>
rax=00000000c000060a rbx=000000fa5bbfeff0 rcx=0000000000000030
</p>
<p>
rdx=0000000000000000 rsi=00007ffba4118924 rdi=000000fa5bbff1a0
</p>
<p>
rip=00007ffc1847b4a1 rsp=000000fa5bbfc0a0 rbp=000000fa5bbfc0a0
</p>
<p>
 r8=000000fa5bbfc098  r9=0000000000000000 r10=0000000000000000
</p>
<p>
r11=0000000000000246 r12=000000fa5bbfe230 r13=000002c3450b5830
</p>
<p>
r14=000002c3450b7850 r15=000000fa5bbfc260
</p>
<p>
iopl=0         nv up ei pl zr na po nc
</p>
<p>
ssp=000000fa5c3fef10 cetumsr=0000000000000001
</p>
<p>
`ssp` points to the shadow stack region, `cetumsr` indicates if cet is enabled for the process.
</p>
<p>
You can then see the call stack within the shadow region using `dps @ssp`. Values are not overwritten so you can also see where you came from by looking a bit deeper: `dps @ssp-20`.
</p>
<p>
If a process is not compatible with Hardware-enforced Stack Protection, the system event log (Application Log) will include brief error reports (Id:1001). You can filter those related to cetcompat using the following powershell snippet:-
</p>
<p>
Get-WinEvent -MaxEvents 128 -FilterHashtable @{ LogName='Application'; Id='1001' } `
</p>
<p>
  | Where-Object {$_.Message -match 'chrome.exe'} `
</p>
<p>
  | Select-Object -First 8 `
</p>
<p>
  | fl
</p>
<p>
These will include the following parameters:-
</p>
<p>
P1: application.exe
</p>
<p>
P2: application version
</p>
<p>
P3: application build ts
</p>
<p>
P4: faulting module .dll
</p>
<p>
P5: faulting module version
</p>
<p>
P6: faulting module build ts
</p>
<p>
P7: faulting offset in P4 from base_address
</p>
<p>
P8: exception code (c0000409)
</p>
<p>
P9: subcode (00...000030)
</p>
<p>
If Chrome is misbehaving and you think it might be because of cetcompat, it is possible to disable it using Image File Execution Options - we do not recommend this except for a limited period of testing. If you find you have to do this, please raise an issue on https://crbug.com so that we can investigate the failure.
</p>
<h4>Further Reading</h4>


<ul>

<li>Intel <a href="https://software.intel.com/content/www/us/en/develop/download/intel-64-and-ia-32-architectures-sdm-combined-volumes-1-2a-2b-2c-2d-3a-3b-3c-3d-and-4.html">ISA</a> (Chapter 18)

<li><a href="https://techcommunity.microsoft.com/t5/windows-kernel-internals/developer-guidance-for-hardware-enforced-stack-protection/ba-p/2163340">Microsoft&#8217;s Developer Guidance</a>

<li>Excellent posts by Shamir & Ionescu: <a href="https://windows-internals.com/cet-on-windows/">RIP ROP</a>, <a href="https://windows-internals.com/cet-updates-cet-on-xanax/">CET On Xanax</a>, & <a href="https://windows-internals.com/cet-updates-dynamic-address-ranges/">Dynamic CET</a>
</li>
</ul>
<h4>Summary</h4>


<p>
/cetcompat is enabled for most processes for Chrome M90 on Windows. Enabling Hardware-enforced Stack Protection will layer with existing and future measures to make exploitation more difficult and so more expensive for an attacker, ultimately protecting the people who use Chrome every day.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Alex Gough, Engineer, Chrome Platform Security Team</span>
<p>
Chrome 90 for Windows adopts Hardware-enforced Stack Protection, a mitigation technology to make the exploitation of security bugs more difficult for attackers. This is supported by Windows 20H1 (December Update) or later, running on processors with Control-flow Enforcement Technology (CET) such as Intel 11th Gen or AMD Zen 3 CPUs. With this mitigation the processor maintains a new, protected, stack of valid return addresses (a shadow stack). This improves security by making exploits more difficult to write. However, it may affect stability if software that loads itself into Chrome is not compatible with the mitigation. Below we describe some exploitation techniques that are mitigated by stack protection, discuss its limitations and what we will do next to approach them. Finally, we provide some quick tips for other software authors as they enable /cetcompat for their Windows applications.
</p>
<div style="text-align: left;"><b>Stack Protection</b></div>


<p>
Imagine a simple use-after-free (UAF) bug where an attacker can induce a program to call a pointer of their choosing. Here the attacker controls an object which occupies space formerly used by another object, which the program erroneously continues to use. The attacker sets a field in this region that is used as a function call to the address of code the attacker would like to execute. Years ago an attacker could simply write their shellcode to a known location, then, in their overwrite, set the instruction pointer to this shellcode. In time, Data Execution Prevention was added to prevent stacks or heaps from being executable.
</p>
<p>
In response, attackers invented Return Oriented Programming (ROP). Here, attackers take advantage of the process&#8217;s own code, as that must be executable. With control of the stack (either to write values there, or by changing the stack pointer) and control of the instruction pointer, an attacker can use the `ret` instruction to jump to a different, useful, piece of code.
</p><div class="separator" style="clear: both; text-align: left;"><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-e5wJwrbaRxA/YJB5OPO8DZI/AAAAAAAADv8/1dn4WDMchucpjdXmzYOK8t5zT_AVOIrfwCNcBGAsYHQ/s1010/rop.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="464" data-original-width="1010" src="https://1.bp.blogspot.com/-e5wJwrbaRxA/YJB5OPO8DZI/AAAAAAAADv8/1dn4WDMchucpjdXmzYOK8t5zT_AVOIrfwCNcBGAsYHQ/s16000/rop.gif" /></a></div></div><p><span id="docs-internal-guid-305e2786-7fff-3ca1-89b3-6685107e2bd1"><span style="font-family: Arial; font-size: 11pt; font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;"></span></span></p><p>During an exploit attempt, the instruction pointer is changed so that instead of its normal destination, a small fragment of code, called an ROP gadget, is invoked instead. These gadgets are selected so that they do something useful (such as prepare a register for a function call) then call return.
</p>
<p>
These tiny fragments need not be a complete function in the normal program, and could even be found part-way through a legitimate instruction. By lining up the right set of &#8220;return&#8221; addresses, a chain of these gadgets can be called, with each gadget&#8217;s `ret` switching to the next gadget. With some patience, or the right tooling, an attacker can piece together the arguments to a function call, then really call the function.
</p>
<p>
Chrome has a <a href="https://www.google.com/googlebooks/chrome/small_04.html">multi-process architecture</a> -- a main browser process acts as the logged-in user, and spawns restricted renderer and utility processes to host website code. This isolation reduces the severity of a bug in a renderer as its process cannot do much by itself. Attackers will then attempt to use another sandbox escape bug to run code in the browser, which lets them act as the logged-in user. As libraries are mapped at the same address in different processes by Windows, any bug that allows an attacker to read memory is enough for them to examine Chrome&#8217;s binary and any loaded libraries for ROP gadgets. This makes preventing ROP chains in the browser process especially useful as a mitigation.
</p>
<p>
Enter stack-protection. Along with the existing stack, the cpu maintains a shadow stack. This stack cannot be directly manipulated by normal program code and only stores return addresses. The CALL instruction is modified to push a return address (the instruction after the CALL) to both the normal stack, and the shadow stack. The RET (return) instruction still takes its return address from the normal stack, but now verifies that it is the same as the one stored in the shadow stack region. If it is, then the program is left alone and it continues to work as it always did. If the addresses do not match then an exception is raised which is intercepted by the operating system (not by Chrome). The operating system has an opportunity to modify  the shadow region and allow the program to continue, but in most cases an address mismatch is the result of a program error so the program is immediately terminated.</p><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/-7l5W81xp6OE/YJB5ZrmIdxI/AAAAAAAADwA/L8U5ED5VwBQT10p0ipxJhZ7IQx_h9ptyACNcBGAsYHQ/s1010/cet.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="594" data-original-width="1010" src="https://1.bp.blogspot.com/-7l5W81xp6OE/YJB5ZrmIdxI/AAAAAAAADwA/L8U5ED5VwBQT10p0ipxJhZ7IQx_h9ptyACNcBGAsYHQ/s16000/cet.gif" /></a></div><p></p><p><span id="docs-internal-guid-3e3d108d-7fff-216f-b344-d24f6b3f395d"><span style="font-family: Arial; font-size: 11pt; font-variant-east-asian: normal; font-variant-numeric: normal; vertical-align: baseline; white-space: pre-wrap;"></span></span></p><p>In our example above, the attacker will be able to make their initial jump into a ROP gadget, but on trying to return to their next gadget they will be stopped.
</p>
<p>
Some software may be incompatible with this mechanism, especially some older security software that injects into a process and hooks operating system functions by overwriting the prelude with `rax = &amp;hook; push rax; ret`.
</p>
<div style="text-align: left;"><b>Limitations</b></div>


<p>
Chrome does not yet support every direction of control flow enforcement. Stack protection enforces the reverse-edge of the call graph but does not constrain the forward-edge. It will still be possible to make indirect jumps around existing code as stack protection is only validated when a return instruction is encountered, and call targets are not validated. On Windows a technology called Control Flow Guard (CFG) can be used to verify the target of an indirect function call before it is attempted. This prevents calling into the middle of a function, significantly reducing the scope of useful instructions for attackers to use. Another approach is provided by Intel&#8217;s CET which includes an ENDBRANCH instruction to prevent jumps into arbitrary code locations. Memory tagging tools such as MTE can be used to make it more difficult to modify pointers to valid code sequences (and makes UAFs more difficult in general). We are <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=584575">working to introduce CFG</a> to Chrome for Windows, and will add other techniques over time.
</p>
<p>
By itself, stack protection can be bypassed in some contexts. For instance, stack protection does not prevent an attacker tricking a program into calling an existing function by entirely replacing an object containing a function pointer. This approach does not involve ROP as the function call happens instead of the expected call, and returns to the address it was originally called from, so must be allowed. However, the called function must be useful to an attacker, and most functions will not be. An example of an attack using this method is to craft a call to add the `--no-sandbox` argument to Chrome&#8217;s command line. This results in future renderers being launched without normal protections. Over time we will identify and <a href="https://crbug.com/1195976">remove</a> such useful tools.
</p>
<p>
In the renderer, for performance reasons, our javascript and wasm engines may use memory that is both writable and executable at the same time. This allows an attacker to modify code that v8 is already going to execute, saving them the trouble of constructing a ROP chain. This explains why it was not our first priority to make v8 CET compatible, and why stack-protection is not yet enabled in the renderer.
</p>
<p>
Finally, stack protection doesn&#8217;t stop the bugs in the first place. Everything we have discussed above is a mitigation that makes it more difficult to execute arbitrary code. If a programming error allows arbitrary writes then it is very unlikely that we can prevent this being used to run arbitrary code. Attackers will adapt and find new ways to turn memory safety errors into code execution.
</p>
<div style="text-align: left;"><b>Debugging Tips</b></div>


<p>
You can see if Hardware-enforced Stack Protection is enabled for a process using the Windows Task Manager. Open task manager, open the Details Tab, Right Click on a heading, Select Columns &amp; Check the Hardware-enforced Stack Protection box. The process display will then indicate if a process is opted-in to this mitigation. &#8216;Compatible Modules Only&#8217; indicates that any dll marked as /cetcompat at build time will raise an exception if a return address is invalid.
</p>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-kPmdB5C0LIQ/YJGBezJVzyI/AAAAAAAADyI/S1HwPdpFDks3WnC5YtSQq3FuI-M6ybk2wCNcBGAsYHQ/s0/download.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="900" data-original-width="1600" src="https://1.bp.blogspot.com/-kPmdB5C0LIQ/YJGBezJVzyI/AAAAAAAADyI/S1HwPdpFDks3WnC5YtSQq3FuI-M6ybk2wCNcBGAsYHQ/s0/download.png"/></a></div>
<p>
You can see which Chrome processes are opted-out of CET by consulting the Mitigations field of chrome://sandbox and clicking &#8216;+&#8217;. All processes are included unless the mitigation CET_USER_SHADOW_STACKS_ALWAYS_OFF is present in the expanded details view.
</p>
<p>
If you are developing software, or debugging a problem in Chrome the shadow stack can be helpful as it includes only return addresses, and these cannot be corrupted by rogue writes elsewhere in the process. To see these registers use the `r` command in windbg with the mask option:
</p>
<p>
0:159> rM 8002
</p>
<p>
rax=00000000c000060a rbx=000000fa5bbfeff0 rcx=0000000000000030
</p>
<p>
rdx=0000000000000000 rsi=00007ffba4118924 rdi=000000fa5bbff1a0
</p>
<p>
rip=00007ffc1847b4a1 rsp=000000fa5bbfc0a0 rbp=000000fa5bbfc0a0
</p>
<p>
 r8=000000fa5bbfc098  r9=0000000000000000 r10=0000000000000000
</p>
<p>
r11=0000000000000246 r12=000000fa5bbfe230 r13=000002c3450b5830
</p>
<p>
r14=000002c3450b7850 r15=000000fa5bbfc260
</p>
<p>
iopl=0         nv up ei pl zr na po nc
</p>
<p>
ssp=000000fa5c3fef10 cetumsr=0000000000000001
</p>
<p>
`ssp` points to the shadow stack region, `cetumsr` indicates if cet is enabled for the process.
</p>
<p>
You can then see the call stack within the shadow region using `dps @ssp`. Values are not overwritten so you can also see where you came from by looking a bit deeper: `dps @ssp-20`.
</p>
<p>
If a process is not compatible with Hardware-enforced Stack Protection, the system event log (Application Log) will include brief error reports (Id:1001). You can filter those related to cetcompat using the following powershell snippet:-
</p>
<p>
Get-WinEvent -MaxEvents 128 -FilterHashtable @{ LogName='Application'; Id='1001' } `
</p>
<p>
  | Where-Object {$_.Message -match 'chrome.exe'} `
</p>
<p>
  | Select-Object -First 8 `
</p>
<p>
  | fl
</p>
<p>
These will include the following parameters:-
</p>
<p>
P1: application.exe
</p>
<p>
P2: application version
</p>
<p>
P3: application build ts
</p>
<p>
P4: faulting module .dll
</p>
<p>
P5: faulting module version
</p>
<p>
P6: faulting module build ts
</p>
<p>
P7: faulting offset in P4 from base_address
</p>
<p>
P8: exception code (c0000409)
</p>
<p>
P9: subcode (00...000030)
</p>
<p>
If Chrome is misbehaving and you think it might be because of cetcompat, it is possible to disable it using Image File Execution Options - we do not recommend this except for a limited period of testing. If you find you have to do this, please raise an issue on https://crbug.com so that we can investigate the failure.
</p>
<h4>Further Reading</h4>


<ul>

<li>Intel <a href="https://software.intel.com/content/www/us/en/develop/download/intel-64-and-ia-32-architectures-sdm-combined-volumes-1-2a-2b-2c-2d-3a-3b-3c-3d-and-4.html">ISA</a> (Chapter 18)

<li><a href="https://techcommunity.microsoft.com/t5/windows-kernel-internals/developer-guidance-for-hardware-enforced-stack-protection/ba-p/2163340">Microsoft&#8217;s Developer Guidance</a>

<li>Excellent posts by Shamir & Ionescu: <a href="https://windows-internals.com/cet-on-windows/">RIP ROP</a>, <a href="https://windows-internals.com/cet-updates-cet-on-xanax/">CET On Xanax</a>, & <a href="https://windows-internals.com/cet-updates-dynamic-address-ranges/">Dynamic CET</a>
</li>
</ul>
<h4>Summary</h4>


<p>
/cetcompat is enabled for most processes for Chrome M90 on Windows. Enabling Hardware-enforced Stack Protection will layer with existing and future measures to make exploitation more difficult and so more expensive for an attacker, ultimately protecting the people who use Chrome every day.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:Enabling Hardware-enforced Stack Protection (cetcompat) in Chrome&url=https://security.googleblog.com/2021/05/enabling-hardware-enforced-stack.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/05/enabling-hardware-enforced-stack.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/05/enabling-hardware-enforced-stack.html' data-url='https://security.googleblog.com/2021/05/enabling-hardware-enforced-stack.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/05/enabling-hardware-enforced-stack.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
</div>
</div>
</div>
<div class='post' data-id='4039589283642070152' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/04/how-we-fought-bad-apps-and-developers.html' itemprop='url' title='How we fought bad apps and developers in 2020'>
How we fought bad apps and developers in 2020
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
April 21, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Krish Vitaldevara, Director of Product Management Trust & Safety, Google Play</span>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-sjGz7H-EDgk/YH9xMFdlYyI/AAAAAAAADtg/pllzmApV9rA4lfCJwxz5_NaK7KBesvhDgCNcBGAsYHQ/s0/fightingBadAppsHero.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="768" data-original-width="1365" src="https://1.bp.blogspot.com/-sjGz7H-EDgk/YH9xMFdlYyI/AAAAAAAADtg/pllzmApV9rA4lfCJwxz5_NaK7KBesvhDgCNcBGAsYHQ/s0/fightingBadAppsHero.png"/></a></div>
<p>
Providing safe experiences to billions of users and millions of Android developers has been one of the highest priorities for Google Play for many years. Last year we introduced new policies, improved our systems, and further optimized our processes to better protect our users, assist good developers and strengthen our guard against bad apps and developers. Additionally, in 2020, Google Play Protect scanned over 100B installed apps each day for malware across billions of devices.
</p>
<p>
Users come to Google Play to find helpful, reliable apps on everything from COVID-19 vaccine information to new forms of entertainment, grocery delivery, communication and more.
</p>
<p>
As such, we introduced a series of policies and new developer support to continue to elevate  information quality on the platform and reduce the risk of user harm from misinformation.
</p>
<ul>

<li><strong>COVID-19 apps requirements: </strong>To ensure public safety, information integrity and privacy, we introduced <a href="https://support.google.com/googleplay/android-developer/answer/9889712?hl=en#zippy=%2Cofficial-governmental-apps-eligible-for-covid--resource-portions-of-the-google-play-store">specific requirements</a> for COVID-19 apps. Under these requirements, apps related to sensitive use cases, such as those providing testing information, must be endorsed by either official governmental entities or healthcare organizations and must meet a high standard for user data privacy. 

<li><strong>News policy:</strong> To promote transparency in news publishing, we <a href="https://blog.google/outreach-initiatives/civics/google-play-helping-safeguard-elections/">introduced</a> minimum requirements that apps must meet in order for developers to declare their app as a &#8220;News&#8221; app  on Google Play. These <a href="https://support.google.com/googleplay/android-developer/answer/9935326">guidelines</a> help promote user transparency and developer accountability by providing users with relevant information about the app. 

<li><strong>Election support: </strong>We created <a href="https://blog.google/outreach-initiatives/civics/google-play-helping-safeguard-elections/">teams</a> and processes across Google Play focused on elections to provide additional support and adapt to the changing landscape. This includes support for government agencies, specially trained app reviewers, and a safety team to address election threats and abuse. 
</li>
</ul>
<p>
Our core efforts around identifying and mitigating bad apps and developers continued to evolve to address new adversarial behaviors and forms of abuse. Our machine-learning detection capabilities and enhanced app review processes prevented over 962k policy-violating app submissions from getting published to Google Play. We also banned 119k malicious and spammy developer accounts. Additionally, we significantly increased our focus on SDK enforcement, as we've found these violations have an outsized impact on security and user data privacy.
</p>
<p>
Last year, we continued to reduce developer access to sensitive permissions. In February, we <a href="https://android-developers.googleblog.com/2020/02/safer-location-access.html">announced</a> a new background location policy to ensure that apps requesting this permission need the data in order to provide clear user benefit. As a result of the new policy, developers now have to demonstrate that benefit and prominently tell users about it or face possible removal from Google Play. We've begun enforcement on apps not meeting new policy guidelines and will provide an update on the usage of this permission in a future blog post. 
</p>
<p>
We've also continued to invest in protecting kids and helping parents find great content. In 2020 we <a href="https://blog.google/products/google-play/teacher-approved-apps/">launched</a> a new kids tab filled with &#8220;Teacher approved&#8221; apps. To evaluate apps, we teamed with academic experts and teachers across the country, including our lead advisors, Joe Blatt (Harvard Graduate School of Education) and Dr. Sandra Calvert (Georgetown University).
</p>
<p>
As we continue to invest in protecting people from apps with harmful content, malicious behaviors, or threats to user privacy, we are also equally motivated to <a href="https://playacademy.exceedlms.com/student/activity/39632-what-s-new-in-google-play-policy-july-2020">provide trusted experiences to Play developers</a>. For example, we&#8217;ve improved our process for providing relevant information about enforcement actions we&#8217;ve taken, resulting in significant reduction in appeals and increased developer satisfaction. We will continue to enhance the speed and quality of our communications to developers, and continue listening to feedback about how we can further engage and elevate trusted developers. Android developers can expect to see more on this front in the coming year. 
</p>
<p>
Our global teams of product managers, engineers, policy experts, and operations leaders are more excited than ever to advance the safety of the platform and forge a sustaining trust with our users. We look forward to building an even better Google Play experience.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Krish Vitaldevara, Director of Product Management Trust & Safety, Google Play</span>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-sjGz7H-EDgk/YH9xMFdlYyI/AAAAAAAADtg/pllzmApV9rA4lfCJwxz5_NaK7KBesvhDgCNcBGAsYHQ/s0/fightingBadAppsHero.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="768" data-original-width="1365" src="https://1.bp.blogspot.com/-sjGz7H-EDgk/YH9xMFdlYyI/AAAAAAAADtg/pllzmApV9rA4lfCJwxz5_NaK7KBesvhDgCNcBGAsYHQ/s0/fightingBadAppsHero.png"/></a></div>
<p>
Providing safe experiences to billions of users and millions of Android developers has been one of the highest priorities for Google Play for many years. Last year we introduced new policies, improved our systems, and further optimized our processes to better protect our users, assist good developers and strengthen our guard against bad apps and developers. Additionally, in 2020, Google Play Protect scanned over 100B installed apps each day for malware across billions of devices.
</p>
<p>
Users come to Google Play to find helpful, reliable apps on everything from COVID-19 vaccine information to new forms of entertainment, grocery delivery, communication and more.
</p>
<p>
As such, we introduced a series of policies and new developer support to continue to elevate  information quality on the platform and reduce the risk of user harm from misinformation.
</p>
<ul>

<li><strong>COVID-19 apps requirements: </strong>To ensure public safety, information integrity and privacy, we introduced <a href="https://support.google.com/googleplay/android-developer/answer/9889712?hl=en#zippy=%2Cofficial-governmental-apps-eligible-for-covid--resource-portions-of-the-google-play-store">specific requirements</a> for COVID-19 apps. Under these requirements, apps related to sensitive use cases, such as those providing testing information, must be endorsed by either official governmental entities or healthcare organizations and must meet a high standard for user data privacy. 

<li><strong>News policy:</strong> To promote transparency in news publishing, we <a href="https://blog.google/outreach-initiatives/civics/google-play-helping-safeguard-elections/">introduced</a> minimum requirements that apps must meet in order for developers to declare their app as a &#8220;News&#8221; app  on Google Play. These <a href="https://support.google.com/googleplay/android-developer/answer/9935326">guidelines</a> help promote user transparency and developer accountability by providing users with relevant information about the app. 

<li><strong>Election support: </strong>We created <a href="https://blog.google/outreach-initiatives/civics/google-play-helping-safeguard-elections/">teams</a> and processes across Google Play focused on elections to provide additional support and adapt to the changing landscape. This includes support for government agencies, specially trained app reviewers, and a safety team to address election threats and abuse. 
</li>
</ul>
<p>
Our core efforts around identifying and mitigating bad apps and developers continued to evolve to address new adversarial behaviors and forms of abuse. Our machine-learning detection capabilities and enhanced app review processes prevented over 962k policy-violating app submissions from getting published to Google Play. We also banned 119k malicious and spammy developer accounts. Additionally, we significantly increased our focus on SDK enforcement, as we've found these violations have an outsized impact on security and user data privacy.
</p>
<p>
Last year, we continued to reduce developer access to sensitive permissions. In February, we <a href="https://android-developers.googleblog.com/2020/02/safer-location-access.html">announced</a> a new background location policy to ensure that apps requesting this permission need the data in order to provide clear user benefit. As a result of the new policy, developers now have to demonstrate that benefit and prominently tell users about it or face possible removal from Google Play. We've begun enforcement on apps not meeting new policy guidelines and will provide an update on the usage of this permission in a future blog post. 
</p>
<p>
We've also continued to invest in protecting kids and helping parents find great content. In 2020 we <a href="https://blog.google/products/google-play/teacher-approved-apps/">launched</a> a new kids tab filled with &#8220;Teacher approved&#8221; apps. To evaluate apps, we teamed with academic experts and teachers across the country, including our lead advisors, Joe Blatt (Harvard Graduate School of Education) and Dr. Sandra Calvert (Georgetown University).
</p>
<p>
As we continue to invest in protecting people from apps with harmful content, malicious behaviors, or threats to user privacy, we are also equally motivated to <a href="https://playacademy.exceedlms.com/student/activity/39632-what-s-new-in-google-play-policy-july-2020">provide trusted experiences to Play developers</a>. For example, we&#8217;ve improved our process for providing relevant information about enforcement actions we&#8217;ve taken, resulting in significant reduction in appeals and increased developer satisfaction. We will continue to enhance the speed and quality of our communications to developers, and continue listening to feedback about how we can further engage and elevate trusted developers. Android developers can expect to see more on this front in the coming year. 
</p>
<p>
Our global teams of product managers, engineers, policy experts, and operations leaders are more excited than ever to advance the safety of the platform and forge a sustaining trust with our users. We look forward to building an even better Google Play experience.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog:How we fought bad apps and developers in 2020&url=https://security.googleblog.com/2021/04/how-we-fought-bad-apps-and-developers.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/04/how-we-fought-bad-apps-and-developers.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/04/how-we-fought-bad-apps-and-developers.html' data-url='https://security.googleblog.com/2021/04/how-we-fought-bad-apps-and-developers.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/04/how-we-fought-bad-apps-and-developers.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
</div>
</div>
</div>
<div class='post' data-id='7096504414205619563' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/04/a-new-standard-for-mobile-app-security.html' itemprop='url' title=' A New Standard for Mobile App Security '>
 A New Standard for Mobile App Security 
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
April 15, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Brooke Davis and Eugene Liderman, Android Security and Privacy Team</span>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-TNecO7NNDL8/YHdg3EKOL3I/AAAAAAAADsc/EW2Jj7nVYaQxkZSvrxpmXZudgt1yrtwIwCNcBGAsYHQ/s0/Image%2B%2523%2B0.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="917" data-original-width="1920" src="https://1.bp.blogspot.com/-TNecO7NNDL8/YHdg3EKOL3I/AAAAAAAADsc/EW2Jj7nVYaQxkZSvrxpmXZudgt1yrtwIwCNcBGAsYHQ/s0/Image%2B%2523%2B0.png"/></a></div>
<p>
With all of the challenges from this past year, users have become increasingly dependent on their mobile devices to create fitness routines, stay connected with loved ones, work remotely, and order things like groceries with ease. According to <a href="https://www.emarketer.com/content/us-adults-will-spend-over-three-hours-per-day-on-mobile-apps-2020">eMarketer</a>, in 2020 users spent over three and a half hours per day using mobile apps. With so much time spent on mobile devices, ensuring the safety of mobile apps is more important than ever. Despite the importance of digital security, there isn&#8217;t a consistent industry standard for assessing mobile apps. Existing guidelines tend to be either too lightweight or too onerous for the average developer, and lack a compliance arm. That&#8217;s why we're excited to share <a href="https://www.ioxtalliance.org/news-events-blog/ioxt-alliance-expands-certification-program-for-mobile-and-vpn-security">ioXt&#8217;s announcement</a> of a new <a href="https://static1.squarespace.com/static/5c6dbac1f8135a29c7fbb621/t/604aa3fa668a8e3b50630433/1615504379349/Mobile_Application_Profile.pdf">Mobile Application Profile</a> which provides a set of security and privacy requirements with defined acceptance criteria which developers can certify their apps against. 
</p>
<p>
Over 20 industry stakeholders, including <strong>Google</strong>, <strong>Amazon</strong>, and a number of certified labs such as <strong>NCC Group</strong> and <strong>Dekra</strong>, as well as automated mobile app security testing vendors like <strong>NowSecure</strong> collaborated to develop this new security standard for mobile apps. We&#8217;ve seen early interest from Internet of Things (IoT) and virtual private network (VPN) developers, however the standard is appropriate for any cloud connected service such as social, messaging, fitness, or productivity apps.
</p>
<p>
The <a href="http://ioxtalliance.org/">Internet of Secure Things Alliance (ioXt)</a> manages a security compliance assessment program for connected devices. ioXt has over 300 members across various industries, including Google, Amazon, Facebook, T-Mobile, Comcast, Zigbee Alliance, Z-Wave Alliance, Legrand, Resideo, Schneider Electric, and many others. With so many companies involved, ioXt covers a wide range of device types, including smart lighting, smart speakers, and webcams, and since most smart devices are managed through apps, they have expanded coverage to include mobile apps with the launch of this profile.
</p>
<p>
The ioXt <a href="https://static1.squarespace.com/static/5c6dbac1f8135a29c7fbb621/t/604aa3fa668a8e3b50630433/1615504379349/Mobile_Application_Profile.pdf">Mobile Application Profile</a> provides a minimum set of commercial best practices for all cloud connected apps running on mobile devices.  This security baseline helps mitigate against common threats and reduces the probability of significant vulnerabilities.  The profile leverages existing standards and principles set forth by <a href="https://mobile-security.gitbook.io/masvs/">OWASP MASVS</a> and the <strong><a href="https://vpntrust.net/">VPN Trust Initiative</a></strong>, and allows developers to differentiate security capabilities around cryptography, authentication, network security, and vulnerability disclosure program quality. The profile also provides a framework to evaluate app category specific requirements which may be applied based on the features contained in the app. For example, an IoT app only needs to certify under the Mobile Application profile, whereas a VPN app must comply with the Mobile Application profile, plus the VPN extension.
</p>
<p>
Certification allows developers to demonstrate product safety and we&#8217;re excited about the opportunity for this standard to push the industry forward. We observed that app developers were very quick to resolve any issues that were identified during their blackbox evaluations against this new standard, oftentimes with turnarounds in a matter of days. At launch, the following apps have been certified: <a href="https://compliance.ioxtalliance.org/product/157">Comcast</a>, <a href="https://compliance.ioxtalliance.org/product/135">ExpressVPN</a>, <a href="https://compliance.ioxtalliance.org/product/68">GreenMAX</a>, <a href="https://compliance.ioxtalliance.org/product/174">Hubspace</a>, <a href="https://compliance.ioxtalliance.org/product/173">McAfee Innovations</a>, <a href="https://compliance.ioxtalliance.org/product/107">NordVPN</a>, <a href="https://compliance.ioxtalliance.org/product/144">OpenVPN for Android</a>, <a href="https://compliance.ioxtalliance.org/product/141">Private Internet Access</a>, <a href="https://compliance.ioxtalliance.org/product/169">VPN Private</a>, as well as the <a href="https://compliance.ioxtalliance.org/product/143">Google One</a> app, including <a href="https://compliance.ioxtalliance.org/product/143">VPN by Google One</a>.
</p>
<p>
We look forward to seeing adoption of the standard grow over time and for those app developers that are already investing in security best practices to be able to highlight their efforts. The standard also serves as a guiding light to inspire more developers to invest in mobile app security. If you are interested in learning more about the ioXt Alliance and how to get your app certified, visit <a href="https://compliance.ioxtalliance.org/sign-up">https://compliance.ioxtalliance.org/sign-up</a> and check out Android&#8217;s guidelines for building secure apps <a href="https://developer.android.com/security">here</a>.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Brooke Davis and Eugene Liderman, Android Security and Privacy Team</span>
<div class="separator" style="clear: both;"><a href="https://1.bp.blogspot.com/-TNecO7NNDL8/YHdg3EKOL3I/AAAAAAAADsc/EW2Jj7nVYaQxkZSvrxpmXZudgt1yrtwIwCNcBGAsYHQ/s0/Image%2B%2523%2B0.png" style="display: block; padding: 1em 0; text-align: center; "><img alt="" border="0" data-original-height="917" data-original-width="1920" src="https://1.bp.blogspot.com/-TNecO7NNDL8/YHdg3EKOL3I/AAAAAAAADsc/EW2Jj7nVYaQxkZSvrxpmXZudgt1yrtwIwCNcBGAsYHQ/s0/Image%2B%2523%2B0.png"/></a></div>
<p>
With all of the challenges from this past year, users have become increasingly dependent on their mobile devices to create fitness routines, stay connected with loved ones, work remotely, and order things like groceries with ease. According to <a href="https://www.emarketer.com/content/us-adults-will-spend-over-three-hours-per-day-on-mobile-apps-2020">eMarketer</a>, in 2020 users spent over three and a half hours per day using mobile apps. With so much time spent on mobile devices, ensuring the safety of mobile apps is more important than ever. Despite the importance of digital security, there isn&#8217;t a consistent industry standard for assessing mobile apps. Existing guidelines tend to be either too lightweight or too onerous for the average developer, and lack a compliance arm. That&#8217;s why we're excited to share <a href="https://www.ioxtalliance.org/news-events-blog/ioxt-alliance-expands-certification-program-for-mobile-and-vpn-security">ioXt&#8217;s announcement</a> of a new <a href="https://static1.squarespace.com/static/5c6dbac1f8135a29c7fbb621/t/604aa3fa668a8e3b50630433/1615504379349/Mobile_Application_Profile.pdf">Mobile Application Profile</a> which provides a set of security and privacy requirements with defined acceptance criteria which developers can certify their apps against. 
</p>
<p>
Over 20 industry stakeholders, including <strong>Google</strong>, <strong>Amazon</strong>, and a number of certified labs such as <strong>NCC Group</strong> and <strong>Dekra</strong>, as well as automated mobile app security testing vendors like <strong>NowSecure</strong> collaborated to develop this new security standard for mobile apps. We&#8217;ve seen early interest from Internet of Things (IoT) and virtual private network (VPN) developers, however the standard is appropriate for any cloud connected service such as social, messaging, fitness, or productivity apps.
</p>
<p>
The <a href="http://ioxtalliance.org/">Internet of Secure Things Alliance (ioXt)</a> manages a security compliance assessment program for connected devices. ioXt has over 300 members across various industries, including Google, Amazon, Facebook, T-Mobile, Comcast, Zigbee Alliance, Z-Wave Alliance, Legrand, Resideo, Schneider Electric, and many others. With so many companies involved, ioXt covers a wide range of device types, including smart lighting, smart speakers, and webcams, and since most smart devices are managed through apps, they have expanded coverage to include mobile apps with the launch of this profile.
</p>
<p>
The ioXt <a href="https://static1.squarespace.com/static/5c6dbac1f8135a29c7fbb621/t/604aa3fa668a8e3b50630433/1615504379349/Mobile_Application_Profile.pdf">Mobile Application Profile</a> provides a minimum set of commercial best practices for all cloud connected apps running on mobile devices.  This security baseline helps mitigate against common threats and reduces the probability of significant vulnerabilities.  The profile leverages existing standards and principles set forth by <a href="https://mobile-security.gitbook.io/masvs/">OWASP MASVS</a> and the <strong><a href="https://vpntrust.net/">VPN Trust Initiative</a></strong>, and allows developers to differentiate security capabilities around cryptography, authentication, network security, and vulnerability disclosure program quality. The profile also provides a framework to evaluate app category specific requirements which may be applied based on the features contained in the app. For example, an IoT app only needs to certify under the Mobile Application profile, whereas a VPN app must comply with the Mobile Application profile, plus the VPN extension.
</p>
<p>
Certification allows developers to demonstrate product safety and we&#8217;re excited about the opportunity for this standard to push the industry forward. We observed that app developers were very quick to resolve any issues that were identified during their blackbox evaluations against this new standard, oftentimes with turnarounds in a matter of days. At launch, the following apps have been certified: <a href="https://compliance.ioxtalliance.org/product/157">Comcast</a>, <a href="https://compliance.ioxtalliance.org/product/135">ExpressVPN</a>, <a href="https://compliance.ioxtalliance.org/product/68">GreenMAX</a>, <a href="https://compliance.ioxtalliance.org/product/174">Hubspace</a>, <a href="https://compliance.ioxtalliance.org/product/173">McAfee Innovations</a>, <a href="https://compliance.ioxtalliance.org/product/107">NordVPN</a>, <a href="https://compliance.ioxtalliance.org/product/144">OpenVPN for Android</a>, <a href="https://compliance.ioxtalliance.org/product/141">Private Internet Access</a>, <a href="https://compliance.ioxtalliance.org/product/169">VPN Private</a>, as well as the <a href="https://compliance.ioxtalliance.org/product/143">Google One</a> app, including <a href="https://compliance.ioxtalliance.org/product/143">VPN by Google One</a>.
</p>
<p>
We look forward to seeing adoption of the standard grow over time and for those app developers that are already investing in security best practices to be able to highlight their efforts. The standard also serves as a guiding light to inspire more developers to invest in mobile app security. If you are interested in learning more about the ioXt Alliance and how to get your app certified, visit <a href="https://compliance.ioxtalliance.org/sign-up">https://compliance.ioxtalliance.org/sign-up</a> and check out Android&#8217;s guidelines for building secure apps <a href="https://developer.android.com/security">here</a>.
</p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog: A New Standard for Mobile App Security &url=https://security.googleblog.com/2021/04/a-new-standard-for-mobile-app-security.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/04/a-new-standard-for-mobile-app-security.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/04/a-new-standard-for-mobile-app-security.html' data-url='https://security.googleblog.com/2021/04/a-new-standard-for-mobile-app-security.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/04/a-new-standard-for-mobile-app-security.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
</div>
</div>
</div>
<div class='post' data-id='2937619278610987846' itemscope='' itemtype='http://schema.org/BlogPosting'>
<h2 class='title' itemprop='name'>
<a href='https://security.googleblog.com/2021/04/rust-in-linux-kernel.html' itemprop='url' title=' Rust in the Linux kernel'>
 Rust in the Linux kernel
</a>
</h2>
<div class='post-header'>
<div class='published'>
<span class='publishdate' itemprop='datePublished'>
April 14, 2021
</span>
</div>
</div>
<div class='post-body'>
<div class='post-content' itemprop='articleBody'>
<script type='text/template'>
                          <span class="byline-author">Posted by Wedson Almeida Filho, Android Team</span> 
<p>
In our <a href="https://security.googleblog.com/2021/04/rust-in-android-platform.html">previous post</a>, we announced that Android now supports the <a href="https://www.rust-lang.org">Rust</a> programming language for developing the OS itself. Related to this, we are also participating in the effort to evaluate the use of Rust as a supported language for developing the Linux kernel. In this post, we discuss some technical aspects of this work using a few simple examples.
</p>
 
<p>
C has been the language of choice for writing kernels for almost half a century because it offers the level of control and predictable performance required by such a critical component. Density of memory safety bugs in the Linux kernel is generally quite low due to high code quality, high standards of code review, and carefully implemented safeguards. However, <a href="https://events19.linuxfoundation.org/wp-content/uploads/2017/11/Syzbot-and-the-Tale-of-Thousand-Kernel-Bugs-Dmitry-Vyukov-Google.pdf">memory safety bugs do still regularly occur</a>. On Android, vulnerabilities in the kernel are generally considered high-severity because they can result in a security model bypass due to the privileged mode that the kernel runs in.
</p>
 
<p>
We feel that Rust is now ready to join C as a practical language for implementing the kernel. It can help us reduce the number of potential bugs and security vulnerabilities in privileged code while playing nicely with the core kernel and preserving its performance characteristics.
</p>
 
<h1>Supporting Rust</h1>
 
<p>
We developed an <a href="https://github.com/Rust-for-Linux/linux/commit/d8dcaf80c9535056ea541d8dd876edad52c538a9#diff-8aa818b39daaf6497eaab2ec0b404bcabf43616362fe9551ed7dd2278682af08">initial prototype</a> of the Binder driver to allow us to make meaningful comparisons between the safety and performance characteristics of the existing C version and its Rust counterpart. The Linux kernel has over 30 million lines of code, so naturally our goal is not to convert it all to Rust but rather to allow new code to be written in Rust. We believe this incremental approach allows us to benefit from the kernel&#8217;s existing high-performance implementation while providing kernel developers with new tools to improve memory safety and maintain performance going forward.
</p>
 
<p>We joined the <a href="https://github.com/Rust-for-Linux">Rust for Linux</a> organization, where the community had already done and continues to do great work toward adding Rust support to the Linux kernel build system. We also need designs that allow code in the two languages to interact with each other: we're particularly interested in safe, zero-cost abstractions that allow Rust code to use kernel functionality written in C, and how to implement functionality in idiomatic Rust that can be called seamlessly from the C portions of the kernel.</p>
 
<p>
Since Rust is a new language for the kernel, we also have the opportunity to enforce best practices in terms of documentation and uniformity. For example, we have specific machine-checked requirements around the usage of unsafe code: for every unsafe function, the developer must document the requirements that need to be satisfied by callers to ensure that its usage is safe; additionally, for every call to unsafe functions (or usage of unsafe constructs like dereferencing a raw pointer), the developer must document the justification for why it is safe to do so.
</p>
 
<p>
Just as important as safety, Rust support needs to be convenient and helpful for developers to use. Let&#8217;s get into a few examples of how Rust can assist kernel developers in writing drivers that are safe and correct.
</p>
 
<h1>Example driver</h1>
 
<p>
We'll use an implementation of a <b>semaphore</b> character device. Each device has a current value; writes of <i>n</i> bytes result in the device value being incremented by <i>n</i>; reads decrement the value by 1 unless the value is 0, in which case they will block until they can decrement the count without going below 0.
</p>
 
<p>
  Suppose <span style="font-family: courier;">semaphore</span> is a file representing our device. We can interact with it from the shell as follows:
</p>
 
<p style="font-family: courier;"> &gt; cat semaphore </p>
 
<p>
  When <span style="font-family: courier;">semaphore</span> is a newly initialized device, the command above will block because the device's current value is 0. It will be unblocked if we run the following command from another shell because it increments the value by 1, which allows the original read to complete:
</p>
 
<p style="font-family: courier;">
&gt; echo -n a &gt; semaphore
</p>
  
<p>We could also increment the count by more than 1 if we write more data, for example:
</p>
 
<p style="font-family: courier;">
&gt; echo -n abc &gt; semaphore
</p>
<p>
increments the count by 3, so the next 3 reads won't block.
</p>
 
<p>
To allow us to show a few more aspects of Rust, we'll add the following features to our driver: remember what the maximum value was throughout the lifetime of a device, and remember how many reads each file issued on the device.
</p>
 
<p>
We'll now show how such a driver would be <a href="https://github.com/Rust-for-Linux/linux/blob/e2382072517dd0b6b65d4e179e322f392efb9676/samples/rust/rust_semaphore.rs">implemented in Rust</a>, contrasting it with a <a href="https://github.com/Rust-for-Linux/linux/blob/e2382072517dd0b6b65d4e179e322f392efb9676/samples/rust/rust_semaphore_c.c">C implementation</a>. We note, however, we are still early on so this is all subject to change in the future. How Rust can assist the developer is the aspect that we'd like to emphasize. For example, at compile time it allows us to eliminate or greatly reduce the chances of introducing classes of bugs, while at the same time remaining flexible and having minimal overhead.
</p>
 
<h2>Character devices</h2>
 
<p>
A developer needs to do the following to implement a driver for a new character device in Rust:
</p>
<ol style="text-align: left;">
  <li>Implement the <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L448"><span style="font-family: courier;">FileOperations</span></a> trait: all associated functions are optional, so the developer only needs to implement the relevant ones for   their scenario. They relate to the fields in C's <a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/fs.h#L1820"><span style="font-family: courier;">struct file_operations</span></a>.
  </li>
  <li>Implement the <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L434"><span style="font-family: courier;">FileOpener</span></a> trait: it is a type-safe equivalent to C's <span style="font-family: courier;">open</span> field of <span style="font-family: courier;">struct file_operations</span>.</li>
  <li>Register the new device type with the kernel: this lets the kernel know what functions need to be called in response to files of this new type being operated on.</li>
</ol>
 
<p>
The following outlines how the first two steps of our example compare in Rust and C:
</p>
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
  
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-keyword" style="font-weight: 700;">impl</span> FileOpener&lt;Arc&lt;Semaphore&gt;&gt; <span class="hljs-keyword" style="font-weight: 700;">for</span> FileState {
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">open</span></span>(
        shared: &amp;Arc&lt;Semaphore&gt;
    ) -&gt; KernelResult&lt;<span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;&gt; {
        [...]
    }
}
 
<span class="hljs-keyword" style="font-weight: 700;">impl</span> FileOperations <span class="hljs-keyword" style="font-weight: 700;">for</span> FileState {
    <span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">type</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">Wrapper</span></span> = <span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;;
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">read</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        _: &amp;File,
        data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrWriter,
        offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
        [...]
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">write</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrReader,
        _offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
        [...]
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">ioctl</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        file: &amp;File,
        cmd: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> IoctlCommand
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
        [...]
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">release</span></span>(_obj: <span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;, _file: &amp;File) {
        [...]
    }
 
    declare_file_operations!(read, write, ioctl);
}</pre>
 
</td>
  <td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
 
    <pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span> 
<span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_open</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> inode *nodp,
                   <span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared =
        container_of(filp-&gt;private_data,
                     <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state,
                     miscdev);
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_write</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                        <span class="hljs-keyword" style="font-weight: 700;">const</span> <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                        <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_read</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                       <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                       <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
<span class="hljs-keyword" style="font-weight: 700;">long</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_ioctl</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">int</span> cmd,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">long</span> arg)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
<span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_release</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> inode *nodp,
                      <span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-keyword" style="font-weight: 700;">static</span> <span class="hljs-keyword" style="font-weight: 700;">const</span> <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_operations semaphore_fops = {
        .owner = THIS_MODULE,
        .open = semaphore_open,
        .read = semaphore_read,
        .write = semaphore_write,
        .compat_ioctl = semaphore_ioctl,
        .release = semaphore_release,
};</pre>
 
</td></tr></tbody></table>
</center>
 
<p>
Character devices in Rust benefit from a number of safety features:
</p>
 
<ul style="text-align: left;">
  <li>Per-file state lifetime management: <span style="font-family: courier;">FileOpener::open</span> returns an object whose lifetime is owned by the caller from then on. Any object that implements the <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L516">PointerWrapper</a></span> trait can be returned, and we provide implementations for <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/boxed/struct.Box.html">Box&lt;T&gt;</a></span> and <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/sync/struct.Arc.html">Arc&lt;T&gt;</a></span>, so developers that use Rust's idiomatic heap-allocated or reference-counted pointers have no additional requirements.
<br /><br />
All associated functions in <span style="font-family: courier;">FileOperations</span> receive non-mutable references to <span style="font-family: courier;">self</span> (more about this below), except the <span style="font-family: courier;">release</span> function, which is the last function to be called and receives the plain object back (and its ownership with it). The <span style="font-family: courier;">release</span> implementation can then defer the object destruction by transferring its ownership elsewhere, or destroy it then; in the case of a reference-counted object, 'destruction' means decrementing the reference count (and actual object destruction if the count goes to zero).
<br /><br />
That is, we use Rust's ownership discipline when interacting with C code by handing the C portion ownership of a Rust object, allowing it to call functions implemented in Rust, then eventually giving ownership back. So as long as the C code is correct, the lifetime of Rust file objects work seamlessly as well, with the compiler enforcing correct lifetime management on the Rust side, for example: open cannot return stack-allocated pointers or heap-allocated objects containing pointers to the stack, <span style="font-family: courier;">ioctl</span>/<span style="font-family: courier;">read</span>/<span style="font-family: courier;">write</span> cannot free (or modify without synchronization) the contents of the object stored in <span style="font-family: courier;">filp-&gt;private_data</span>, etc.
  <br /><br />  </li>
  
  <li>Non-mutable references: the associated functions called between <span style="font-family: courier;">open</span> and <span style="font-family: courier;">release</span> all receive non-mutable references to <span style="font-family: courier;">self</span> because they can be called concurrently by multiple threads and Rust aliasing rules prohibit more than one mutable reference to an object at any given time.
<br /><br />
If a developer needs to modify some state (and they generally do), they can do so via <i><a href="https://doc.rust-lang.org/reference/interior-mutability.html">interior mutability</a></i>: mutable state can be wrapped in a <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/sync/mutex.rs#L29">Mutex&lt;T&gt;</a></span> or <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/sync/spinlock.rs#L45">SpinLock&lt;T&gt;</a></span> (or <a href="https://doc.rust-lang.org/core/sync/atomic/">atomics</a>) and safely modified through them.
<br /><br />
This prevents, at compile-time, bugs where a developer fails to acquire the appropriate lock when accessing a field (the field is inaccessible), or when a developer fails to wrap a field with a lock (the field is read-only).
<br /><br /></li>
    
  
    <li>Per-device state: when file instances need to share per-device state, which is a very common occurrence in drivers, they can do so safely in Rust. When a device is registered, a typed object can be provided and a non-mutable reference to it is provided when <span style="font-family: courier;">FileOperation::open</span> is called. In our example, the shared object is wrapped in <span style="font-family: courier;">Arc&lt;T&gt;</span>, so files can safely clone and hold on to a reference to them.
<br /><br />
The reason <span style="font-family: courier;">FileOperation</span> is its own trait (as opposed to, for example, <span style="font-family: courier;">open</span> being part of the <span style="font-family: courier;">FileOperations</span> trait) is to allow a single file implementation to be registered in different ways.
<br /><br />
This eliminates opportunities for developers to get the wrong data when trying to retrieve shared state. For example, in C when a <span style="font-family: courier;"><a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/miscdevice.h#L79">miscdevice</a></span> is registered, a pointer to it is available in <span style="font-family: courier;">filp-&gt;private_data</span>; when a <a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/cdev.h#L14"><span style="font-family: courier;">cdev</span></a> is registered, a pointer to it is available in <span style="font-family: courier;">inode-&gt;i_cdev</span>. These structs are usually embedded in an outer struct that contains the shared state, so developers usually use the <a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/kernel.h#L685"><span style="font-family: courier;">container_of</span></a> macro to recover the shared state. Rust encapsulates all of this and the potentially troublesome pointer casts in a safe abstraction.
      <br /><br /></li>
  
  <li>
    Static typing: we take advantage of Rust's support for generics to implement all of the above functions and types with static types. So there are no opportunities for a developer to convert an untyped variable or field to the wrong type. The C code in the table above has casts from an essentially untyped (<span style="font-family: courier;">void</span> *) pointer to the desired type at the start of each function: this is likely to work fine when first written, but may lead to bugs as the code evolves and assumptions change. Rust would catch any such mistakes at compile time.<br /><br />
  </li>
  
  <li>
    File operations: as we mentioned before, a developer needs to implement the <span style="font-family: courier;">FileOperations</span> trait to customize the behavior of their device. They do this with a block starting with <span style="font-family: courier;">impl FileOperations for Device</span>, where <span style="font-family: courier;">Device</span> is the type implementing the file behavior (<span style="font-family: courier;">FileState</span> in our example). Once inside this block, tools know that only a limited number of functions can be defined, so they can automatically insert the prototypes. (Personally, I use <span style="font-family: courier;"><a href="https://github.com/neovim/nvim-lspconfig">neovim</a></span> and the <a href="https://rust-analyzer.github.io/"><span style="font-family: courier;">rust-analyzer</span></a> LSP server.)
<br /><br />While we use this trait in Rust, the C portion of the kernel still requires an instance of <span style="font-family: courier;">struct file_operations</span>. The kernel crate automatically generates one from the trait implementation (and optionally the <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L309">declare_file_operations</a></span> macro): although it has code to generate the correct struct, it is all <span style="font-family: courier;">const</span>, so evaluated at compile-time with zero runtime cost.
  </li>
</ul>
 
<h2>Ioctl handling</h2>
 
<p>
For a driver to provide a custom <a href="https://man7.org/linux/man-pages/man2/ioctl.2.html">ioctl</a> handler, it needs to implement the&nbsp;<span style="font-family: courier;">ioctl</span> function that is part of the <span style="font-family: courier;">FileOperations</span> trait, as exemplified in the table below.
</p><p>
 
</p><center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">ioctl</span></span>(
    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
    file: &amp;File,
    cmd: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> IoctlCommand
) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
    cmd.dispatch(<span class="hljs-keyword" style="font-weight: 700;">self</span>, file)
}
 
<span class="hljs-keyword" style="font-weight: 700;">impl</span> IoctlHandler <span class="hljs-keyword" style="font-weight: 700;">for</span> FileState {
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">read</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        _file: &amp;File,
        cmd: <span class="hljs-keyword" style="font-weight: 700;">u32</span>,
        writer: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrWriter
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
        <span class="hljs-keyword" style="font-weight: 700;">match</span> cmd {
            IOCTL_GET_READ_COUNT =&gt; {
                writer.write(
                    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>
                    .read_count
                    .load(Ordering::Relaxed))?;
                <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-number" style="color: #880000;">0</span>)
            }
            _ =&gt; <span class="hljs-literal" style="color: #78a960;">Err</span>(Error::EINVAL),
        }
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">write</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        _file: &amp;File,
        cmd: <span class="hljs-keyword" style="font-weight: 700;">u32</span>,
        reader: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrReader
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
        <span class="hljs-keyword" style="font-weight: 700;">match</span> cmd {
            IOCTL_SET_READ_COUNT =&gt; {
                <span class="hljs-keyword" style="font-weight: 700;">self</span>
                .read_count
                .store(reader.read()?,
                       Ordering::Relaxed);
                <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-number" style="color: #880000;">0</span>)
            }
            _ =&gt; <span class="hljs-literal" style="color: #78a960;">Err</span>(Error::EINVAL),
        }
    }
}</pre>
</td>
  
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-meta" style="color: #1f7199;">#<span class="hljs-meta-keyword" style="font-weight: 700;">define</span> IOCTL_GET_READ_COUNT _IOR(<span class="hljs-meta-string" style="color: #4d99bf;">'c'</span>, 1, u64)</span>
<span class="hljs-meta" style="color: #1f7199;">#<span class="hljs-meta-keyword" style="font-weight: 700;">define</span> IOCTL_SET_READ_COUNT _IOW(<span class="hljs-meta-string" style="color: #4d99bf;">'c'</span>, 1, u64)</span>
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
<span class="hljs-keyword" style="font-weight: 700;">long</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_ioctl</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">int</span> cmd,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">long</span> arg)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    <span class="hljs-keyword" style="font-weight: 700;">void</span> __user *buffer = (<span class="hljs-keyword" style="font-weight: 700;">void</span> __user *)arg;
    u64 value;
 
    <span class="hljs-keyword" style="font-weight: 700;">switch</span> (cmd) {
    <span class="hljs-keyword" style="font-weight: 700;">case</span> IOCTL_GET_READ_COUNT:
        value = atomic64_read(&amp;state-&gt;read_count);
        <span class="hljs-keyword" style="font-weight: 700;">if</span> (copy_to_user(buffer, &amp;value, <span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(value)))
            <span class="hljs-keyword" style="font-weight: 700;">return</span> -EFAULT;
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
    <span class="hljs-keyword" style="font-weight: 700;">case</span> IOCTL_SET_READ_COUNT:
        <span class="hljs-keyword" style="font-weight: 700;">if</span> (copy_from_user(&amp;value, buffer, <span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(value)))
            <span class="hljs-keyword" style="font-weight: 700;">return</span> -EFAULT;
        atomic64_set(&amp;state-&gt;read_count, value);
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
    <span class="hljs-keyword" style="font-weight: 700;">default</span>:
        <span class="hljs-keyword" style="font-weight: 700;">return</span> -EINVAL;
    }
}</pre>
</td></tr></tbody></table>
</center>
  
  
<p>
Ioctl commands are standardized such that, given a command, we know whether a user buffer is provided, its intended use (read, write, both, none), and its size. In Rust, we provide a <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L386">dispatcher</a> (accessible by calling <span style="font-family: courier;">cmd.dispatch</span>) that uses this information to automatically create user memory access helpers and pass them to the caller.
</p>
 
<p>
A driver is not <i>required</i> to use this though. If, for example, it doesn't use the standard ioctl encoding, Rust offers the flexibility of simply calling <span style="font-family: courier;">cmd.raw</span> to extract the raw arguments and using them to handle the ioctl (potentially with unsafe code, which will need to be justified).
</p>
 
<p>
However, if a driver implementation does use the standard dispatcher, it will benefit from not having to implement any unsafe code, and:
</p>
 
<ul style="text-align: left;">
  <li>The pointer to user memory is never a native pointer, so the developer cannot accidentally dereference it.
</li>
  <li>The types that allow the driver to read from user space only allow data to be read once, so we eliminate the risk of time-of-check to time-of-use (TOCTOU) bugs because when a driver needs to access data twice, it needs to copy it to kernel memory, where an attacker is not allowed to modify it. Excluding unsafe blocks, there is no way to introduce this class of bugs in Rust.
</li>
  <li>No accidental overflow of the user buffer: we'll never read or write past the end of the user buffer because this is enforced automatically based on the size encoded in the ioctl command. In our example above, the implementation of <span style="font-family: courier;">IOCTL_GET_READ_COUNT</span> only has access to an instance of <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/user_ptr.rs#L230"><span style="font-family: courier;">UserSlicePtrWriter</span></a>, which limits the number of writable bytes to <span style="font-family: courier;">sizeof(u64)</span> as encoded in the ioctl command.
</li>
  <li>No mixing of reads and writes: we'll never write buffers for ioctls that are only meant to read and never read buffers for ioctls that are only meant to write. This is enforced by read and write handlers only getting instances of <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/user_ptr.rs#L230"><span style="font-family: courier;">UserSlicePtrWriter</span></a> and <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/user_ptr.rs#L158"><span style="font-family: courier;">UserSlicePtrReader</span></a> respectively.
</li>
</ul>
 
<p>
All of the above could potentially also be done in C, but it's very easy for developers to (likely unintentionally) break contracts that lead to unsafety; Rust requires <span style="font-family: courier;">unsafe</span> blocks for this, which should only be used in rare cases and brings additional scrutiny. Additionally, Rust offers the following:
</p>
 
<ul style="text-align: left;">
  <li>The types used to read and write user memory do not implement the <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/marker/trait.Send.html">Send</a></span> and <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/marker/trait.Sync.html">Sync</a></span> traits, which means that they (and pointers to them) are not safe to be used in another thread context. In Rust, if a driver developer attempted to write code that passed one of these objects to another thread (where it wouldn't be safe to use them because it isn't necessarily in the right memory manager context), they would get a compilation error.</li>
  <li>When calling <span style="font-family: courier;">IoctlCommand::dispatch</span>, one might understandably think that we need dynamic dispatching to reach the actual handler implementation (which would incur additional cost in comparison to C), but we don't. Our usage of generics will lead the compiler to monomorphize the function, which will result in static function calls that can even be inlined if the optimizer so chooses.
</li>
</ul>
 
 
<h2>Locking and condition variables</h2>
  
<p>We allow developers to use mutexes and spinlocks to provide interior mutability. In our example, we use a mutex to protect mutable data; in the tables below we show the data structures we use in C and Rust, and how we implement a wait until the count is nonzero so that we can satisfy a read:
  </p>
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">struct</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">SemaphoreInner</span></span> {
    count: <span class="hljs-keyword" style="font-weight: 700;">usize</span>,
    max_seen: <span class="hljs-keyword" style="font-weight: 700;">usize</span>,
}
 
<span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">struct</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">Semaphore</span></span> {
    changed: CondVar,
    inner: Mutex&lt;SemaphoreInner&gt;,
}
 
<span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">struct</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">FileState</span></span> {
    read_count: AtomicU64,
    shared: Arc&lt;Semaphore&gt;,
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state {
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> kref ref;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> miscdevice miscdev;
    <span class="hljs-keyword" style="font-weight: 700;">wait_queue_head_t</span> changed;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> mutex mutex;
    <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count;
    <span class="hljs-keyword" style="font-weight: 700;">size_t</span> max_seen;
};
 
<span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state {
    <span class="hljs-keyword" style="font-weight: 700;">atomic64_t</span> read_count;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared;
};</pre>
</td></tr></tbody></table>
</center>
 
 
 
 
 
 
 
 
 
 
 <br />
 
 
 
 
 
 
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">consume</span></span>(&amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>) -&gt; KernelResult {
    <span class="hljs-keyword" style="font-weight: 700;">let</span> <span class="hljs-keyword" style="font-weight: 700;">mut</span> inner = <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.inner.lock();
    <span class="hljs-keyword" style="font-weight: 700;">while</span> inner.count == <span class="hljs-number" style="color: #880000;">0</span> {
        <span class="hljs-keyword" style="font-weight: 700;">if</span> <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.changed.wait(&amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> inner) {
            <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-literal" style="color: #78a960;">Err</span>(Error::EINTR);
        }
    }
    inner.count -= <span class="hljs-number" style="color: #880000;">1</span>;
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(())
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span> <span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_consume</span><span class="hljs-params">(
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *state)</span>
</span>{
    DEFINE_WAIT(wait);
 
    mutex_lock(&amp;state-&gt;mutex);
    <span class="hljs-keyword" style="font-weight: 700;">while</span> (state-&gt;count == <span class="hljs-number" style="color: #880000;">0</span>) {
        prepare_to_wait(&amp;state-&gt;changed, &amp;wait,
                        TASK_INTERRUPTIBLE);
        mutex_unlock(&amp;state-&gt;mutex);
        schedule();
        finish_wait(&amp;state-&gt;changed, &amp;wait);
        <span class="hljs-keyword" style="font-weight: 700;">if</span> (signal_pending(current))
            <span class="hljs-keyword" style="font-weight: 700;">return</span> -EINTR;
        mutex_lock(&amp;state-&gt;mutex);
    }
 
    state-&gt;count--;
    mutex_unlock(&amp;state-&gt;mutex);
 
    <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
}</pre>
</td></tr></tbody></table>
</center>
 
<p>
We note that such waits are not uncommon in the existing C code, for example, a <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/fs/pipe.c#L1053">pipe waiting</a> for a "partner" to write, a <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/net/unix/af_unix.c#L2189">unix-domain socket waiting</a> for data, an <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/fs/inode.c#L829">inode search waiting</a> for completion of a delete, or a <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/kernel/umh.c#L249">user-mode helper waiting</a> for state change.</p>
 
<p>
The following are benefits from the Rust implementation:
</p>
 
 
<ul>
  <li>The <span style="font-family: courier;">Semaphore::inner</span> field is only accessible when the lock is held, through the guard returned by the <span style="font-family: courier;">lock</span> function. So developers cannot accidentally read or write protected data without locking it first. In the C example above, <span style="font-family: courier;">count</span> and <span style="font-family: courier;">max_seen</span> in <span style="font-family: courier;">semaphore_state</span> are protected by <span style="font-family: courier;">mutex</span>, but there is no enforcement that the lock is held while they're accessed.
</li>
  <li>Resource Acquisition Is Initialization (RAII): the lock is unlocked automatically when the guard (<span style="font-family: courier;">inner</span> in this case) goes out of scope. This ensures that locks are always unlocked: if the developer needs to keep a lock locked, they can keep the guard alive, for example, by returning the guard itself; conversely, if they need to unlock before the end of the scope, they can explicitly do it by calling the <span style="font-family: courier;">drop</span> function.
</li>
  <li>Developers can use any lock that implements the <span style="font-family: courier;">Lock</span> trait, which includes <span style="font-family: courier;">Mutex</span> and <span style="font-family: courier;">SpinLock</span>, at no additional runtime cost when compared to a C implementation. Other synchronization constructs, including condition variables, also work transparently and with zero additional run-time cost.
</li>
  <li>Rust implements condition variables using kernel wait queues. This allows developers to benefit from atomic release of the lock and putting the thread to sleep without having to reason about low-level kernel scheduler functions. In the C example above, <span style="font-family: courier;">semaphore_consume</span> is a mix of semaphore logic and subtle Linux scheduling: for example, the code is incorrect if <span style="font-family: courier;">mutex_unlock</span> is called before <span style="font-family: courier;">prepare_to_wait</span> because it may result in a wake up being missed.
</li>
  <li>No unsynchronized access: as we mentioned before, variables shared by multiple threads/CPUs must be read-only, with interior mutability being the solution for cases when mutability is needed. In addition to the example with locks above, the ioctl example in the previous section also has an example of using an atomic variable; Rust also requires developers to specify how memory is to <a href="https://doc.rust-lang.org/core/sync/atomic/enum.Ordering.html">be synchronized</a> by atomic accesses. In the C part of the example, we happen to use <span style="font-family: courier;">atomic64_t</span>, but the compiler won't alert a developer to this need.
</li>
 
</ul>
 
<h2>Error handling and control flow</h2>
 
<p>
In the tables below, we show how <span style="font-family: courier;">open</span>, <span style="font-family: courier;">read</span>, and <span style="font-family: courier;">write</span> are implemented in our example driver:
</p>
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">read</span></span>(
    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
    _: &amp;File,
    data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrWriter,
    offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
   <span class="hljs-keyword" style="font-weight: 700;">if</span> data.is_empty() <span class="hljs-params">||</span> offset &gt; <span class="hljs-number" style="color: #880000;">0</span> {
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hl js-number" style="color: #880000;">0</span>);
    }
 
    <span class="hljs-keyword" style="font-weight: 700;">self</span>.consume()?;
    data.write_slice(&amp;[<span class="hljs-number" style="color: #880000;">0u8</span>; <span class="hljs-number" style="color: #880000;">1</span>])?;
    <span class="hljs-keyword" style="font-weight: 700;">self</span>.read_count.fetch_add(<span class="hljs-number" style="color: #880000;">1</span>, Ordering::Relaxed);
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-number" style="color: #880000;">1</span>)
}
 
</pre>
</td>
  
  <td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_read</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                       <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                       <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    <span class="hljs-keyword" style="font-weight: 700;">char</span> c = <span class="hljs-number" style="color: #880000;">0</span>;
    <span class="hljs-keyword" style="font-weight: 700;">int</span> ret;
 
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (count == <span class="hljs-number" style="color: #880000;">0</span> || *ppos &gt; <span class="hljs-number" style="color: #880000;">0</span>)
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
 
    ret = semaphore_consume(state-&gt;shared);
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (ret)
        <span class="hljs-keyword" style="font-weight: 700;">return</span> ret;
 
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (copy_to_user(buffer, &amp;c, <span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(c)))
        <span class="hljs-keyword" style="font-weight: 700;">return</span> -EFAULT;
 
    atomic64_add(<span class="hljs-number" style="color: #880000;">1</span>, &amp;state-&gt;read_count);
    *ppos += <span class="hljs-number" style="color: #880000;">1</span>;
    <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">1</span>;
}</pre> 
</td>
  
  </tr></tbody></table>
</center>
 
 
 
 
 <br />
 
 
 
 
 
 
 
 
 
 
 
 
 
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">write</span></span>(
    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
    data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrReader,
    _offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
   {
        <span class="hljs-keyword" style="font-weight: 700;">let</span> <span class="hljs-keyword" style="font-weight: 700;">mut</span> inner = <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.inner.lock();
        inner.count = inner.count.saturating_add(data.len());
        <span class="hljs-keyword" style="font-weight: 700;">if</span> inner.count &gt; inner.max_seen {
            inner.max_seen = inner.count;
        }
    }
 
    <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.changed.notify_all();
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(data.len())
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_write</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                        <span class="hljs-keyword" style="font-weight: 700;">const</span> <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                        <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared = state-&gt;shared;
 
    mutex_lock(&amp;shared-&gt;mutex);
    shared-&gt;count += count;
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (shared-&gt;count &lt; count)
        shared-&gt;count = SIZE_MAX;
 
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (shared-&gt;count &gt; shared-&gt;max_seen)
        shared-&gt;max_seen = shared-&gt;count;
 
    mutex_unlock(&amp;shared-&gt;mutex);
 
    wake_up_all(&amp;shared-&gt;changed);
    <span class="hljs-keyword" style="font-weight: 700;">return</span> count;
}</pre>
</td></tr></tbody></table>
</center>
 
 
 
 
 
 
  <br />
 
 
 
 
 
 
 
 
 
 
 
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">open</span></span>(
    shared: &amp;Arc&lt;Semaphore&gt;
) -&gt; KernelResult&lt;<span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;&gt; {
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-built_in" style="color: #397300;">Box</span>::try_new(<span class="hljs-keyword" style="font-weight: 700;">Self</span> {
        read_count: AtomicU64::new(<span class="hljs-number" style="color: #880000;">0</span>),
        shared: shared.clone(),
    })?)
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span> 
<span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_open</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> inode *nodp,
                   <span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared =
        container_of(filp-&gt;private_data,
                     <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state,
                     miscdev);
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state;
 
    state = kzalloc(<span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(*state), GFP_KERNEL);
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (!state)
        <span class="hljs-keyword" style="font-weight: 700;">return</span> -ENOMEM;
 
    kref_get(&amp;shared-&gt;ref);
    state-&gt;shared = shared;
    atomic64_set(&amp;state-&gt;read_count, <span class="hljs-number" style="color: #880000;">0</span>);
 
    filp-&gt;private_data = state;
 
    <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
}</pre>
</td></tr></tbody></table>
</center>
 
<p>
They illustrate other benefits brought by Rust:
</p>
 
<ul>
  <li>The <span style="font-family: courier;">?</span> operator: it is used by the Rust <span style="font-family: courier;">open</span> and <span style="font-family: courier;">read</span> implementations to do error handling implicitly; the developer can focus on the semaphore logic, the resulting code being quite small and readable. The C versions have error-handling noise that can make them less readable.
</li>
  <li>Required initialization: Rust requires all fields of a struct to be initialized on construction, so the developer can never accidentally fail to initialize a field; C offers no such facility. In our <span style="font-family: courier;">open</span> example above, the developer of the C version could easily fail to call <span style="font-family: courier;">kref_get</span> (even though all fields would have been initialized); in Rust, the user is required to call <span style="font-family: courier;">clone</span> (which increments the ref count), otherwise they get a compilation error.
</li>
  <li>RAII scoping: the Rust write implementation uses a statement block to control when <span style="font-family: courier;">inner</span> goes out of scope and therefore the lock is released.
</li>
  <li>Integer overflow behavior: Rust encourages developers to always consider how overflows should be handled. In our <span style="font-family: courier;">write</span> example, we want a saturating one so that we don't end up with a zero value when adding to our semaphore. In C, we need to manually check for overflows, there is no additional support from the compiler.
</li>
</ul>
 
<h1>What's next</h1>
 
<p>
The examples above are only a small part of the whole project. We hope it gives readers a glimpse of the kinds of benefits that Rust brings. At the moment we have nearly all generic kernel functionality needed by Binder neatly wrapped in safe Rust abstractions, so we are in the process of <a href="https://lore.kernel.org/lkml/20210414184604.23473-1-ojeda@kernel.org/T/#mb5e524dae9d5a5815c6e68eb36b9bde4e87c861d">gathering feedback from the broader Linux kernel community</a> with the intent of upstreaming the existing Rust support.
</p>
 
<p>
We also continue to make progress on our Binder prototype, implement additional abstractions, and smooth out some rough edges. This is an exciting time and a rare opportunity to potentially influence how the Linux kernel is developed, as well as inform the evolution of the Rust language. We invite those interested to join us in <a href="https://github.com/Rust-for-Linux/linux">Rust for Linux</a> and attend our planned talk at <a href="https://linuxplumbersconf.org/">Linux Plumbers Conference 2021</a>!
</p>
 
<p><i><br /></i></p><p><i>
Thanks Nick Desaulniers, Kees Cook, and Adrian Taylor for contributions to this post. Special thanks to Jeff Vander Stoep for contributions and editing, and to Greg Kroah-Hartman for reviewing and contributing to the code examples.
</i></p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
  <meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
                        </script>
<noscript>
<span class="byline-author">Posted by Wedson Almeida Filho, Android Team</span> 
<p>
In our <a href="https://security.googleblog.com/2021/04/rust-in-android-platform.html">previous post</a>, we announced that Android now supports the <a href="https://www.rust-lang.org">Rust</a> programming language for developing the OS itself. Related to this, we are also participating in the effort to evaluate the use of Rust as a supported language for developing the Linux kernel. In this post, we discuss some technical aspects of this work using a few simple examples.
</p>
 
<p>
C has been the language of choice for writing kernels for almost half a century because it offers the level of control and predictable performance required by such a critical component. Density of memory safety bugs in the Linux kernel is generally quite low due to high code quality, high standards of code review, and carefully implemented safeguards. However, <a href="https://events19.linuxfoundation.org/wp-content/uploads/2017/11/Syzbot-and-the-Tale-of-Thousand-Kernel-Bugs-Dmitry-Vyukov-Google.pdf">memory safety bugs do still regularly occur</a>. On Android, vulnerabilities in the kernel are generally considered high-severity because they can result in a security model bypass due to the privileged mode that the kernel runs in.
</p>
 
<p>
We feel that Rust is now ready to join C as a practical language for implementing the kernel. It can help us reduce the number of potential bugs and security vulnerabilities in privileged code while playing nicely with the core kernel and preserving its performance characteristics.
</p>
 
<h1>Supporting Rust</h1>
 
<p>
We developed an <a href="https://github.com/Rust-for-Linux/linux/commit/d8dcaf80c9535056ea541d8dd876edad52c538a9#diff-8aa818b39daaf6497eaab2ec0b404bcabf43616362fe9551ed7dd2278682af08">initial prototype</a> of the Binder driver to allow us to make meaningful comparisons between the safety and performance characteristics of the existing C version and its Rust counterpart. The Linux kernel has over 30 million lines of code, so naturally our goal is not to convert it all to Rust but rather to allow new code to be written in Rust. We believe this incremental approach allows us to benefit from the kernel&#8217;s existing high-performance implementation while providing kernel developers with new tools to improve memory safety and maintain performance going forward.
</p>
 
<p>We joined the <a href="https://github.com/Rust-for-Linux">Rust for Linux</a> organization, where the community had already done and continues to do great work toward adding Rust support to the Linux kernel build system. We also need designs that allow code in the two languages to interact with each other: we're particularly interested in safe, zero-cost abstractions that allow Rust code to use kernel functionality written in C, and how to implement functionality in idiomatic Rust that can be called seamlessly from the C portions of the kernel.</p>
 
<p>
Since Rust is a new language for the kernel, we also have the opportunity to enforce best practices in terms of documentation and uniformity. For example, we have specific machine-checked requirements around the usage of unsafe code: for every unsafe function, the developer must document the requirements that need to be satisfied by callers to ensure that its usage is safe; additionally, for every call to unsafe functions (or usage of unsafe constructs like dereferencing a raw pointer), the developer must document the justification for why it is safe to do so.
</p>
 
<p>
Just as important as safety, Rust support needs to be convenient and helpful for developers to use. Let&#8217;s get into a few examples of how Rust can assist kernel developers in writing drivers that are safe and correct.
</p>
 
<h1>Example driver</h1>
 
<p>
We'll use an implementation of a <b>semaphore</b> character device. Each device has a current value; writes of <i>n</i> bytes result in the device value being incremented by <i>n</i>; reads decrement the value by 1 unless the value is 0, in which case they will block until they can decrement the count without going below 0.
</p>
 
<p>
  Suppose <span style="font-family: courier;">semaphore</span> is a file representing our device. We can interact with it from the shell as follows:
</p>
 
<p style="font-family: courier;"> &gt; cat semaphore </p>
 
<p>
  When <span style="font-family: courier;">semaphore</span> is a newly initialized device, the command above will block because the device's current value is 0. It will be unblocked if we run the following command from another shell because it increments the value by 1, which allows the original read to complete:
</p>
 
<p style="font-family: courier;">
&gt; echo -n a &gt; semaphore
</p>
  
<p>We could also increment the count by more than 1 if we write more data, for example:
</p>
 
<p style="font-family: courier;">
&gt; echo -n abc &gt; semaphore
</p>
<p>
increments the count by 3, so the next 3 reads won't block.
</p>
 
<p>
To allow us to show a few more aspects of Rust, we'll add the following features to our driver: remember what the maximum value was throughout the lifetime of a device, and remember how many reads each file issued on the device.
</p>
 
<p>
We'll now show how such a driver would be <a href="https://github.com/Rust-for-Linux/linux/blob/e2382072517dd0b6b65d4e179e322f392efb9676/samples/rust/rust_semaphore.rs">implemented in Rust</a>, contrasting it with a <a href="https://github.com/Rust-for-Linux/linux/blob/e2382072517dd0b6b65d4e179e322f392efb9676/samples/rust/rust_semaphore_c.c">C implementation</a>. We note, however, we are still early on so this is all subject to change in the future. How Rust can assist the developer is the aspect that we'd like to emphasize. For example, at compile time it allows us to eliminate or greatly reduce the chances of introducing classes of bugs, while at the same time remaining flexible and having minimal overhead.
</p>
 
<h2>Character devices</h2>
 
<p>
A developer needs to do the following to implement a driver for a new character device in Rust:
</p>
<ol style="text-align: left;">
  <li>Implement the <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L448"><span style="font-family: courier;">FileOperations</span></a> trait: all associated functions are optional, so the developer only needs to implement the relevant ones for   their scenario. They relate to the fields in C's <a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/fs.h#L1820"><span style="font-family: courier;">struct file_operations</span></a>.
  </li>
  <li>Implement the <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L434"><span style="font-family: courier;">FileOpener</span></a> trait: it is a type-safe equivalent to C's <span style="font-family: courier;">open</span> field of <span style="font-family: courier;">struct file_operations</span>.</li>
  <li>Register the new device type with the kernel: this lets the kernel know what functions need to be called in response to files of this new type being operated on.</li>
</ol>
 
<p>
The following outlines how the first two steps of our example compare in Rust and C:
</p>
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
  
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-keyword" style="font-weight: 700;">impl</span> FileOpener&lt;Arc&lt;Semaphore&gt;&gt; <span class="hljs-keyword" style="font-weight: 700;">for</span> FileState {
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">open</span></span>(
        shared: &amp;Arc&lt;Semaphore&gt;
    ) -&gt; KernelResult&lt;<span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;&gt; {
        [...]
    }
}
 
<span class="hljs-keyword" style="font-weight: 700;">impl</span> FileOperations <span class="hljs-keyword" style="font-weight: 700;">for</span> FileState {
    <span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">type</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">Wrapper</span></span> = <span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;;
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">read</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        _: &amp;File,
        data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrWriter,
        offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
        [...]
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">write</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrReader,
        _offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
        [...]
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">ioctl</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        file: &amp;File,
        cmd: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> IoctlCommand
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
        [...]
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">release</span></span>(_obj: <span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;, _file: &amp;File) {
        [...]
    }
 
    declare_file_operations!(read, write, ioctl);
}</pre>
 
</td>
  <td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
 
    <pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span> 
<span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_open</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> inode *nodp,
                   <span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared =
        container_of(filp-&gt;private_data,
                     <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state,
                     miscdev);
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_write</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                        <span class="hljs-keyword" style="font-weight: 700;">const</span> <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                        <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_read</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                       <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                       <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
<span class="hljs-keyword" style="font-weight: 700;">long</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_ioctl</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">int</span> cmd,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">long</span> arg)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
<span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_release</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> inode *nodp,
                      <span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    [...]
}
 
<span class="hljs-keyword" style="font-weight: 700;">static</span> <span class="hljs-keyword" style="font-weight: 700;">const</span> <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_operations semaphore_fops = {
        .owner = THIS_MODULE,
        .open = semaphore_open,
        .read = semaphore_read,
        .write = semaphore_write,
        .compat_ioctl = semaphore_ioctl,
        .release = semaphore_release,
};</pre>
 
</td></tr></tbody></table>
</center>
 
<p>
Character devices in Rust benefit from a number of safety features:
</p>
 
<ul style="text-align: left;">
  <li>Per-file state lifetime management: <span style="font-family: courier;">FileOpener::open</span> returns an object whose lifetime is owned by the caller from then on. Any object that implements the <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L516">PointerWrapper</a></span> trait can be returned, and we provide implementations for <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/boxed/struct.Box.html">Box&lt;T&gt;</a></span> and <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/sync/struct.Arc.html">Arc&lt;T&gt;</a></span>, so developers that use Rust's idiomatic heap-allocated or reference-counted pointers have no additional requirements.
<br /><br />
All associated functions in <span style="font-family: courier;">FileOperations</span> receive non-mutable references to <span style="font-family: courier;">self</span> (more about this below), except the <span style="font-family: courier;">release</span> function, which is the last function to be called and receives the plain object back (and its ownership with it). The <span style="font-family: courier;">release</span> implementation can then defer the object destruction by transferring its ownership elsewhere, or destroy it then; in the case of a reference-counted object, 'destruction' means decrementing the reference count (and actual object destruction if the count goes to zero).
<br /><br />
That is, we use Rust's ownership discipline when interacting with C code by handing the C portion ownership of a Rust object, allowing it to call functions implemented in Rust, then eventually giving ownership back. So as long as the C code is correct, the lifetime of Rust file objects work seamlessly as well, with the compiler enforcing correct lifetime management on the Rust side, for example: open cannot return stack-allocated pointers or heap-allocated objects containing pointers to the stack, <span style="font-family: courier;">ioctl</span>/<span style="font-family: courier;">read</span>/<span style="font-family: courier;">write</span> cannot free (or modify without synchronization) the contents of the object stored in <span style="font-family: courier;">filp-&gt;private_data</span>, etc.
  <br /><br />  </li>
  
  <li>Non-mutable references: the associated functions called between <span style="font-family: courier;">open</span> and <span style="font-family: courier;">release</span> all receive non-mutable references to <span style="font-family: courier;">self</span> because they can be called concurrently by multiple threads and Rust aliasing rules prohibit more than one mutable reference to an object at any given time.
<br /><br />
If a developer needs to modify some state (and they generally do), they can do so via <i><a href="https://doc.rust-lang.org/reference/interior-mutability.html">interior mutability</a></i>: mutable state can be wrapped in a <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/sync/mutex.rs#L29">Mutex&lt;T&gt;</a></span> or <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/sync/spinlock.rs#L45">SpinLock&lt;T&gt;</a></span> (or <a href="https://doc.rust-lang.org/core/sync/atomic/">atomics</a>) and safely modified through them.
<br /><br />
This prevents, at compile-time, bugs where a developer fails to acquire the appropriate lock when accessing a field (the field is inaccessible), or when a developer fails to wrap a field with a lock (the field is read-only).
<br /><br /></li>
    
  
    <li>Per-device state: when file instances need to share per-device state, which is a very common occurrence in drivers, they can do so safely in Rust. When a device is registered, a typed object can be provided and a non-mutable reference to it is provided when <span style="font-family: courier;">FileOperation::open</span> is called. In our example, the shared object is wrapped in <span style="font-family: courier;">Arc&lt;T&gt;</span>, so files can safely clone and hold on to a reference to them.
<br /><br />
The reason <span style="font-family: courier;">FileOperation</span> is its own trait (as opposed to, for example, <span style="font-family: courier;">open</span> being part of the <span style="font-family: courier;">FileOperations</span> trait) is to allow a single file implementation to be registered in different ways.
<br /><br />
This eliminates opportunities for developers to get the wrong data when trying to retrieve shared state. For example, in C when a <span style="font-family: courier;"><a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/miscdevice.h#L79">miscdevice</a></span> is registered, a pointer to it is available in <span style="font-family: courier;">filp-&gt;private_data</span>; when a <a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/cdev.h#L14"><span style="font-family: courier;">cdev</span></a> is registered, a pointer to it is available in <span style="font-family: courier;">inode-&gt;i_cdev</span>. These structs are usually embedded in an outer struct that contains the shared state, so developers usually use the <a href="https://elixir.bootlin.com/linux/v5.11.11/source/include/linux/kernel.h#L685"><span style="font-family: courier;">container_of</span></a> macro to recover the shared state. Rust encapsulates all of this and the potentially troublesome pointer casts in a safe abstraction.
      <br /><br /></li>
  
  <li>
    Static typing: we take advantage of Rust's support for generics to implement all of the above functions and types with static types. So there are no opportunities for a developer to convert an untyped variable or field to the wrong type. The C code in the table above has casts from an essentially untyped (<span style="font-family: courier;">void</span> *) pointer to the desired type at the start of each function: this is likely to work fine when first written, but may lead to bugs as the code evolves and assumptions change. Rust would catch any such mistakes at compile time.<br /><br />
  </li>
  
  <li>
    File operations: as we mentioned before, a developer needs to implement the <span style="font-family: courier;">FileOperations</span> trait to customize the behavior of their device. They do this with a block starting with <span style="font-family: courier;">impl FileOperations for Device</span>, where <span style="font-family: courier;">Device</span> is the type implementing the file behavior (<span style="font-family: courier;">FileState</span> in our example). Once inside this block, tools know that only a limited number of functions can be defined, so they can automatically insert the prototypes. (Personally, I use <span style="font-family: courier;"><a href="https://github.com/neovim/nvim-lspconfig">neovim</a></span> and the <a href="https://rust-analyzer.github.io/"><span style="font-family: courier;">rust-analyzer</span></a> LSP server.)
<br /><br />While we use this trait in Rust, the C portion of the kernel still requires an instance of <span style="font-family: courier;">struct file_operations</span>. The kernel crate automatically generates one from the trait implementation (and optionally the <span style="font-family: courier;"><a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L309">declare_file_operations</a></span> macro): although it has code to generate the correct struct, it is all <span style="font-family: courier;">const</span>, so evaluated at compile-time with zero runtime cost.
  </li>
</ul>
 
<h2>Ioctl handling</h2>
 
<p>
For a driver to provide a custom <a href="https://man7.org/linux/man-pages/man2/ioctl.2.html">ioctl</a> handler, it needs to implement the&nbsp;<span style="font-family: courier;">ioctl</span> function that is part of the <span style="font-family: courier;">FileOperations</span> trait, as exemplified in the table below.
</p><p>
 
</p><center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">ioctl</span></span>(
    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
    file: &amp;File,
    cmd: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> IoctlCommand
) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
    cmd.dispatch(<span class="hljs-keyword" style="font-weight: 700;">self</span>, file)
}
 
<span class="hljs-keyword" style="font-weight: 700;">impl</span> IoctlHandler <span class="hljs-keyword" style="font-weight: 700;">for</span> FileState {
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">read</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        _file: &amp;File,
        cmd: <span class="hljs-keyword" style="font-weight: 700;">u32</span>,
        writer: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrWriter
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
        <span class="hljs-keyword" style="font-weight: 700;">match</span> cmd {
            IOCTL_GET_READ_COUNT =&gt; {
                writer.write(
                    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>
                    .read_count
                    .load(Ordering::Relaxed))?;
                <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-number" style="color: #880000;">0</span>)
            }
            _ =&gt; <span class="hljs-literal" style="color: #78a960;">Err</span>(Error::EINVAL),
        }
    }
 
    <span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">write</span></span>(
        &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
        _file: &amp;File,
        cmd: <span class="hljs-keyword" style="font-weight: 700;">u32</span>,
        reader: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrReader
    ) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">i32</span>&gt; {
        <span class="hljs-keyword" style="font-weight: 700;">match</span> cmd {
            IOCTL_SET_READ_COUNT =&gt; {
                <span class="hljs-keyword" style="font-weight: 700;">self</span>
                .read_count
                .store(reader.read()?,
                       Ordering::Relaxed);
                <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-number" style="color: #880000;">0</span>)
            }
            _ =&gt; <span class="hljs-literal" style="color: #78a960;">Err</span>(Error::EINVAL),
        }
    }
}</pre>
</td>
  
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-meta" style="color: #1f7199;">#<span class="hljs-meta-keyword" style="font-weight: 700;">define</span> IOCTL_GET_READ_COUNT _IOR(<span class="hljs-meta-string" style="color: #4d99bf;">'c'</span>, 1, u64)</span>
<span class="hljs-meta" style="color: #1f7199;">#<span class="hljs-meta-keyword" style="font-weight: 700;">define</span> IOCTL_SET_READ_COUNT _IOW(<span class="hljs-meta-string" style="color: #4d99bf;">'c'</span>, 1, u64)</span>
 
<span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
<span class="hljs-keyword" style="font-weight: 700;">long</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_ioctl</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">int</span> cmd,
                     <span class="hljs-keyword" style="font-weight: 700;">unsigned</span> <span class="hljs-keyword" style="font-weight: 700;">long</span> arg)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    <span class="hljs-keyword" style="font-weight: 700;">void</span> __user *buffer = (<span class="hljs-keyword" style="font-weight: 700;">void</span> __user *)arg;
    u64 value;
 
    <span class="hljs-keyword" style="font-weight: 700;">switch</span> (cmd) {
    <span class="hljs-keyword" style="font-weight: 700;">case</span> IOCTL_GET_READ_COUNT:
        value = atomic64_read(&amp;state-&gt;read_count);
        <span class="hljs-keyword" style="font-weight: 700;">if</span> (copy_to_user(buffer, &amp;value, <span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(value)))
            <span class="hljs-keyword" style="font-weight: 700;">return</span> -EFAULT;
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
    <span class="hljs-keyword" style="font-weight: 700;">case</span> IOCTL_SET_READ_COUNT:
        <span class="hljs-keyword" style="font-weight: 700;">if</span> (copy_from_user(&amp;value, buffer, <span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(value)))
            <span class="hljs-keyword" style="font-weight: 700;">return</span> -EFAULT;
        atomic64_set(&amp;state-&gt;read_count, value);
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
    <span class="hljs-keyword" style="font-weight: 700;">default</span>:
        <span class="hljs-keyword" style="font-weight: 700;">return</span> -EINVAL;
    }
}</pre>
</td></tr></tbody></table>
</center>
  
  
<p>
Ioctl commands are standardized such that, given a command, we know whether a user buffer is provided, its intended use (read, write, both, none), and its size. In Rust, we provide a <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/file_operations.rs#L386">dispatcher</a> (accessible by calling <span style="font-family: courier;">cmd.dispatch</span>) that uses this information to automatically create user memory access helpers and pass them to the caller.
</p>
 
<p>
A driver is not <i>required</i> to use this though. If, for example, it doesn't use the standard ioctl encoding, Rust offers the flexibility of simply calling <span style="font-family: courier;">cmd.raw</span> to extract the raw arguments and using them to handle the ioctl (potentially with unsafe code, which will need to be justified).
</p>
 
<p>
However, if a driver implementation does use the standard dispatcher, it will benefit from not having to implement any unsafe code, and:
</p>
 
<ul style="text-align: left;">
  <li>The pointer to user memory is never a native pointer, so the developer cannot accidentally dereference it.
</li>
  <li>The types that allow the driver to read from user space only allow data to be read once, so we eliminate the risk of time-of-check to time-of-use (TOCTOU) bugs because when a driver needs to access data twice, it needs to copy it to kernel memory, where an attacker is not allowed to modify it. Excluding unsafe blocks, there is no way to introduce this class of bugs in Rust.
</li>
  <li>No accidental overflow of the user buffer: we'll never read or write past the end of the user buffer because this is enforced automatically based on the size encoded in the ioctl command. In our example above, the implementation of <span style="font-family: courier;">IOCTL_GET_READ_COUNT</span> only has access to an instance of <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/user_ptr.rs#L230"><span style="font-family: courier;">UserSlicePtrWriter</span></a>, which limits the number of writable bytes to <span style="font-family: courier;">sizeof(u64)</span> as encoded in the ioctl command.
</li>
  <li>No mixing of reads and writes: we'll never write buffers for ioctls that are only meant to read and never read buffers for ioctls that are only meant to write. This is enforced by read and write handlers only getting instances of <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/user_ptr.rs#L230"><span style="font-family: courier;">UserSlicePtrWriter</span></a> and <a href="https://github.com/Rust-for-Linux/linux/blob/150939383ef391e3cab72aec1beaa6d65fe80c5b/rust/kernel/user_ptr.rs#L158"><span style="font-family: courier;">UserSlicePtrReader</span></a> respectively.
</li>
</ul>
 
<p>
All of the above could potentially also be done in C, but it's very easy for developers to (likely unintentionally) break contracts that lead to unsafety; Rust requires <span style="font-family: courier;">unsafe</span> blocks for this, which should only be used in rare cases and brings additional scrutiny. Additionally, Rust offers the following:
</p>
 
<ul style="text-align: left;">
  <li>The types used to read and write user memory do not implement the <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/marker/trait.Send.html">Send</a></span> and <span style="font-family: courier;"><a href="https://doc.rust-lang.org/std/marker/trait.Sync.html">Sync</a></span> traits, which means that they (and pointers to them) are not safe to be used in another thread context. In Rust, if a driver developer attempted to write code that passed one of these objects to another thread (where it wouldn't be safe to use them because it isn't necessarily in the right memory manager context), they would get a compilation error.</li>
  <li>When calling <span style="font-family: courier;">IoctlCommand::dispatch</span>, one might understandably think that we need dynamic dispatching to reach the actual handler implementation (which would incur additional cost in comparison to C), but we don't. Our usage of generics will lead the compiler to monomorphize the function, which will result in static function calls that can even be inlined if the optimizer so chooses.
</li>
</ul>
 
 
<h2>Locking and condition variables</h2>
  
<p>We allow developers to use mutexes and spinlocks to provide interior mutability. In our example, we use a mutex to protect mutable data; in the tables below we show the data structures we use in C and Rust, and how we implement a wait until the count is nonzero so that we can satisfy a read:
  </p>
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">struct</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">SemaphoreInner</span></span> {
    count: <span class="hljs-keyword" style="font-weight: 700;">usize</span>,
    max_seen: <span class="hljs-keyword" style="font-weight: 700;">usize</span>,
}
 
<span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">struct</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">Semaphore</span></span> {
    changed: CondVar,
    inner: Mutex&lt;SemaphoreInner&gt;,
}
 
<span class="hljs-class"><span class="hljs-keyword" style="font-weight: 700;">struct</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">FileState</span></span> {
    read_count: AtomicU64,
    shared: Arc&lt;Semaphore&gt;,
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state {
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> kref ref;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> miscdevice miscdev;
    <span class="hljs-keyword" style="font-weight: 700;">wait_queue_head_t</span> changed;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> mutex mutex;
    <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count;
    <span class="hljs-keyword" style="font-weight: 700;">size_t</span> max_seen;
};
 
<span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state {
    <span class="hljs-keyword" style="font-weight: 700;">atomic64_t</span> read_count;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared;
};</pre>
</td></tr></tbody></table>
</center>
 
 
 
 
 
 
 
 
 
 
 <br />
 
 
 
 
 
 
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">consume</span></span>(&amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>) -&gt; KernelResult {
    <span class="hljs-keyword" style="font-weight: 700;">let</span> <span class="hljs-keyword" style="font-weight: 700;">mut</span> inner = <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.inner.lock();
    <span class="hljs-keyword" style="font-weight: 700;">while</span> inner.count == <span class="hljs-number" style="color: #880000;">0</span> {
        <span class="hljs-keyword" style="font-weight: 700;">if</span> <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.changed.wait(&amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> inner) {
            <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-literal" style="color: #78a960;">Err</span>(Error::EINTR);
        }
    }
    inner.count -= <span class="hljs-number" style="color: #880000;">1</span>;
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(())
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span> <span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_consume</span><span class="hljs-params">(
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *state)</span>
</span>{
    DEFINE_WAIT(wait);
 
    mutex_lock(&amp;state-&gt;mutex);
    <span class="hljs-keyword" style="font-weight: 700;">while</span> (state-&gt;count == <span class="hljs-number" style="color: #880000;">0</span>) {
        prepare_to_wait(&amp;state-&gt;changed, &amp;wait,
                        TASK_INTERRUPTIBLE);
        mutex_unlock(&amp;state-&gt;mutex);
        schedule();
        finish_wait(&amp;state-&gt;changed, &amp;wait);
        <span class="hljs-keyword" style="font-weight: 700;">if</span> (signal_pending(current))
            <span class="hljs-keyword" style="font-weight: 700;">return</span> -EINTR;
        mutex_lock(&amp;state-&gt;mutex);
    }
 
    state-&gt;count--;
    mutex_unlock(&amp;state-&gt;mutex);
 
    <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
}</pre>
</td></tr></tbody></table>
</center>
 
<p>
We note that such waits are not uncommon in the existing C code, for example, a <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/fs/pipe.c#L1053">pipe waiting</a> for a "partner" to write, a <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/net/unix/af_unix.c#L2189">unix-domain socket waiting</a> for data, an <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/fs/inode.c#L829">inode search waiting</a> for completion of a delete, or a <a href="https://elixir.bootlin.com/linux/v5.12-rc6/source/kernel/umh.c#L249">user-mode helper waiting</a> for state change.</p>
 
<p>
The following are benefits from the Rust implementation:
</p>
 
 
<ul>
  <li>The <span style="font-family: courier;">Semaphore::inner</span> field is only accessible when the lock is held, through the guard returned by the <span style="font-family: courier;">lock</span> function. So developers cannot accidentally read or write protected data without locking it first. In the C example above, <span style="font-family: courier;">count</span> and <span style="font-family: courier;">max_seen</span> in <span style="font-family: courier;">semaphore_state</span> are protected by <span style="font-family: courier;">mutex</span>, but there is no enforcement that the lock is held while they're accessed.
</li>
  <li>Resource Acquisition Is Initialization (RAII): the lock is unlocked automatically when the guard (<span style="font-family: courier;">inner</span> in this case) goes out of scope. This ensures that locks are always unlocked: if the developer needs to keep a lock locked, they can keep the guard alive, for example, by returning the guard itself; conversely, if they need to unlock before the end of the scope, they can explicitly do it by calling the <span style="font-family: courier;">drop</span> function.
</li>
  <li>Developers can use any lock that implements the <span style="font-family: courier;">Lock</span> trait, which includes <span style="font-family: courier;">Mutex</span> and <span style="font-family: courier;">SpinLock</span>, at no additional runtime cost when compared to a C implementation. Other synchronization constructs, including condition variables, also work transparently and with zero additional run-time cost.
</li>
  <li>Rust implements condition variables using kernel wait queues. This allows developers to benefit from atomic release of the lock and putting the thread to sleep without having to reason about low-level kernel scheduler functions. In the C example above, <span style="font-family: courier;">semaphore_consume</span> is a mix of semaphore logic and subtle Linux scheduling: for example, the code is incorrect if <span style="font-family: courier;">mutex_unlock</span> is called before <span style="font-family: courier;">prepare_to_wait</span> because it may result in a wake up being missed.
</li>
  <li>No unsynchronized access: as we mentioned before, variables shared by multiple threads/CPUs must be read-only, with interior mutability being the solution for cases when mutability is needed. In addition to the example with locks above, the ioctl example in the previous section also has an example of using an atomic variable; Rust also requires developers to specify how memory is to <a href="https://doc.rust-lang.org/core/sync/atomic/enum.Ordering.html">be synchronized</a> by atomic accesses. In the C part of the example, we happen to use <span style="font-family: courier;">atomic64_t</span>, but the compiler won't alert a developer to this need.
</li>
 
</ul>
 
<h2>Error handling and control flow</h2>
 
<p>
In the tables below, we show how <span style="font-family: courier;">open</span>, <span style="font-family: courier;">read</span>, and <span style="font-family: courier;">write</span> are implemented in our example driver:
</p>
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">read</span></span>(
    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
    _: &amp;File,
    data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrWriter,
    offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
   <span class="hljs-keyword" style="font-weight: 700;">if</span> data.is_empty() <span class="hljs-params">||</span> offset &gt; <span class="hljs-number" style="color: #880000;">0</span> {
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hl js-number" style="color: #880000;">0</span>);
    }
 
    <span class="hljs-keyword" style="font-weight: 700;">self</span>.consume()?;
    data.write_slice(&amp;[<span class="hljs-number" style="color: #880000;">0u8</span>; <span class="hljs-number" style="color: #880000;">1</span>])?;
    <span class="hljs-keyword" style="font-weight: 700;">self</span>.read_count.fetch_add(<span class="hljs-number" style="color: #880000;">1</span>, Ordering::Relaxed);
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-number" style="color: #880000;">1</span>)
}
 
</pre>
</td>
  
  <td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_read</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                       <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                       <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    <span class="hljs-keyword" style="font-weight: 700;">char</span> c = <span class="hljs-number" style="color: #880000;">0</span>;
    <span class="hljs-keyword" style="font-weight: 700;">int</span> ret;
 
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (count == <span class="hljs-number" style="color: #880000;">0</span> || *ppos &gt; <span class="hljs-number" style="color: #880000;">0</span>)
        <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
 
    ret = semaphore_consume(state-&gt;shared);
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (ret)
        <span class="hljs-keyword" style="font-weight: 700;">return</span> ret;
 
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (copy_to_user(buffer, &amp;c, <span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(c)))
        <span class="hljs-keyword" style="font-weight: 700;">return</span> -EFAULT;
 
    atomic64_add(<span class="hljs-number" style="color: #880000;">1</span>, &amp;state-&gt;read_count);
    *ppos += <span class="hljs-number" style="color: #880000;">1</span>;
    <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">1</span>;
}</pre> 
</td>
  
  </tr></tbody></table>
</center>
 
 
 
 
 <br />
 
 
 
 
 
 
 
 
 
 
 
 
 
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">write</span></span>(
    &amp;<span class="hljs-keyword" style="font-weight: 700;">self</span>,
    data: &amp;<span class="hljs-keyword" style="font-weight: 700;">mut</span> UserSlicePtrReader,
    _offset: <span class="hljs-keyword" style="font-weight: 700;">u64</span>
) -&gt; KernelResult&lt;<span class="hljs-keyword" style="font-weight: 700;">usize</span>&gt; {
   {
        <span class="hljs-keyword" style="font-weight: 700;">let</span> <span class="hljs-keyword" style="font-weight: 700;">mut</span> inner = <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.inner.lock();
        inner.count = inner.count.saturating_add(data.len());
        <span class="hljs-keyword" style="font-weight: 700;">if</span> inner.count &gt; inner.max_seen {
            inner.max_seen = inner.count;
        }
    }
 
    <span class="hljs-keyword" style="font-weight: 700;">self</span>.shared.changed.notify_all();
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(data.len())
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span>
ssize_t <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_write</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp,
                        <span class="hljs-keyword" style="font-weight: 700;">const</span> <span class="hljs-keyword" style="font-weight: 700;">char</span> __user *buffer,
                        <span class="hljs-keyword" style="font-weight: 700;">size_t</span> count, <span class="hljs-keyword" style="font-weight: 700;">loff_t</span> *ppos)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state = filp-&gt;private_data;
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared = state-&gt;shared;
 
    mutex_lock(&amp;shared-&gt;mutex);
    shared-&gt;count += count;
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (shared-&gt;count &lt; count)
        shared-&gt;count = SIZE_MAX;
 
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (shared-&gt;count &gt; shared-&gt;max_seen)
        shared-&gt;max_seen = shared-&gt;count;
 
    mutex_unlock(&amp;shared-&gt;mutex);
 
    wake_up_all(&amp;shared-&gt;changed);
    <span class="hljs-keyword" style="font-weight: 700;">return</span> count;
}</pre>
</td></tr></tbody></table>
</center>
 
 
 
 
 
 
  <br />
 
 
 
 
 
 
 
 
 
 
 
 
<center>
<table style="border-collapse: collapse;">
<tbody><tr>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">fn</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">open</span></span>(
    shared: &amp;Arc&lt;Semaphore&gt;
) -&gt; KernelResult&lt;<span class="hljs-built_in" style="color: #397300;">Box</span>&lt;<span class="hljs-keyword" style="font-weight: 700;">Self</span>&gt;&gt; {
    <span class="hljs-literal" style="color: #78a960;">Ok</span>(<span class="hljs-built_in" style="color: #397300;">Box</span>::try_new(<span class="hljs-keyword" style="font-weight: 700;">Self</span> {
        read_count: AtomicU64::new(<span class="hljs-number" style="color: #880000;">0</span>),
        shared: shared.clone(),
    })?)
}</pre>
</td>
<td style="background: rgb(240, 240, 240); border: 1px solid black; vertical-align: top;">
<pre class="hljs" style="background: rgb(240, 240, 240); border: none; color: #444444; display: block; font-size: x-small; line-height: 125%; overflow-x: auto; padding: 0.5em;"><span class="hljs-function"><span class="hljs-keyword" style="font-weight: 700;">static</span> 
<span class="hljs-keyword" style="font-weight: 700;">int</span> <span class="hljs-title" style="color: #880000; font-weight: 700;">semaphore_open</span><span class="hljs-params">(<span class="hljs-keyword" style="font-weight: 700;">struct</span> inode *nodp,
                   <span class="hljs-keyword" style="font-weight: 700;">struct</span> file *filp)</span>
</span>{
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state *shared =
        container_of(filp-&gt;private_data,
                     <span class="hljs-keyword" style="font-weight: 700;">struct</span> semaphore_state,
                     miscdev);
    <span class="hljs-keyword" style="font-weight: 700;">struct</span> file_state *state;
 
    state = kzalloc(<span class="hljs-keyword" style="font-weight: 700;">sizeof</span>(*state), GFP_KERNEL);
    <span class="hljs-keyword" style="font-weight: 700;">if</span> (!state)
        <span class="hljs-keyword" style="font-weight: 700;">return</span> -ENOMEM;
 
    kref_get(&amp;shared-&gt;ref);
    state-&gt;shared = shared;
    atomic64_set(&amp;state-&gt;read_count, <span class="hljs-number" style="color: #880000;">0</span>);
 
    filp-&gt;private_data = state;
 
    <span class="hljs-keyword" style="font-weight: 700;">return</span> <span class="hljs-number" style="color: #880000;">0</span>;
}</pre>
</td></tr></tbody></table>
</center>
 
<p>
They illustrate other benefits brought by Rust:
</p>
 
<ul>
  <li>The <span style="font-family: courier;">?</span> operator: it is used by the Rust <span style="font-family: courier;">open</span> and <span style="font-family: courier;">read</span> implementations to do error handling implicitly; the developer can focus on the semaphore logic, the resulting code being quite small and readable. The C versions have error-handling noise that can make them less readable.
</li>
  <li>Required initialization: Rust requires all fields of a struct to be initialized on construction, so the developer can never accidentally fail to initialize a field; C offers no such facility. In our <span style="font-family: courier;">open</span> example above, the developer of the C version could easily fail to call <span style="font-family: courier;">kref_get</span> (even though all fields would have been initialized); in Rust, the user is required to call <span style="font-family: courier;">clone</span> (which increments the ref count), otherwise they get a compilation error.
</li>
  <li>RAII scoping: the Rust write implementation uses a statement block to control when <span style="font-family: courier;">inner</span> goes out of scope and therefore the lock is released.
</li>
  <li>Integer overflow behavior: Rust encourages developers to always consider how overflows should be handled. In our <span style="font-family: courier;">write</span> example, we want a saturating one so that we don't end up with a zero value when adding to our semaphore. In C, we need to manually check for overflows, there is no additional support from the compiler.
</li>
</ul>
 
<h1>What's next</h1>
 
<p>
The examples above are only a small part of the whole project. We hope it gives readers a glimpse of the kinds of benefits that Rust brings. At the moment we have nearly all generic kernel functionality needed by Binder neatly wrapped in safe Rust abstractions, so we are in the process of <a href="https://lore.kernel.org/lkml/20210414184604.23473-1-ojeda@kernel.org/T/#mb5e524dae9d5a5815c6e68eb36b9bde4e87c861d">gathering feedback from the broader Linux kernel community</a> with the intent of upstreaming the existing Rust support.
</p>
 
<p>
We also continue to make progress on our Binder prototype, implement additional abstractions, and smooth out some rough edges. This is an exciting time and a rare opportunity to potentially influence how the Linux kernel is developed, as well as inform the evolution of the Rust language. We invite those interested to join us in <a href="https://github.com/Rust-for-Linux/linux">Rust for Linux</a> and attend our planned talk at <a href="https://linuxplumbersconf.org/">Linux Plumbers Conference 2021</a>!
</p>
 
<p><i><br /></i></p><p><i>
Thanks Nick Desaulniers, Kees Cook, and Adrian Taylor for contributions to this post. Special thanks to Jeff Vander Stoep for contributions and editing, and to Greg Kroah-Hartman for reviewing and contributing to the code examples.
</i></p>
<span itemprop='author' itemscope='itemscope' itemtype='http://schema.org/Person'>
<meta content='https://plus.google.com/116899029375914044550' itemprop='url'/>
</span>
</noscript>
</div>
</div>
<div class='share'>
<span class='twitter-custom social-wrapper' data-href='http://twitter.com/share?text=Google Online Security Blog: Rust in the Linux kernel&url=https://security.googleblog.com/2021/04/rust-in-linux-kernel.html&via=google'>
<img alt='Share on Twitter' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_twitter_black_24dp.png' width='24'/>
</span>
<span class='fb-custom social-wrapper' data-href='https://www.facebook.com/sharer.php?u=https://security.googleblog.com/2021/04/rust-in-linux-kernel.html'>
<img alt='Share on Facebook' height='24' src='https://www.gstatic.com/images/icons/material/system/2x/post_facebook_black_24dp.png' width='24'/>
</span>
</div>
<div class='comment-container'>
<i class='comment-img material-icons'>
                            &#57529;
                          </i>
<span class='cmt_count_iframe_holder' data-count='0' data-onclick='javascript:window.open(this.href, "bloggerPopup", "toolbar=0,location=0,statusbar=1,menubar=0,scrollbars=yes,width=640,height=500"); return false;' data-post-url='https://security.googleblog.com/2021/04/rust-in-linux-kernel.html' data-url='https://security.googleblog.com/2021/04/rust-in-linux-kernel.html' style='color: #4184F3;'></span>
</div>
<div class='post-footer'>
<div class='cmt_iframe_holder' data-href='https://security.googleblog.com/2021/04/rust-in-linux-kernel.html' data-viewtype='FILTERED_POSTMOD'></div>
<a href='https://plus.google.com/112374322230920073195' rel='author' style='display:none;'>
                        Google
                      </a>
<div class='label-footer'>
<span class='labels-caption'>
Labels:
</span>
<span class='labels'>
<a class='label' href='https://security.googleblog.com/search/label/android%20security' rel='tag'>
android security
</a>

                                ,
                              
<a class='label' href='https://security.googleblog.com/search/label/rust' rel='tag'>
rust
</a>
</span>
</div>
</div>
</div>
<div class='blog-pager' id='blog-pager'>
<a class='home-link' href='https://security.googleblog.com/'>
<i class='material-icons'>
                      &#59530;
                    </i>
</a>
<i class='material-icons disabled'>
                      &#58820;
                    </i>
<span id='blog-pager-older-link'>
<a class='blog-pager-older-link' href='https://security.googleblog.com/search?updated-max=2021-04-14T16:27:00-07:00&max-results=10' id='Blog1_blog-pager-older-link' title='Older Posts'>
<i class='material-icons'>
                          &#58824;
                        </i>
</a>
</span>
</div>
<div class='clear'></div>
</div></div>
</div>
</div>
<div class='col-right'>
<div class='section' id='sidebar-top'><div class='widget HTML' data-version='1' id='HTML8'>
<div class='widget-content'>
<div class='searchBox'>
<input type='text' title='Search This Blog' placeholder='Search blog ...' />
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("HTML8"));' rel='nofollow' target='configHTML8' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
<div id='aside'>
<div class='section' id='sidebar'><div class='widget Label' data-version='1' id='Label1'>
<div class='tab'>
<img class='sidebar-icon' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAYpJREFUeNrs2aFuwzAQBmAvKRkMKRjZA4QMDJaWFgyMjuzFRg37DIUlA3uFkoGQSaWzJU+tpri5O9+l/zSfdFJlpe59yTmyVedq1PjfcZMZ70NuQnaF8w8htyE/rABtpviXkLcK88c5HhLkMBfgVan43zfFBNGMjHVGT/s55KP2pAvidbGHd+nzKt1RKSLG3rKF1iPFv6UWiPke8i7kEqGdGsI1O+LYVdqJAjgirwkKYD0ytkJBUNbAMvX8V3q9PhUsYvU1sWD8SO/sQvx2ahxOiNoJCSBCoAHYCEQAC4EKICOQASQEOmAS8RcAFxFN5hiIiugpgC3wk9hQAHH/70EBHXUN7IER5EWMiBgo2+nzOKQv9SCAeEM/OQAkhE/ncccFICB87qzQMia5FsJfOui0zMnmRvipU1ormHQuxGTxUsAcCFLxJQBLBLn4UoAFglW8BkATwS5eC6CBEBWvCShBiIvXBkgQRcVbADiI4uKtABSESvGWgB9EzHt3+tNwyO0qa9SoIYtvAQYAqDJhaWWeMecAAAAASUVORK5CYII='/>
<h2>
Labels
</h2>
<i class='material-icons arrow'>
                      &#58821;
                    </i>
</div>
<div class='widget-content list-label-widget-content'>
<ul>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/%23sharethemicincyber'>
#sharethemicincyber
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/android'>
android
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/android%20security'>
android security
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/android%20tr'>
android tr
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/app%20security'>
app security
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/big%20data'>
big data
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/biometrics'>
biometrics
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/blackhat'>
blackhat
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/chrome'>
chrome
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/chrome%20security'>
chrome security
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/diversity'>
diversity
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/encryption'>
encryption
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/federated%20learning'>
federated learning
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/fuzzing'>
fuzzing
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/Gboard'>
Gboard
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/google%20play'>
google play
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/google%20play%20protect'>
google play protect
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/Open%20Source'>
Open Source
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/pha%20family%20highlights'>
pha family highlights
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/privacy'>
privacy
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/Rowhammer'>
Rowhammer
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/rust'>
rust
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/Security'>
Security
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/spyware'>
spyware
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/targeted%20spyware'>
targeted spyware
</a>
</li>
<li>
<a dir='ltr' href='https://security.googleblog.com/search/label/vulnerabilities'>
vulnerabilities
</a>
</li>
</ul>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("Label1"));' rel='nofollow' target='configLabel1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget BlogArchive' data-version='1' id='BlogArchive1'>
<div class='tab'>
<i class='material-icons icon'>
                      &#58055;
                    </i>
<h2>
Archive
</h2>
<i class='material-icons arrow'>
                      &#58821;
                    </i>
</div>
<div class='widget-content'>
<div id='ArchiveList'>
<div id='BlogArchive1_ArchiveList'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy toggle-open'>
<i class='material-icons'>
                        &#58823;
                      </i>
                      &#160;
                      
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2021/'>
2021
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate expanded'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2021/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2021/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2021/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2021/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2021/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2021/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2020/'>
2020
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2020/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2019/'>
2019
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2019/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2018/'>
2018
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2018/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2017/'>
2017
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2017/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2016/'>
2016
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2016/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2015/'>
2015
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2015/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2014/'>
2014
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2014/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2013/'>
2013
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2013/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2012/'>
2012
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2012/01/'>
Jan
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2011/'>
2011
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2011/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2010/'>
2010
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/04/'>
Apr
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2010/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2009/'>
2009
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2009/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2009/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2009/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2009/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2009/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2009/03/'>
Mar
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2008/'>
2008
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2008/12/'>
Dec
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2008/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2008/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2008/08/'>
Aug
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2008/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2008/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2008/02/'>
Feb
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class='intervalToggle'>
<span class='new-toggle' href='javascript:void(0)'>
<i class='material-icons arrow'>
                    &#58821;
                  </i>
</span>
<a class='toggle' href='javascript:void(0)' style='display: none'>
<span class='zippy'>
<i class='material-icons'>
                        &#58821;
                      </i>
                      &#160;
                    
</span>
</a>
<a class='post-count-link' href='https://security.googleblog.com/2007/'>
2007
</a>
</div>
<div class='items'>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2007/11/'>
Nov
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2007/10/'>
Oct
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2007/09/'>
Sep
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2007/07/'>
Jul
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2007/06/'>
Jun
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
<ul class='hierarchy'>
<li class='archivedate collapsed'>
<div class=''>
<a class='post-count-link' href='https://security.googleblog.com/2007/05/'>
May
</a>
</div>
<div class='items'>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' rel='nofollow' target='configBlogArchive1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div>
</div><div class='widget HTML' data-version='1' id='HTML6'>
<div class='widget-content'>
<a href="https://googleonlinesecurity.blogspot.com/atom.xml">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAihJREFUeNrsWa9Pw0AU7viRMDFRBAkzJDMIBIhJJhCzk7NILIqMv4AEhdz+BCY3OYssAlGBoAJREpZwAlHEBO8lr8nSvNeVbu1dyX3JlzTrXfa+u/e9d7c5joWFhYVO1Fa8PwH2gK6m+BRwAvSlAdsrgr8E1jUuMH73GTAEzrkBWymTewZlihhLmgDXIAFuHgGVQOUF7OSYM1p6PgTuA1vAZlUEvAnPdapcMY0VICECekQ0XRfYrqoHsAGNgXfAoMomRiFDEhOZkkL3S88hMaB2LwXp0bj+ps2edpToZpjfoIDQtBeU+xjoDzP2G/gCPKZ5f8WsCAFJoJgOCcFdWSTeL9YQMSvTA1h9BkI5jaiXhLpSCL/8mVZY0UpyJ9ZdOkniu1dmJ96BpzQu9w6s28gcOq9j6pwLdR8/36NK5CQKwJSMrb2MhhSglBpt4UjsrdsnNu0B3J0HCozbCc4TjyY2srEgos/4RQljCzNxl4ireQD8FOq+T+W0mTB2g7njhlR+Sy2jsXFvU658U8YTbeaGpdIu7mWkEAq5ZtIjIhFZdtfX7QHckSvB2B6zC3VdAkZk0kAQwaXTk/CzTXK3wjIExCs6ZJpTnE4uY1KV+KzFzA3KTiFPENHJkOPcsfpLhwe4btoSuvUqAR+6TOxlCE6ZfKUsJLgsqGW8OpqAGx2X+sLxrwUog+JUeQRMDBIwyXOcnlPtPnL0/UsT/8LnOxYWFhZG4leAAQAAQHEaYuzHbAAAAABJRU5ErkJggg==" class="sidebar-icon" />
<h2>Feed</h2>
</a>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("HTML6"));' rel='nofollow' target='configHTML6' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
<div class='section' id='sidebar-bottom'><div class='widget HTML' data-version='1' id='HTML5'>
<div class='widget-content'>
<div class='followgooglewrapper'>
  <script src="https://apis.google.com/js/plusone.js"></script>
<div class="g-ytsubscribe" data-channel="Google" data-layout="full"></div>
</div>

		   <div class="share followgooglewrapper">
<button data-href="https://twitter.com/intent/follow?original_referer=http://googleonlinesecurity.blogspot.in/&amp;screen_name=google" onclick='sharingPopup(this);' id='twitter-share'><span class="twitter-follow">Follow @google</span></button>
<script>     
      function sharingPopup (button) {
      var url = button.getAttribute("data-href");
	    window.open(
 url,'popUpWindow','height=500,width=500,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes');
          }
    </script>
</div>
<div class="fb-follow-button">
     <a href="https://www.facebook.com/google" target="_blank"><img class="fb-follow" src="https://4.bp.blogspot.com/-x8BajdAYuGk/WKrvLsxVn-I/AAAAAAAATY8/5yw6fVqqJn0qaYz9JK2EMkfXcMdFDUn-wCK4B/s1600/facebook-logo.png" />Follow</a>
</div>
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("HTML5"));' rel='nofollow' target='configHTML5' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div><div class='widget HTML' data-version='1' id='HTML1'>
<div class='widget-content'>
Give us feedback in our <a href="https://support.google.com/bin/static.py?hl=en&page=portal_groups.cs">Product Forums</a>.
</div>
<div class='clear'></div>
<span class='widget-item-control'>
<span class='item-control blog-admin'>
<a class='quickedit' onclick='return _WidgetManager._PopupConfig(document.getElementById("HTML1"));' rel='nofollow' target='configHTML1' title='Edit'>
<img alt='' height='18' src='https://resources.blogblog.com/img/icon18_wrench_allbkg.png' width='18'/>
</a>
</span>
</span>
<div class='clear'></div>
</div></div>
</div>
</div>
<div style='clear:both;'></div>
</div>
<!-- Footer -->
<div class='google-footer-outer loading'>
<div id='google-footer'>
<a href='//www.google.com/'>
<img class='google-logo-dark' height='36' src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALgAAABICAYAAABFoT/eAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAACLVJREFUeNrsXd+L20YQ3vOprdLqiMXFXE2qB7dcwEcTSB7ykIc+9A/PQx/yEMq1TWhNuYIpJriNr7XpmZ5IxFEvmW2EKs3Ornb1w50PxIFP0kiz387OzM6uhGAwGAxGP3Ho+f7x7ri1O7LdccPqZjSNA4dEHsLfaHcEFedJom93x9Xu2OyOFTcBo6sED3fHZHeMEELrkAHJF0B8Rr+gDFsZ5n0luLTQ95AXs4W06D/tjpR50xtM4CjD0y48YGB4rnyZxNOzyA7zBHr+nLnDaJLg0mo/ALekCasg3Z4XbM0ZdTEgnDPeHY8bIne+Qz2GvwyGNwsuyT218KWvIIBMcwGpLiipcolecjMxfBDchNyS1EvxLiOSIecp31q6IJ/C3yrIrMqMm4jhg+AxkdwbIO3aUO4KjqqMjCT3uaazMBhWBJfuxH3CtRfiXf66DhSRZWbmlMnNaILgZxrXJQO/eO3wORZwvwm4JUxuhheCjzVBYAbW1ces45YDSoZrFNOEE835M8FT6oyeEnws8Fz3QnBxFKPHBMem4GU+m6fPGb0leCTwWcM5B36MPgeZI01gudyDdw3hPeXfo8L/rmCUWnuMMdqUL2WqWeRbhf+twfVsO7YagZGNC79fw7OthEVtkiJ4jJzTd3KPwf3CRqhhiTu23AP5sl0/0xiwISQXpNwLIJK87mHF+U8ddzzdmgKlGzlPYjyxGJQouIhNT4k9AqWEFkqfguIvagTWbcq3KW1WE3xS3m8NtA9WS451xofwjKT5kkDoK/b6mDk5FfXr1lWDL4BofZEv2/SRsK/EHGlGdBdu8QNRb8HMCFwt7Yy3DDI/QP7fx5z3VLhdlJEIs4rKNuXXJXdxZPdB7kfCzWqwCO4V1LHgLjInX3tQ1KzCR52Cz+vDj1dydeRuS74rcvs2Pi6fT5H8OaaUQPQPYcWwRSGXyhhscn5dpAnEFMkuEZetbfkTAnlSuH4DxisE+aMGeJAQ3lFl7C4LJE6QWCaCd583ORQ1jYAwjFctal7nOs2ZZvicwvlZx+RHGrcoAwKUVX8uwcc/9TT65INeDOr5shL9LDRB6QTeIy3zwfdh3WOi6axLCEhSjXU7F3h6LqggUtvyJxpynwu8tDkD98fXApOxRj8zoZ9MnGveYVIVZKaGrkBXCY65BCYNN9NkjpKOyQ81Q79JgdxS+Jn3SDTEXRI7SWzaiSTB32oI3nU3BvMfM0urhOVYgwKhuiAfc4tM07wXwm1ZRoQYSl2NUwiu01fEAHVcpixd745FvVz4dzUUc0o8rwoLy8ZSwU6CyFx1RP5II9+1bFPEFs9HWbNLiimDXE+vCm7u1CS47cofzD3aEhVY57mxRo5zlqdt+RFC1JUH2S7bcVXg4liTMakaBZZVxiTICRoivcn1sEUBlk24JmaC6kxUbYmWoqvyfck2xZGGnDFYa9MMzkYQ1ijkCX6qidybrgePiQ0QIQqoi6qRLeqQfIoRsEHaQJLBdHOnLGetSdm/IPcymJuS1PAnbQPH0MOw/39C1vL11DiLOqIsbDI8QcHvGiLnySi2qUXBicaqUSxN5LEB0g7Jt3ENXJLPJ5S1tnaZBoWbpRqrmjRE7qHmpSmNHdQcYrEUadoh+TbBnc9ri7iycI1kzPeNcLDIvbiqXpez9Tmdq6zGREPuzECBoxrPMiI2WtvyNwhJba2wy3JZ6ky5dD1lSvmZS3e4SPA1wcf1VTFHKX+cGwZzdUYcqpvUtvwrD/InDttVlyZeAKlNN5MKbAiurHhKIPlUuJvlTCCiDjSKSCsUmCFWbGLZwCESfK07JB8LvMYWVtw0D00JEHV8Mq2HkqPbE0oHLvvK2g0o8ETg+4cfwTlZDT9JDoWygu4uQQE/ivIvtcnfPkaCqhiupz7jWOAzqL/vjtcdkv9G4MVMt+EaylfuImiPAXEUjRF3pjjaHiPPZ6If9TGGAO4ZY0am6jOCb+DQ+ZCqLkIpOIPrdNfIjnFPY6nyFut7TS/fanrziOBOKMupKw94WaLMtuVnSFt9CPrWWdJE6PeltCX432DEBoh+5Dv8RRhdis8YAv9uyq4/JAwtlEApgBe9Cw9xDD3tdk4Jn0MDfiHwPHcRPxBePCMER3GuIx7kGlv9fkZ4V9lolx2Uv4X7hEj7qJ3LDoAMGbTRMRibu4L2xQ8bgt8AyU+Q+x7nYrvDnH4iuO5LxKsYwPVbkPMvKF9Zky9wXzRfVWizi62r9X5VHf55h+WHhDjGBZ4WRhyTr6z5SlCoLMxLSpBZFsQ9F80uQFbF/6aFWi+Ev51vzzsuX+msyzuQXXjUz8zEBy+zpq9yweXAoxJW4JbYrDS6gYDqGHxPl+TKeiBfxj9/EBIElPYeOA4y8/qRQfknjvSzgRgtq0Pw/M1eQeMdOSb2Bnrhr6Led+1vcp2x7oTFHMnedFW+Ivlty062BUt74oHgSj+vHepnhunn0JJAMtBZgDI/qmGtMujRv8DDpo47zBJ8UtPOuAR/7rKn8t9AJ0tBdmBAmJ/Fu71yxp4I3qh+DhyRqbi5Y1ShVPlSb8X7bRNcfgZFl+WRGYo7uecrWq1r8X5bhmzP5OdlDwsGRm1suSxkg5rYm7ConyGQ3Zl+DgSD8V/kPwrWBMG9YcBtyShBnTLdTiHgttw7qAW7cqh/ZnmPKr/6ignOaKsdyxbsToT5UkPsW00bJjijDXficcX/JsLs6w2BwGtherdckH3w/kNXRPVI0OqJQoHX42/66IMfMj/2huRjxIidgKV/W0JS+bsstDoTeAHcrI8E5zTh/sDkqxL5rZup55/3USlswfcHf4IrQplVDgW9XFlOqnwr6pVPMMEZTuC60EttvdzbLbaZ4PsFVa3nohhO+vW+yn/ZB2fUhpysmQrzBcTSai9EszuZMcEZ1lCFVrp9zGXhm69iLyY4oxFIa178lPe12I/P2DAYDAaDwWAwGAwGg8FgMBgMBoPBYDD2Cf8IMADDRGoQTe+E9AAAAABJRU5ErkJggg==' style='margin-top: -16px;' width='92'/>
</a>
<ul>
<li>
<a href='//www.google.com/'>
              Google
            </a>
</li>
<li>
<a href='//www.google.com/policies/privacy/'>
              Privacy
            </a>
</li>
<li>
<a href='//www.google.com/policies/terms/'>
              Terms
            </a>
</li>
</ul>
</div>
</div>
<script type='text/javascript'>
      //<![CDATA[
      // Social sharing popups.
      var postEl = document.getElementsByClassName('social-wrapper');
      var postCount = postEl.length;
      for(i=0; i<postCount;i++){
        postEl[i].addEventListener("click", function(event){
          var postUrl = this.getAttribute("data-href");
          window.open(
            postUrl,'popUpWindow','height=500,width=500,left=10,top=10,resizable=yes,scrollbars=yes,toolbar=yes,menubar=no,location=no,directories=no,status=yes');
        });}
      //]]>
    </script>
<script type='text/javascript'>
      //<![CDATA[
      var BreakpointHandler = function() {
        this.initted = false;
        this.isHomePage = false;
        this.isMobile = false;
      };
      BreakpointHandler.prototype.finalizeSummary = function(summaryHtml, lastNode) {
        // Use $.trim for IE8 compatibility
        summaryHtml = $.trim(summaryHtml).replace(/(<br>|\s)+$/,'');
        if (lastNode.nodeType == 3) {
          var lastChar = summaryHtml.slice(-1);
          if (!lastChar.match(/[.”"?]/)) {
            if (!lastChar.match(/[A-Za-z]/)) {
              summaryHtml = summaryHtml.slice(0, -1);
            }
            summaryHtml += ' ...';
          }
        } else if (lastNode.nodeType == 1 && (lastNode.nodeName == 'I' || lastNode.nodeName == 'A')) {
          summaryHtml += ' ...';
        }
        return summaryHtml;
      };
      BreakpointHandler.prototype.generateSummaryFromContent = function(content, numWords) {
        var seenWords = 0;
        var summaryHtml = '';
        for (var i=0; i < content.childNodes.length; i++) {
          var node = content.childNodes[i];
          var nodeText;
          if (node.nodeType == 1) {
            if (node.hasAttribute('data-about-pullquote')) {
              continue;
            }
            nodeText = node.textContent;
            if (nodeText === undefined) {
              // innerText for IE8
              nodeText = node.innerText;
            }
            if (node.nodeName == 'DIV' || node.nodeName == 'B') {
              // Don't end early if we haven't seen enough words.
              if (seenWords < 10) {
                continue;
              }
              if (i > 0) {
                summaryHtml = this.finalizeSummary(summaryHtml, content.childNodes[i-1]);
              }
              break;
            }
            summaryHtml += node.outerHTML;
          } else if (node.nodeType == 3) {
            nodeText = node.nodeValue;
            summaryHtml += nodeText + ' ';
          }
          var words = nodeText.match(/\S+\s*/g);
          if (!words) {
            continue;
          }
          var remain = numWords - seenWords;
          if (words.length >= remain) {
            summaryHtml = this.finalizeSummary(summaryHtml, node);
            break;
          }
          seenWords += words.length;
        }
        return summaryHtml;
      };
      BreakpointHandler.prototype.detect = function() {
        var match,
            pl     = /\+/g,
            search = /([^&=]+)=?([^&]*)/g,
            decode = function (s) { return decodeURIComponent(s.replace(pl, " ")); },
            query  = window.location.search.substring(1);
        var urlParams = {};
        while (match = search.exec(query))
          urlParams[decode(match[1])] = decode(match[2]);
        this.isListPage = $('html').hasClass('list-page');
        this.isMobile = urlParams['m'] === '1';
        this.isHomePage = window.location.pathname == '/';
      };
      BreakpointHandler.prototype.initContent = function() {
        var self = this;
        $('.post').each(function(index) {
          var body = $(this).children('.post-body')[0];
          var content = $(body).children('.post-content')[0];
          $(content).addClass('post-original');
          var data = $(content).children('script').html();
          data = self.rewriteForSSL(data);
          // If exists, extract specified editor's preview.
          var match = data.match(/([\s\S]+?)<div data-is-preview.+?>([\s\S]+)<\/div>/m);
          if (match) {
            data = match[1];
          }
          // Prevent big images from loading when they aren't needed.
          // This must be done as a pre-injection step, since image loading can't be
          // canceled once embedded into the DOM.
          if (self.isListPage && self.isMobile) {
            data = data.replace(/<(img|iframe) .+?>/g, '');
          }
          // Insert template to be rendered as nodes.
          content.innerHTML = data;
          if (self.isListPage) {
            var summary = document.createElement('div');
            $(summary).addClass('post-content');
            $(summary).addClass('post-summary');
            body.insertBefore(summary, content);
            if (match) {
              // Use provided summary.
              summary.innerHTML = match[2];
            } else {
              // Generate a summary.
              // Summary generation relies on DOM, so it must occur after content is
              // inserted into the page.
              summary.innerHTML = self.generateSummaryFromContent(content, 30);
            }
            // Add read more link to summary.
            var titleAnchor = $(this).find('.title a')[0];
            var link = titleAnchor.cloneNode(true);
            link.innerHTML = 'Read More';
            $(link).addClass('read-more');
            summary.appendChild(link);
          }
        });
        // Firefox does not allow for proper styling of BR.
        if (navigator.userAgent.indexOf('Firefox') > -1) {
          $('.post-content br').replaceWith('<span class="space"></span>');
        }
        $('.loading').removeClass('loading');
      };
      BreakpointHandler.prototype.process = function() {
        if (!this.initted) {
          var makeInsecureImageRegex = function(hosts) {
            var whitelist = hosts.join('|').replace(/\./g,'\\.');
            // Normal image tags, plus input images (yes, this is possible!)
            return new RegExp('(<(img|input)[^>]+?src=("|\'))http:\/\/(' + whitelist +')', 'g');
          };
          this.sslImageRegex = makeInsecureImageRegex(BreakpointHandler.KNOWN_HTTPS_HOSTS);
          this.sslImageCurrentDomainRegex = makeInsecureImageRegex([window.location.hostname]);
          this.detect();
          this.initContent();
          this.initted = true;
        }
      };
      BreakpointHandler.KNOWN_HTTPS_HOSTS = [
        "www.google.org",
        "www.google.com",
        "services.google.com",
        "blogger.com",
        "draft.blogger.com",
        "www.blogger.com",
        "photos1.blogger.com",
        "photos2.blogger.com",
        "photos3.blogger.com",
        "blogblog.com",
        "img1.blogblog.com",
        "img2.blogblog.com",
        "www.blogblog.com",
        "www1.blogblog.com",
        "www2.blogblog.com",
        "0.bp.blogspot.com",
        "1.bp.blogspot.com",
        "2.bp.blogspot.com",
        "3.bp.blogspot.com",
        "4.bp.blogspot.com",
        "lh3.googleusercontent.com",
        "lh4.googleusercontent.com",
        "lh5.googleusercontent.com",
        "lh6.googleusercontent.com",
        "themes.googleusercontent.com",
      ];
        BreakpointHandler.prototype.rewriteForSSL = function(html) {
        // Handle HTTP -> HTTPS source replacement of images, movies, and other embedded content.
        return html.replace(this.sslImageRegex, '$1https://$4')
        .replace(this.sslImageCurrentDomainRegex, '$1//$4')
        .replace(/(<(embed|iframe)[^>]+?src=("|'))http:\/\/([^"']*?(youtube|picasaweb\.google)\.com)/g, '$1https://$4')
        // Slideshow SWF takes a image host, so we need to rewrite that parameter.
        .replace(/(<embed[^>]+?feed=http(?=[^s]))/g, '$1s');
        };
        $(document).ready(function() {
        var handler = new BreakpointHandler();
        handler.process();
        // Top-level navigation.
        $(".BlogArchive .tab").click(function(ev) {
        ev.preventDefault();
        $(this).parent().toggleClass('active');
        $(this).siblings().slideToggle(300);
        });
        $(".Label .tab").click(function(ev) {
        ev.preventDefault();
        $(this).parent().toggleClass('active');
        $(this).siblings().slideToggle(300);
        });
        // Blog archive year expansion.
        $('.BlogArchive .intervalToggle').click(function(ev) {
        ev.preventDefault();
        if ($(this).parent().hasClass('collapsed')) {
        $(this).parent().removeClass('collapsed');
        $(this).parent().addClass('expanded');
        } else {
        $(this).parent().removeClass('expanded');
        $(this).parent().addClass('collapsed');
        }
        });
        // Reverse order of months.
        $('.BlogArchive .intervalToggle + div').each(function(_, items) {
        var year = $(this);
        year.children().each(function(_, month) {
        year.prepend(month);
        });
        });
        // Set anchors to open in new tab.
        $('.post-content img').parent().each(function(_, node) {
        if (node.nodeName == 'A') {
        $(this).attr('target', '_blank');
        }
        });
        // Process search requests.
        $('.searchBox input').on("keypress", function(ev) {
        if (ev.which == 13) {
        window.location.href = 'https://www.google.com/search?q=site%3A' + window.location.hostname + '%20' + encodeURIComponent ($(this).val());
        }
        });
        });
        //]]>
    </script>

<script type="text/javascript" src="https://www.blogger.com/static/v1/widgets/3098431828-widgets.js"></script>
<script type='text/javascript'>
window['__wavt'] = 'AOuZoY4OtX2OMzArqQRojyYSo3Og6lYvqA:1623010966453';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d1176949257541686127','//security.googleblog.com/','1176949257541686127');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '1176949257541686127', 'title': 'Google Online Security Blog', 'url': 'https://security.googleblog.com/', 'canonicalUrl': 'https://security.googleblog.com/', 'homepageUrl': 'https://security.googleblog.com/', 'searchUrl': 'https://security.googleblog.com/search', 'canonicalHomepageUrl': 'https://security.googleblog.com/', 'blogspotFaviconUrl': 'https://security.googleblog.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': true, 'httpsEnabled': true, 'enabledCommentProfileImages': false, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': 'UA-961555-22', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Google Online Security Blog - Atom\x22 href\x3d\x22https://security.googleblog.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22Google Online Security Blog - RSS\x22 href\x3d\x22https://security.googleblog.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22Google Online Security Blog - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/1176949257541686127/posts/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'adsenseAutoAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/3775400722-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/95aa4512ae7400eb', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'index', 'pageName': '', 'pageTitle': 'Google Online Security Blog'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'custom', 'localizedName': 'Custom', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': true}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': 'Google Online Security Blog', 'description': 'The latest news and insights from Google on security and safety on the Internet', 'url': 'https://security.googleblog.com/', 'type': 'feed', 'isSingleItem': false, 'isMultipleItems': true, 'isError': false, 'isPage': false, 'isPost': false, 'isHomepage': true, 'isArchive': false, 'isLabelSearch': false}}]);
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML8', 'sidebar-top', document.getElementById('HTML8'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LabelView', new _WidgetInfo('Label1', 'sidebar', document.getElementById('Label1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML6', 'sidebar', document.getElementById('HTML6'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML5', 'sidebar-bottom', document.getElementById('HTML5'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HTMLView', new _WidgetInfo('HTML1', 'sidebar-bottom', document.getElementById('HTML1'), {}, 'displayModeFull'));
</script>
</body>
</html>