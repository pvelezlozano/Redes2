<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>repo Manifest Format</title><link rel="stylesheet" type="text/css" href="/+static/base.css"/><link rel="stylesheet" type="text/css" href="/+static/doc.css"/><link rel="stylesheet" type="text/css" href="/+static/prettify/prettify.css"/><!-- default customHeadTagPart --></head><body class="Site"><header class="Site-header "><div class="Header"><div class="Header-title"></div></div></header><div class="Site-content Site-Content--markdown"><div class="Container"><div class="doc"><h1><a class="h" name="repo-Manifest-Format" href="#repo-Manifest-Format"><span></span></a><a class="h" name="repo-manifest-format" href="#repo-manifest-format"><span></span></a>repo Manifest Format</h1><p>A repo manifest describes the structure of a repo client; that is the directories that are visible and where they should be obtained from with git.</p><p>The basic structure of a manifest is a bare Git repository holding a single <code class="code">default.xml</code> XML file in the top level directory.</p><p>Manifests are inherently version controlled, since they are kept within a Git repository.  Updates to manifests are automatically obtained by clients during <code class="code">repo sync</code>.</p><div class="toc" role="navigation"><h2>Contents</h2><div class="toc-aux"><ul><li><a href="#XML-File-Format">XML File Format</a></li><ul><li><a href="#Element-manifest">Element manifest</a></li><li><a href="#Element-remote">Element remote</a></li><li><a href="#Element-default">Element default</a></li><li><a href="#Element-manifest_server">Element manifest-server</a></li><li><a href="#Element-project">Element project</a></li><li><a href="#Element-extend_project">Element extend-project</a></li><li><a href="#Element-annotation">Element annotation</a></li><li><a href="#Element-copyfile">Element copyfile</a></li><li><a href="#Element-linkfile">Element linkfile</a></li><li><a href="#Element-remove_project">Element remove-project</a></li><li><a href="#Element-include">Element include</a></li></ul><li><a href="#Local-Manifests">Local Manifests</a></li></ul></div></div><h2><a class="h" name="XML-File-Format" href="#XML-File-Format"><span></span></a><a class="h" name="xml-file-format" href="#xml-file-format"><span></span></a>XML File Format</h2><p>A manifest XML file (e.g. <code class="code">default.xml</code>) roughly conforms to the following DTD:</p><pre class="code"><span class="dec">&lt;!DOCTYPE manifest [
  &lt;!ELEMENT manifest (notice?,
                      remote*,
                      default?,
                      manifest-server?,
                      remove-project*,
                      project*,
                      extend-project*,
                      repo-hooks?,
                      include*)&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT notice (#PCDATA)&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT remote EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST remote name         ID    #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST remote alias        CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST remote fetch        CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST remote pushurl      CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST remote review       CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST remote revision     CDATA #IMPLIED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT default EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default remote      IDREF #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default revision    CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default dest-branch CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default upstream    CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default sync-j      CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default sync-c      CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default sync-s      CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST default sync-tags   CDATA #IMPLIED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT manifest-server EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST manifest-server url CDATA #REQUIRED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT project (annotation*,
                     project*,
                     copyfile*,
                     linkfile*)&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project name        CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project path        CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project remote      IDREF #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project revision    CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project dest-branch CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project groups      CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project sync-c      CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project sync-s      CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project sync-tags   CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project upstream CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project clone-depth CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST project force-path CDATA #IMPLIED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT annotation EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST annotation name  CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST annotation value CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST annotation keep  CDATA &quot;true&quot;&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT copyfile EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST copyfile src  CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST copyfile dest CDATA #REQUIRED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT linkfile EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST linkfile src CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST linkfile dest CDATA #REQUIRED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT extend-project EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST extend-project name CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST extend-project path CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST extend-project groups CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST extend-project revision CDATA #IMPLIED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST extend-project remote CDATA #IMPLIED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT remove-project EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST remove-project name  CDATA #REQUIRED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT repo-hooks EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST repo-hooks in-project CDATA #REQUIRED&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST repo-hooks enabled-list CDATA #REQUIRED&gt;</span><span class="pln">

  </span><span class="dec">&lt;!ELEMENT include EMPTY&gt;</span><span class="pln">
  </span><span class="dec">&lt;!ATTLIST include name CDATA #REQUIRED&gt;</span><span class="pln">
]&gt;
</span></pre><p>A description of the elements and their attributes follows.</p><h3><a class="h" name="Element-manifest" href="#Element-manifest"><span></span></a><a class="h" name="element-manifest" href="#element-manifest"><span></span></a>Element manifest</h3><p>The root element of the file.</p><h3><a class="h" name="Element-remote" href="#Element-remote"><span></span></a><a class="h" name="element-remote" href="#element-remote"><span></span></a>Element remote</h3><p>One or more remote elements may be specified.  Each remote element specifies a Git URL shared by one or more projects and (optionally) the Gerrit review server those projects upload changes through.</p><p>Attribute <code class="code">name</code>: A short name unique to this manifest file.  The name specified here is used as the remote name in each project&#39;s .git/config, and is therefore automatically available to commands like <code class="code">git fetch</code>, <code class="code">git remote</code>, <code class="code">git pull</code> and <code class="code">git push</code>.</p><p>Attribute <code class="code">alias</code>: The alias, if specified, is used to override <code class="code">name</code> to be set as the remote name in each project&#39;s .git/config. Its value can be duplicated while attribute <code class="code">name</code> has to be unique in the manifest file. This helps each project to be able to have same remote name which actually points to different remote url.</p><p>Attribute <code class="code">fetch</code>: The Git URL prefix for all projects which use this remote.  Each project&#39;s name is appended to this prefix to form the actual URL used to clone the project.</p><p>Attribute <code class="code">pushurl</code>: The Git &ldquo;push&rdquo; URL prefix for all projects which use this remote.  Each project&#39;s name is appended to this prefix to form the actual URL used to &ldquo;git push&rdquo; the project. This attribute is optional; if not specified then &ldquo;git push&rdquo; will use the same URL as the <code class="code">fetch</code> attribute.</p><p>Attribute <code class="code">review</code>: Hostname of the Gerrit server where reviews are uploaded to by <code class="code">repo upload</code>.  This attribute is optional; if not specified then <code class="code">repo upload</code> will not function.</p><p>Attribute <code class="code">revision</code>: Name of a Git branch (e.g. <code class="code">master</code> or <code class="code">refs/heads/master</code>). Remotes with their own revision will override the default revision.</p><h3><a class="h" name="Element-default" href="#Element-default"><span></span></a><a class="h" name="element-default" href="#element-default"><span></span></a>Element default</h3><p>At most one default element may be specified.  Its remote and revision attributes are used when a project element does not specify its own remote or revision attribute.</p><p>Attribute <code class="code">remote</code>: Name of a previously defined remote element. Project elements lacking a remote attribute of their own will use this remote.</p><p>Attribute <code class="code">revision</code>: Name of a Git branch (e.g. <code class="code">master</code> or <code class="code">refs/heads/master</code>).  Project elements lacking their own revision attribute will use this revision.</p><p>Attribute <code class="code">dest-branch</code>: Name of a Git branch (e.g. <code class="code">master</code>). Project elements not setting their own <code class="code">dest-branch</code> will inherit this value. If this value is not set, projects will use <code class="code">revision</code> by default instead.</p><p>Attribute <code class="code">upstream</code>: Name of the Git ref in which a sha1 can be found.  Used when syncing a revision locked manifest in -c mode to avoid having to sync the entire ref space. Project elements not setting their own <code class="code">upstream</code> will inherit this value.</p><p>Attribute <code class="code">sync-j</code>: Number of parallel jobs to use when synching.</p><p>Attribute <code class="code">sync-c</code>: Set to true to only sync the given Git branch (specified in the <code class="code">revision</code> attribute) rather than the whole ref space.  Project elements lacking a sync-c element of their own will use this value.</p><p>Attribute <code class="code">sync-s</code>: Set to true to also sync sub-projects.</p><p>Attribute <code class="code">sync-tags</code>: Set to false to only sync the given Git branch (specified in the <code class="code">revision</code> attribute) rather than the other ref tags.</p><h3><a class="h" name="Element-manifest_server" href="#Element-manifest_server"><span></span></a><a class="h" name="element-manifest_server" href="#element-manifest_server"><span></span></a>Element manifest-server</h3><p>At most one manifest-server may be specified. The url attribute is used to specify the URL of a manifest server, which is an XML RPC service.</p><p>The manifest server should implement the following RPC methods:</p><pre class="code">GetApprovedManifest(branch, target)
</pre><p>Return a manifest in which each project is pegged to a known good revision for the current branch and target. This is used by repo sync when the --smart-sync option is given.</p><p>The target to use is defined by environment variables TARGET_PRODUCT and TARGET_BUILD_VARIANT. These variables are used to create a string of the form $TARGET_PRODUCT-$TARGET_BUILD_VARIANT, e.g. passion-userdebug. If one of those variables or both are not present, the program will call GetApprovedManifest without the target parameter and the manifest server should choose a reasonable default target.</p><pre class="code">GetManifest(tag)
</pre><p>Return a manifest in which each project is pegged to the revision at the specified tag. This is used by repo sync when the --smart-tag option is given.</p><h3><a class="h" name="Element-project" href="#Element-project"><span></span></a><a class="h" name="element-project" href="#element-project"><span></span></a>Element project</h3><p>One or more project elements may be specified.  Each element describes a single Git repository to be cloned into the repo client workspace.  You may specify Git-submodules by creating a nested project.  Git-submodules will be automatically recognized and inherit their parent&#39;s attributes, but those may be overridden by an explicitly specified project element.</p><p>Attribute <code class="code">name</code>: A unique name for this project.  The project&lsquo;s name is appended onto its remote&rsquo;s fetch URL to generate the actual URL to configure the Git remote with.  The URL gets formed as:</p><pre class="code">${remote_fetch}/${project_name}.git
</pre><p>where ${remote_fetch} is the remote&lsquo;s fetch attribute and ${project_name} is the project&rsquo;s name attribute.  The suffix &ldquo;.git&rdquo; is always appended as repo assumes the upstream is a forest of bare Git repositories.  If the project has a parent element, its name will be prefixed by the parent&#39;s.</p><p>The project name must match the name Gerrit knows, if Gerrit is being used for code reviews.</p><p>Attribute <code class="code">path</code>: An optional path relative to the top directory of the repo client where the Git working directory for this project should be placed.  If not supplied the project name is used. If the project has a parent element, its path will be prefixed by the parent&#39;s.</p><p>Attribute <code class="code">remote</code>: Name of a previously defined remote element. If not supplied the remote given by the default element is used.</p><p>Attribute <code class="code">revision</code>: Name of the Git branch the manifest wants to track for this project.  Names can be relative to refs/heads (e.g. just &ldquo;master&rdquo;) or absolute (e.g. &ldquo;refs/heads/master&rdquo;). Tags and/or explicit SHA-1s should work in theory, but have not been extensively tested.  If not supplied the revision given by the remote element is used if applicable, else the default element is used.</p><p>Attribute <code class="code">dest-branch</code>: Name of a Git branch (e.g. <code class="code">master</code>). When using <code class="code">repo upload</code>, changes will be submitted for code review on this branch. If unspecified both here and in the default element, <code class="code">revision</code> is used instead.</p><p>Attribute <code class="code">groups</code>: List of groups to which this project belongs, whitespace or comma separated.  All projects belong to the group &ldquo;all&rdquo;, and each project automatically belongs to a group of its name:<code class="code">name</code> and path:<code class="code">path</code>.  E.g. for , that project definition is implicitly in the following manifest groups: default, name:monkeys, and path:barrel-of.  If you place a project in the group &ldquo;notdefault&rdquo;, it will not be automatically downloaded by repo. If the project has a parent element, the <code class="code">name</code> and <code class="code">path</code> here are the prefixed ones.</p><p>Attribute <code class="code">sync-c</code>: Set to true to only sync the given Git branch (specified in the <code class="code">revision</code> attribute) rather than the whole ref space.</p><p>Attribute <code class="code">sync-s</code>: Set to true to also sync sub-projects.</p><p>Attribute <code class="code">upstream</code>: Name of the Git ref in which a sha1 can be found.  Used when syncing a revision locked manifest in -c mode to avoid having to sync the entire ref space.</p><p>Attribute <code class="code">clone-depth</code>: Set the depth to use when fetching this project.  If specified, this value will override any value given to repo init with the --depth option on the command line.</p><p>Attribute <code class="code">force-path</code>: Set to true to force this project to create the local mirror repository according to its <code class="code">path</code> attribute (if supplied) rather than the <code class="code">name</code> attribute.  This attribute only applies to the local mirrors syncing, it will be ignored when syncing the projects in a client working directory.</p><h3><a class="h" name="Element-extend_project" href="#Element-extend_project"><span></span></a><a class="h" name="element-extend_project" href="#element-extend_project"><span></span></a>Element extend-project</h3><p>Modify the attributes of the named project.</p><p>This element is mostly useful in a local manifest file, to modify the attributes of an existing project without completely replacing the existing project definition.  This makes the local manifest more robust against changes to the original manifest.</p><p>Attribute <code class="code">path</code>: If specified, limit the change to projects checked out at the specified path, rather than all projects with the given name.</p><p>Attribute <code class="code">groups</code>: List of additional groups to which this project belongs.  Same syntax as the corresponding element of <code class="code">project</code>.</p><p>Attribute <code class="code">revision</code>: If specified, overrides the revision of the original project.  Same syntax as the corresponding element of <code class="code">project</code>.</p><p>Attribute <code class="code">remote</code>: If specified, overrides the remote of the original project.  Same syntax as the corresponding element of <code class="code">project</code>.</p><h3><a class="h" name="Element-annotation" href="#Element-annotation"><span></span></a><a class="h" name="element-annotation" href="#element-annotation"><span></span></a>Element annotation</h3><p>Zero or more annotation elements may be specified as children of a project element. Each element describes a name-value pair that will be exported into each project&#39;s environment during a &lsquo;forall&rsquo; command, prefixed with REPO__.  In addition, there is an optional attribute &ldquo;keep&rdquo; which accepts the case insensitive values &ldquo;true&rdquo; (default) or &ldquo;false&rdquo;.  This attribute determines whether or not the annotation will be kept when exported with the manifest subcommand.</p><h3><a class="h" name="Element-copyfile" href="#Element-copyfile"><span></span></a><a class="h" name="element-copyfile" href="#element-copyfile"><span></span></a>Element copyfile</h3><p>Zero or more copyfile elements may be specified as children of a project element. Each element describes a src-dest pair of files; the &ldquo;src&rdquo; file will be copied to the &ldquo;dest&rdquo; place during <code class="code">repo sync</code> command.</p><p>&ldquo;src&rdquo; is project relative, &ldquo;dest&rdquo; is relative to the top of the tree. Copying from paths outside of the project or to paths outside of the repo client is not allowed.</p><p>&ldquo;src&rdquo; and &ldquo;dest&rdquo; must be files.  Directories or symlinks are not allowed. Intermediate paths must not be symlinks either.</p><p>Parent directories of &ldquo;dest&rdquo; will be automatically created if missing.</p><h3><a class="h" name="Element-linkfile" href="#Element-linkfile"><span></span></a><a class="h" name="element-linkfile" href="#element-linkfile"><span></span></a>Element linkfile</h3><p>It&#39;s just like copyfile and runs at the same time as copyfile but instead of copying it creates a symlink.</p><p>The symlink is created at &ldquo;dest&rdquo; (relative to the top of the tree) and points to the path specified by &ldquo;src&rdquo; which is a path in the project.</p><p>Parent directories of &ldquo;dest&rdquo; will be automatically created if missing.</p><p>The symlink target may be a file or directory, but it may not point outside of the repo client.</p><h3><a class="h" name="Element-remove_project" href="#Element-remove_project"><span></span></a><a class="h" name="element-remove_project" href="#element-remove_project"><span></span></a>Element remove-project</h3><p>Deletes the named project from the internal manifest table, possibly allowing a subsequent project element in the same manifest file to replace the project with a different source.</p><p>This element is mostly useful in a local manifest file, where the user can remove a project, and possibly replace it with their own definition.</p><h3><a class="h" name="Element-include" href="#Element-include"><span></span></a><a class="h" name="element-include" href="#element-include"><span></span></a>Element include</h3><p>This element provides the capability of including another manifest file into the originating manifest.  Normal rules apply for the target manifest to include - it must be a usable manifest on its own.</p><p>Attribute <code class="code">name</code>: the manifest to include, specified relative to the manifest repository&#39;s root.</p><h2><a class="h" name="Local-Manifests" href="#Local-Manifests"><span></span></a><a class="h" name="local-manifests" href="#local-manifests"><span></span></a>Local Manifests</h2><p>Additional remotes and projects may be added through local manifest files stored in <code class="code">$TOP_DIR/.repo/local_manifests/*.xml</code>.</p><p>For example:</p><pre class="code">$ ls .repo/local_manifests
local_manifest.xml
another_local_manifest.xml

$ cat .repo/local_manifests/local_manifest.xml
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;manifest&gt;
  &lt;project path=&quot;manifest&quot;
           name=&quot;tools/manifest&quot; /&gt;
  &lt;project path=&quot;platform-manifest&quot;
           name=&quot;platform/manifest&quot; /&gt;
&lt;/manifest&gt;
</pre><p>Users may add projects to the local manifest(s) prior to a <code class="code">repo sync</code> invocation, instructing repo to automatically download and manage these extra projects.</p><p>Manifest files stored in <code class="code">$TOP_DIR/.repo/local_manifests/*.xml</code> will be loaded in alphabetical order.</p><p>The legacy <code class="code">$TOP_DIR/.repo/local_manifest.xml</code> path is no longer supported.</p></div></div></div><!-- default customFooter --><footer class="Site-footer"><div class="Footer"><span class="Footer-poweredBy">Powered by <a href="https://gerrit.googlesource.com/gitiles/">Gitiles</a>| <a href="https://policies.google.com/privacy">Privacy</a></span><div class="Footer-links"></div></div></footer></body></html>